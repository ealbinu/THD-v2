/*! Made with ct.js http://ctjs.rocks/ */
"file:"===location.protocol&&alert("Your game won't work like this because\nWeb 👏 builds 👏 require 👏 a web 👏 server!\n\nConsider using a desktop build, or upload your web build to itch.io, GameJolt or your own website.\n\nIf you haven't created this game, please contact the developer about this issue.\n\n Also note that ct.js games do not work inside the itch app; you will need to open the game with your browser of choice.");const deadPool=[],copyTypeSymbol=Symbol("I am a ct.js copy");setInterval((function(){deadPool.length=0}),6e4);const ct={speed:60,templates:{},snd:{},stack:[],fps:60,delta:1,deltaUi:1,camera:null,version:"2.0.2",meta:{name:"Blue Pure Loyalty",author:"",site:"",version:"1.2.0"},get width(){return ct.pixiApp.renderer.view.width},set width(e){return ct.camera.width=ct.roomWidth=e,ct.fittoscreen&&"fastScale"!==ct.fittoscreen.mode||ct.pixiApp.renderer.resize(e,ct.height),ct.fittoscreen&&ct.fittoscreen(),e},get height(){return ct.pixiApp.renderer.view.height},set height(e){return ct.camera.height=ct.roomHeight=e,ct.fittoscreen&&"fastScale"!==ct.fittoscreen.mode||ct.pixiApp.renderer.resize(ct.width,e),ct.fittoscreen&&ct.fittoscreen(),e}};console.log(`%c 😺 %c ct.js game editor %c v${ct.version} %c https://ctjs.rocks/ `,"background: #446adb; color: #fff; padding: 0.5em 0;","background: #5144db; color: #fff; padding: 0.5em 0;","background: #446adb; color: #fff; padding: 0.5em 0;","background: #5144db; color: #fff; padding: 0.5em 0;"),ct.highDensity=!0;const pixiAppSettings={width:544,height:960,antialias:!0,powerPreference:"high-performance",sharedTicker:!1,sharedLoader:!0};try{ct.pixiApp=new PIXI.Application(pixiAppSettings)}catch(e){console.error(e),console.warn("[ct.js] Something bad has just happened. This is usually due to hardware problems. I'll try to fix them now, but if the game still doesn't run, try including a legacy renderer in the project's settings."),PIXI.settings.SPRITE_MAX_TEXTURES=Math.min(PIXI.settings.SPRITE_MAX_TEXTURES,16),ct.pixiApp=new PIXI.Application(pixiAppSettings)}PIXI.settings.ROUND_PIXELS=!1,ct.pixiApp.ticker.maxFPS=60,ct.pixiApp.renderer.options.antialias||(PIXI.settings.SCALE_MODE=PIXI.SCALE_MODES.NEAREST),ct.stage=ct.pixiApp.stage,ct.pixiApp.renderer.autoDensity=ct.highDensity,document.getElementById("ct").appendChild(ct.pixiApp.view),ct.u={getEnvironment(){if("ct.js debugger"===window.name)return"ct.ide";try{if(nw.require)return"nw"}catch(e){}try{return require("electron"),"electron"}catch(e){}return"browser"},getOS(){const e=window.navigator.userAgent;return-1!==e.indexOf("Windows")?"windows":-1!==e.indexOf("Linux")?"linux":-1!==e.indexOf("Mac")?"darwin":"unknown"},ldx:(e,t)=>e*Math.cos(t*Math.PI/180),ldy:(e,t)=>e*Math.sin(t*Math.PI/180),pdn:(e,t,o,i)=>(180*Math.atan2(i-t,o-e)/Math.PI+360)%360,pdc:(e,t,o,i)=>Math.sqrt((o-e)*(o-e)+(i-t)*(i-t)),degToRad:e=>e*Math.PI/180,radToDeg:e=>e/Math.PI*180,rotate:(e,t,o)=>ct.u.rotateRad(e,t,ct.u.degToRad(o)),rotateRad(e,t,o){const i=Math.sin(o),s=Math.cos(o);return new PIXI.Point(s*e-i*t,s*t+i*e)},deltaDir(e,t){var o=(t=(t%360+360)%360)-(e=(e%360+360)%360);return o>180&&(o-=360),o<-180&&(o+=360),o},clamp:(e,t,o)=>Math.max(e,Math.min(o,t)),lerp:(e,t,o)=>e+(t-e)*o,unlerp:(e,t,o)=>(o-e)/(t-e),map:(e,t,o,i,s)=>(e-t)*(s-i)/(o-t)+i,uiToGameCoord:(e,t)=>ct.camera.uiToGameCoord(e,t),gameToUiCoord:(e,t)=>ct.camera.gameToUiCoord(e,t),hexToPixi:e=>Number("0x"+e.slice(1)),pixiToHex:e=>"#"+e.toString(16).padStart(6,0),prect(e,t,o){var i,s,n,a;return o.splice?(i=Math.min(o[0],o[2]),s=Math.max(o[0],o[2]),n=Math.min(o[1],o[3]),a=Math.max(o[1],o[3])):(i=o.x-o.shape.left*o.scale.x,s=o.x+o.shape.right*o.scale.x,n=o.y-o.shape.top*o.scale.y,a=o.y+o.shape.bottom*o.scale.y),e>=i&&t>=n&&e<=s&&t<=a},pcircle:(e,t,o)=>o.splice?ct.u.pdc(e,t,o[0],o[1])<o[2]:ct.u.pdc(0,0,(o.x-e)/o.scale.x,(o.y-t)/o.scale.y)<o.shape.r,ext(e,t,o){if(o)for(const i in o)t[o[i]]&&(e[o[i]]=t[o[i]]);else for(const o in t)e[o]=t[o];return e},wait:e=>ct.timer.add(e),waitUi:e=>ct.timer.addUi(e),promisify:e=>function(...t){return new Promise(((o,i)=>{t.push((function(e,t){e?i(e):o(t)})),e.call(this,...t)}))},required(e,t){let o="The parameter ";throw e&&(o+=e+" "),t&&(o+=`of ${t} `),o+="is required.",new Error(o)},numberedString:(e,t)=>e+"_"+t.toString().padStart(2,"0"),getStringNumber:e=>Number(e.split("_").pop())},ct.u.ext(ct.u,{getOs:ct.u.getOS,lengthDirX:ct.u.ldx,lengthDirY:ct.u.ldy,pointDirection:ct.u.pdn,pointDistance:ct.u.pdc,pointRectangle:ct.u.prect,pointCircle:ct.u.pcircle,extend:ct.u.ext}),(()=>{const e=t=>{t.kill=!0,t.onDestroy&&(ct.templates.onDestroy.apply(t),t.onDestroy.apply(t));for(const o of t.children)o[copyTypeSymbol]&&e(o);const o=ct.stack.indexOf(t);if(-1!==o&&ct.stack.splice(o,1),t.template){const e=ct.templates.list[t.template].indexOf(t);-1!==e&&ct.templates.list[t.template].splice(e,1)}deadPool.push(t)};ct.loop=function(t){ct.delta=t,ct.deltaUi=ct.pixiApp.ticker.elapsedMS/(1e3/(ct.pixiApp.ticker.maxFPS||60)),ct.inputs.updateActions(),ct.timer.updateTimers(),ct.place.debugTraceGraphics.clear();for(let e=0,t=ct.stack.length;e<t;e++)ct.templates.beforeStep.apply(ct.stack[e]),ct.stack[e].onStep.apply(ct.stack[e]),ct.templates.afterStep.apply(ct.stack[e]);for(const e of ct.stage.children)e instanceof Room&&(ct.rooms.beforeStep.apply(e),e.onStep.apply(e),ct.rooms.afterStep.apply(e));for(const t of ct.stack)t.kill&&!t._destroyed&&(e(t),t.destroy({children:!0}));for(const e of ct.stage.children)e.children.sort(((e,t)=>(e.depth||0)-(t.depth||0)||(e.uid||0)-(t.uid||0)||0));ct.camera&&(ct.camera.update(ct.delta),ct.camera.manageStage());for(let e=0,t=ct.stack.length;e<t;e++)ct.templates.beforeDraw.apply(ct.stack[e]),ct.stack[e].onDraw.apply(ct.stack[e]),ct.templates.afterDraw.apply(ct.stack[e]),ct.stack[e].xprev=ct.stack[e].x,ct.stack[e].yprev=ct.stack[e].y;for(const e of ct.stage.children)e instanceof Room&&(ct.rooms.beforeDraw.apply(e),e.onDraw.apply(e),ct.rooms.afterDraw.apply(e));ct.rooms.switching&&ct.rooms.forceSwitch()}})();class CtAction{constructor(e){return this.name=e,this.methodCodes=[],this.methodMultipliers=[],this.prevValue=0,this.value=0,this}methodExists(e){return-1!==this.methodCodes.indexOf(e)}addMethod(e,t){if(-1!==this.methodCodes.indexOf(e))throw new Error(`[ct.inputs] An attempt to add an already added input "${e}" to an action "${name}".`);this.methodCodes.push(e),this.methodMultipliers.push(void 0!==t?t:1)}removeMethod(e){const t=this.methodCodes.indexOf(e);-1!==t&&(this.methodCodes.splice(t,1),this.methodMultipliers.splice(t,1))}setMultiplier(e,t){const o=this.methodCodes.indexOf(e);-1!==o?this.methodMultipliers[o]=t:(console.warning(`[ct.inputs] An attempt to change multiplier of a non-existent method "${e}" at event ${this.name}`),console.trace())}update(){this.prevValue=this.value,this.value=0;for(let e=0,t=this.methodCodes.length;e<t;e++){const t=ct.inputs.registry[this.methodCodes[e]]||0;this.value+=t*this.methodMultipliers[e]}this.value=Math.max(-1,Math.min(this.value,1))}reset(){this.prevValue=this.value=0}get pressed(){return 0===this.prevValue&&0!==this.value}get released(){return 0!==this.prevValue&&0===this.value}get down(){return 0!==this.value}}ct.actions={},ct.inputs={registry:{},addAction(e,t){if(e in ct.actions)throw new Error(`[ct.inputs] An action "${e}" already exists, can't add a new one with the same name.`);const o=new CtAction(e);for(const e of t)o.addMethod(e.code,e.multiplier);return ct.actions[e]=o,o},removeAction(e){delete ct.actions[e]},updateActions(){for(const e in ct.actions)ct.actions[e].update()}},ct.inputs.addAction("TouchAction",[{code:"touch.Any"}]);class Room extends PIXI.Container{static getNewId(){return this.roomId++,this.roomId}constructor(e){if(super(),this.x=this.y=0,this.uid=Room.getNewId(),this.tileLayers=[],this.backgrounds=[],ct.room||(ct.room=ct.rooms.current=this),e){e.extends&&ct.u.ext(this,e.extends),this.onCreate=e.onCreate,this.onStep=e.onStep,this.onDraw=e.onDraw,this.onLeave=e.onLeave,this.template=e,this.name=e.name,this===ct.room&&(ct.pixiApp.renderer.backgroundColor=ct.u.hexToPixi(this.template.backgroundColor)),ct.fittoscreen(),this===ct.room&&(ct.place.tileGrid={});for(let t=0,o=e.bgs.length;t<o;t++){const o=new ct.templates.Background(e.bgs[t].texture,null,e.bgs[t].depth,e.bgs[t].extends);this.addChild(o)}for(let t=0,o=e.tiles.length;t<o;t++){const o=new Tilemap(e.tiles[t]);o.cache(),this.tileLayers.push(o),this.addChild(o)}for(let t=0,o=e.objects.length;t<o;t++){const o=e.objects[t].exts||{};ct.templates.copyIntoRoom(e.objects[t].template,e.objects[t].x,e.objects[t].y,this,{tx:e.objects[t].tx,ty:e.objects[t].ty,tr:e.objects[t].tr,...o})}}return this}get x(){return-this.position.x}set x(e){return this.position.x=-e,e}get y(){return-this.position.y}set y(e){return this.position.y=-e,e}}Room.roomId=0,function(){var e;ct.rooms={templates:{},list:{},addBg(e,t){const o=new ct.templates.Background(e,null,t);return ct.room.addChild(o),o},addTileLayer:e=>ct.tilemaps.create(e),clear(){ct.stage.children=[],ct.stack=[];for(const e in ct.templates.list)ct.templates.list[e]=[];for(const e in ct.backgrounds.list)ct.backgrounds.list[e]=[];ct.rooms.list={};for(const e in ct.rooms.templates)ct.rooms.list[e]=[]},remove(e){if(!(e instanceof Room)){if("string"==typeof e)throw new Error("[ct.rooms] To remove a room, you should provide a reference to it (to an object), not its name. Provided value:",e);throw new Error("[ct.rooms] An attempt to remove a room that is not actually a room! Provided value:",e)}const t=ct.rooms.list[e.name];-1!==t?ct.rooms.list[e.name].splice(t,1):console.warn("[ct.rooms] Removing a room that was not found in ct.rooms.list. This is strange…"),e.kill=!0,ct.stage.removeChild(e);for(const t of e.children)t.kill=!0;e.onLeave(),ct.rooms.onLeave.apply(e)},switch(t){ct.rooms.templates[t]?(e=t,ct.rooms.switching=!0):console.error('[ct.rooms] The room "'+t+'" does not exist!')},switching:!1,append(e,t){if(!(e in ct.rooms.templates))return console.error(`[ct.rooms] append failed: the room ${e} does not exist!`),!1;const o=new Room(ct.rooms.templates[e]);return t&&ct.u.ext(o,t),ct.stage.addChild(o),o.onCreate(),ct.rooms.onCreate.apply(o),ct.rooms.list[e].push(o),o},prepend(e,t){if(!(e in ct.rooms.templates))return console.error(`[ct.rooms] prepend failed: the room ${e} does not exist!`),!1;const o=new Room(ct.rooms.templates[e]);return t&&ct.u.ext(o,t),ct.stage.addChildAt(o,0),o.onCreate(),ct.rooms.onCreate.apply(o),ct.rooms.list[e].push(o),o},merge(e){if(!(e in ct.rooms.templates))return console.error(`[ct.rooms] merge failed: the room ${e} does not exist!`),!1;const t={copies:[],tileLayers:[],backgrounds:[]},o=ct.rooms.templates[e],i=ct.room;for(const e of o.bgs){const o=new ct.templates.Background(e.texture,null,e.depth,e.extends);i.backgrounds.push(o),i.addChild(o),t.backgrounds.push(o)}for(const e of o.tiles){const o=new Tilemap(e);i.tileLayers.push(o),i.addChild(o),t.tileLayers.push(o),o.cache()}for(const e of o.objects){const o=ct.templates.copyIntoRoom(e.template,e.x,e.y,i,{tx:e.tx||1,ty:e.ty||1,tr:e.tr||0});t.copies.push(o)}return t},forceSwitch(t){e&&(t=e),ct.room&&(ct.room.onLeave(),ct.rooms.onLeave.apply(ct.room),ct.room=void 0),ct.rooms.clear(),deadPool.length=0;var o=ct.rooms.templates[t];ct.roomWidth=o.width,ct.roomHeight=o.height,ct.camera=new Camera(ct.roomWidth/2,ct.roomHeight/2,ct.roomWidth,ct.roomHeight),o.cameraConstraints&&(ct.camera.minX=o.cameraConstraints.x1,ct.camera.maxX=o.cameraConstraints.x2,ct.camera.minY=o.cameraConstraints.y1,ct.camera.maxY=o.cameraConstraints.y2),ct.pixiApp.renderer.resize(o.width,o.height),ct.rooms.current=ct.room=new Room(o),ct.stage.addChild(ct.room),ct.room.onCreate(),ct.rooms.onCreate.apply(ct.room),ct.rooms.list[t].push(ct.room),ct.camera.manageStage(),ct.rooms.switching=!1,e=void 0},onCreate(){if(this===ct.room){const e=new PIXI.Graphics;e.depth=1e7,ct.room.addChild(e),ct.place.debugTraceGraphics=e}for(const e of this.tileLayers)-1!==this.children.indexOf(e)&&ct.place.enableTilemapCollisions(e)},onLeave(){this===ct.room&&(ct.place.grid={})},starting:"Start"}}(),ct.room=null,ct.rooms.beforeStep=function(){ct.touch.updateGestures()},ct.rooms.afterStep=function(){},ct.rooms.beforeDraw=function(){},ct.rooms.afterDraw=function(){ct.mouse.xprev=ct.mouse.x,ct.mouse.yprev=ct.mouse.y,ct.mouse.xuiprev=ct.mouse.xui,ct.mouse.yuiprev=ct.mouse.yui,ct.mouse.pressed=ct.mouse.released=!1,ct.inputs.registry["mouse.Wheel"]=0,ct.sound.follow&&!ct.sound.follow.kill?ct.sound.howler.pos(ct.sound.follow.x,ct.sound.follow.y,ct.sound.useDepth?ct.sound.follow.z:0):ct.sound.manageListenerPosition&&ct.sound.howler.pos(ct.camera.x,ct.camera.y,ct.camera.z||0),ct.keyboard.clear();for(const e of ct.touch.events)e.xprev=e.x,e.yprev=e.y,e.xuiprev=e.x,e.yuiprev=e.y,ct.touch.clearReleased()},ct.rooms.templates.Game={name:"Game",width:544,height:960,objects:JSON.parse('[{"x":288,"y":64,"exts":{},"template":"timer"},{"x":0,"y":224,"exts":{},"template":"linea"},{"x":0,"y":448,"exts":{},"template":"linea"},{"x":0,"y":672,"exts":{},"template":"linea"}]'),bgs:JSON.parse('[{"depth":-1,"texture":"bottom","extends":{"repeat":"no-repeat","shiftY":794,"scaleX":0.98,"scaleY":0.98,"shiftX":6}},{"depth":0,"texture":"thehomedepot","extends":{"repeat":"no-repeat","scaleX":0.8,"scaleY":0.8,"shiftX":34,"shiftY":10}},{"depth":3,"texture":"linea-cubierta","extends":{"repeat":"no-repeat","shiftX":502,"scaleY":0.9,"shiftY":564}},{"depth":3,"texture":"linea-cubierta","extends":{"repeat":"no-repeat","shiftX":502,"scaleY":0.9,"shiftY":338}},{"depth":3,"texture":"linea-cubierta","extends":{"repeat":"no-repeat","shiftX":502,"shiftY":114,"scaleY":0.9}}]'),tiles:JSON.parse('[{"depth":-10,"tiles":[],"extends":{}}]'),backgroundColor:"#F5750D",onStep(){},onDraw(){this.scoreLabel.text=ct.room.score},onLeave(){},onCreate(){ct.room.dropsColors=["blue","green","pink","orange"],ct.room.colLen=ct.room.dropsColors.length-1,ct.room.paused=!1;window.parent.postMessage(JSON.stringify({state:"gamestart"}),"*"),ct.room.score=0,this.scoreLabel=new PIXI.Text(ct.room.score,ct.styles.get("boldScore")),this.scoreLabel.anchor.set(.5,.5),this.scoreLabel.x=ct.camera.width-86,this.scoreLabel.y=50,this.addChild(this.scoreLabel),this.scoreLabelTXT=new PIXI.Text("puntos",ct.styles.get("boldScore_txt")),this.scoreLabelTXT.x=ct.camera.width-130,this.scoreLabelTXT.y=70,this.addChild(this.scoreLabelTXT);var e=new PIXI.Graphics;e.beginFill(16777215),e.drawRect(0,6,ct.camera.width,110),e.endFill(),e.depth=-1,this.addChild(e);var t=["t1","t2","t3","t4","t5"],o=ct.camera.height-100;for(var i in t){var s=ct.templates.copy("tools",66+100*i,o);s.scale.x=s.scale.y=.6,s.gotoAndStop(i)}ct.room.GameOverFN=function(){console.warn("---------------"),console.log("GAME OVER"),ct.room.gameover=!0,ct.u.wait(1e3).then((()=>{ct.rooms.merge("GameOver"),ct.sound.spawn("end"),this.scoreLabelEnd=new PIXI.Text(ct.room.score,ct.styles.get("boldScore_BIG")),this.scoreLabelEnd.anchor.set(.5,.5),this.scoreLabelTXTEnd=new PIXI.Text("puntos",ct.styles.get("boldScore_txt_BIG")),this.scoreLabelTXTEnd.anchor.set(.5,.5),this.scoreLabelEnd.depth=11,this.scoreLabelTXTEnd.depth=11,this.scoreLabelEnd.x=ct.camera.width/2,this.scoreLabelEnd.y=ct.camera.height/2-60,this.scoreLabelTXTEnd.x=ct.camera.width/2,this.scoreLabelTXTEnd.y=ct.camera.height/2,this.addChild(this.scoreLabelEnd),this.addChild(this.scoreLabelTXTEnd);var e={state:"gameover",score:ct.room.score,points:this.pointsList};window.parent.postMessage(JSON.stringify(e),"*")}))},this.pointsList={taladro:0,martillo:0,llaves:0,inglesa:0,pinzas:0,especiales:0,values:[["taladro",19],["martillo",47],["llaves",79],["inglesa",97],["pinzas",149],["especiales","valor*3"]]},this.addPoints=function(e,t,o,i){var s=t,n=o,a=e;this.pointsList[i]+=a,ct.templates.copy("points",s,n).pointLabel.text="+"+a,ct.room.score+=a}},extends:{}},ct.rooms.templates.GameOver={name:"GameOver",width:544,height:960,objects:JSON.parse("[]"),bgs:JSON.parse('[{"depth":10,"texture":"screen_end","extends":{"repeat":"no-repeat"}}]'),tiles:JSON.parse('[{"depth":-10,"tiles":[],"extends":{}}]'),backgroundColor:"#FFFFFF",onStep(){},onDraw(){},onLeave(){},onCreate(){ct.pixiApp.ticker.speed=0},extends:{isUi:!0}},ct.rooms.templates.Start={name:"Start",width:544,height:960,objects:JSON.parse('[{"x":32,"y":832,"exts":{},"template":"btn_back_exit"},{"x":160,"y":832,"exts":{},"template":"btn_siguiente"}]'),bgs:JSON.parse('[{"depth":0,"texture":"screen_intro","extends":{"repeat":"no-repeat"}}]'),tiles:JSON.parse('[{"depth":-10,"tiles":[],"extends":{}}]'),backgroundColor:"#F5750D",onStep(){},onDraw(){},onLeave(){},onCreate(){window.parent.postMessage(JSON.stringify({state:"gameopen"}),"*")},extends:{isUi:!0}},ct.rooms.templates.Paused={name:"Paused",width:544,height:960,objects:JSON.parse("[]"),bgs:JSON.parse('[{"depth":0,"texture":"pausedbg","extends":{"repeat":"no-repeat"}}]'),tiles:JSON.parse('[{"depth":-10,"tiles":[],"extends":{}}]'),backgroundColor:"#FFFFFF",onStep(){},onDraw(){},onLeave(){},onCreate(){this.pausedLabel=new PIXI.Text("Juego Pausado",ct.styles.get("boldScore")),this.pausedLabel.anchor.set(.5,.5),this.pausedLabel.x=ct.viewWidth/2,this.pausedLabel.y=140,this.addChild(this.pausedLabel)},extends:{isUi:!0}},ct.rooms.templates.Start2={name:"Start2",width:544,height:960,objects:JSON.parse('[{"x":160,"y":832,"exts":{},"template":"btn_comenzar"},{"x":32,"y":832,"exts":{},"template":"btn_back"}]'),bgs:JSON.parse('[{"depth":0,"texture":"screen_intro2","extends":{"repeat":"no-repeat"}}]'),tiles:JSON.parse('[{"depth":-10,"tiles":[],"extends":{}}]'),backgroundColor:"#F5750D",onStep(){},onDraw(){},onLeave(){},onCreate(){ct.emitters.append(this,"goldtool",{position:{x:ct.viewWidth/2,y:ct.viewHeight/2+140}})},extends:{isUi:!0}},ct.rooms.templates.Start_extra={name:"Start_extra",width:544,height:960,objects:JSON.parse('[{"x":32,"y":832,"exts":{},"template":"btn_back_exit"},{"x":160,"y":832,"exts":{},"template":"extra_btn_siguiente"},{"x":160,"y":288,"exts":{},"template":"anim"}]'),bgs:JSON.parse('[{"depth":0,"texture":"screen_intro_extra","extends":{"repeat":"no-repeat"}}]'),tiles:JSON.parse('[{"depth":-10,"tiles":[],"extends":{}}]'),backgroundColor:"#F5750D",onStep(){},onDraw(){},onLeave(){},onCreate(){},extends:{isUi:!0}},ct.styles={types:{},new:(e,t)=>(ct.styles.types[e]=t,t),get:(e,t)=>!0===t?ct.u.ext({},ct.styles.types[e]):t?ct.u.ext(ct.u.ext({},ct.styles.types[e]),t):ct.styles.types[e]},ct.styles.new("regular",{fontFamily:'"CTPROJFONTOpenSans-Regular", "OpenSans-Regular", sans-serif',fontSize:12,fontStyle:"normal",fontWeight:400,lineJoin:"round",lineHeight:16.200000000000003}),ct.styles.new("boldScore",{fontFamily:'"CTPROJFONTOpenSans-ExtraBold", "OpenSans-ExtraBold", sans-serif',fontSize:46,fontStyle:"normal",fontWeight:400,align:"center",lineJoin:"round",lineHeight:62.1,fill:"#F4750D"}),ct.styles.new("boldScore_txt",{fontFamily:'"CTPROJFONTOpenSans-ExtraBold", "OpenSans-ExtraBold", sans-serif',fontSize:26,fontStyle:"normal",fontWeight:400,align:"center",lineJoin:"round",lineHeight:35.1,fill:"#808080"}),ct.styles.new("points",{fontFamily:'"CTPROJFONTOpenSans-ExtraBold", "OpenSans-ExtraBold", sans-serif',fontSize:20,fontStyle:"normal",fontWeight:400,align:"center",lineJoin:"round",lineHeight:27,fill:["#D6D6D6","#C4BEB9"],fillGradientType:0,strokeThickness:4,stroke:"#FFFFFF"}),ct.styles.new("boldScore_BIG",{fontFamily:'"CTPROJFONTOpenSans-ExtraBold", "OpenSans-ExtraBold", sans-serif',fontSize:94,fontStyle:"normal",fontWeight:400,align:"center",lineJoin:"round",lineHeight:126.9,fill:"#F4750D"}),ct.styles.new("boldScore_txt_BIG",{fontFamily:'"CTPROJFONTOpenSans-ExtraBold", "OpenSans-ExtraBold", sans-serif',fontSize:40,fontStyle:"normal",fontWeight:400,align:"center",lineJoin:"round",lineHeight:54,fill:"#808080"});class EmitterTandem extends PIXI.Container{constructor(e,t){super(),this.emitters=[],this.delayed=[];for(const o of e){const e=new PIXI.particles.Emitter(this,ct.res.getTexture(o.texture),o.settings),i=o.settings.delay+t.prewarmDelay;i>0?(e.emit=!1,this.delayed.push({value:i,emitter:e})):i<0?(e.emit=!0,e.update(-i)):e.emit=!0,e.initialDeltaPos={x:o.settings.pos.x,y:o.settings.pos.y},this.emitters.push(e),e.playOnce((()=>{this.emitters.splice(this.emitters.indexOf(e),1)}))}this.isUi=t.isUi,this.scale.x=t.scale.x,this.scale.y=t.scale.y,t.rotation?this.rotation=t.rotation:t.angle&&(this.angle=t.angle),this.deltaPosition=t.position,this.depth=t.depth,this.frozen=!1,this.isUi?ct.emitters.uiTandems.push(this):ct.emitters.tandems.push(this)}update(){if(this.stopped)for(const e of this.emitters)e.particleCount||this.emitters.splice(this.emitters.indexOf(e),1);if(this.appendant&&this.appendant._destroyed||this.kill||!this.emitters.length)return this.emit("done"),this.isUi?ct.emitters.uiTandems.splice(ct.emitters.uiTandems.indexOf(this),1):ct.emitters.tandems.splice(ct.emitters.tandems.indexOf(this),1),void this.destroy();if(this.frozen)return;const e=(this.isUi?PIXI.Ticker.shared.elapsedMS:PIXI.Ticker.shared.deltaMS)/1e3;for(const t of this.delayed)t.value-=e,t.value<=0&&(t.emitter.emit=!0,this.delayed.splice(this.delayed.indexOf(t),1));for(const t of this.emitters)this.delayed.find((e=>e.emitter===t))||t.update(e);this.follow&&this.updateFollow()}stop(){if(this.stopped)console.trace("[ct.emitters] An attempt to stop an already stopped emitter tandem. Continuing…");else{this.stopped=!0;for(const e of this.emitters)e.emit=!1;this.delayed=[]}}pause(){for(const e of this.emitters)0!==e.maxParticles&&(e.oldMaxParticles=e.maxParticles,e.maxParticles=0)}resume(){for(const e of this.emitters)e.maxParticles=e.oldMaxParticles||e.maxParticles}clear(){for(const e of this.emitters)e.cleanup()}updateFollow(){if(!this.follow)return;if(this.follow.kill||!this.follow.scale)return this.follow=null,void this.stop();const e=ct.u.rotate(this.deltaPosition.x*this.follow.scale.x,this.deltaPosition.y*this.follow.scale.y,-this.follow.angle);for(const t of this.emitters){t.updateOwnerPos(this.follow.x+e.x,this.follow.y+e.y);const o=ct.u.rotate(t.initialDeltaPos.x*this.follow.scale.x,t.initialDeltaPos.y*this.follow.scale.y,-this.follow.angle);t.updateSpawnPos(o.x,o.y)}}}!function(){const e={prewarmDelay:0,scale:{x:1,y:1},tint:16777215,alpha:1,position:{x:0,y:0},isUi:!1,depth:1/0};ct.emitters={templates:{killSillo:[{texture:"nut",settings:{alpha:{list:[{value:0,time:0},{value:.9899997016817748,time:.46431484137267437},{time:.9040240185589155,value:1},{value:0,time:1}],isStepped:!1},scale:{list:[{value:1,time:0},{value:.3,time:1}],isStepped:!1},color:{list:[{value:"ffffff",time:0},{value:"ffffff",time:.46431484137267437},{time:.9040240185589155,value:"FFFFFF"},{value:"ffffff",time:1}],isStepped:!1},blendMode:"normal",speed:{list:[{value:162.48993175989654,time:0},{value:100,time:1}],isStepped:!1},startRotation:{min:-90,max:90},rotationSpeed:{min:0,max:0},rotationAcceleration:0,lifetime:{min:.5,max:.5},frequency:10,spawnChance:1,particlesPerWave:10,angleStart:270,emitterLifetime:0,maxParticles:10,maxSpeed:0,pos:{x:0,y:0},acceleration:{x:0,y:0},addAtBack:!1,spawnType:"circle",spawnCircle:{x:0,y:0,r:20,minR:100},delay:0,particleSpacing:36,spawnRect:{x:-100,y:-100,w:200,h:200},noRotation:!1}}],goldtool:[{texture:"nut",settings:{alpha:{list:[{value:0,time:0},{value:1,time:.2343438191076871},{time:.5511374499109174,value:.7799934369990438},{time:.848513771805298,value:.9450266994811629},{value:0,time:1}],isStepped:!1},scale:{list:[{value:1,time:0},{value:.3,time:1}],isStepped:!1},color:{list:[{value:"FF7E33",time:0},{value:"FFE600",time:.2343438191076871},{time:.5511374499109174,value:"FF0000"},{time:.848513771805298,value:"FFD900"},{value:"ffffff",time:1}],isStepped:!0},blendMode:"add",speed:{list:[{value:162.48993175989654,time:0},{value:100,time:1}],isStepped:!1},startRotation:{min:-90,max:90},rotationSpeed:{min:0,max:0},rotationAcceleration:0,lifetime:{min:.5,max:.5},frequency:.1,spawnChance:1,particlesPerWave:1,angleStart:270,emitterLifetime:0,maxParticles:100,maxSpeed:0,pos:{x:0,y:0},acceleration:{x:0,y:0},addAtBack:!1,spawnType:"ring",spawnCircle:{x:0,y:0,r:80,minR:60},delay:0,particleSpacing:360,spawnRect:{x:-100,y:-100,w:200,h:200},noRotation:!1}}]}||{},uiTandems:[],tandems:[],fire(t,o,i,s){if(!(t in ct.emitters.templates))throw new Error(`[ct.emitters] An attempt to create a non-existent emitter ${t}.`);const n=Object.assign({},e,s),a=new EmitterTandem(ct.emitters.templates[t],n);return a.x=o,a.y=i,n.room?(n.room.addChild(a),a.isUi=n.room.isUi):(ct.room.addChild(a),a.isUi=ct.room.isUi),a},append(t,o,i){if(!(o in ct.emitters.templates))throw new Error(`[ct.emitters] An attempt to create a non-existent emitter ${o}.`);const s=Object.assign({},e,i),n=new EmitterTandem(ct.emitters.templates[o],s);return s.position&&(n.x=s.position.x,n.y=s.position.y),n.appendant=t,t.addChild(n),n},follow(t,o,i){if(!(o in ct.emitters.templates))throw new Error(`[ct.emitters] An attempt to create a non-existent emitter ${o}.`);const s=Object.assign({},e,i),n=new EmitterTandem(ct.emitters.templates[o],s);return n.follow=t,n.updateFollow(),"getRoom"in t?t.getRoom().addChild(n):ct.room.addChild(n),n}},PIXI.Ticker.shared.add((()=>{for(const e of ct.emitters.uiTandems)e.update();for(const e of ct.emitters.tandems)e.update()}))}();const Copy=function(){const e=Symbol("texture"),t=Symbol("zeroDirection"),o=Symbol("hspeed"),i=Symbol("vspeed");let s=0;class n extends PIXI.AnimatedSprite{constructor(n,a,r,c,l){var h;if(l=l||ct.room,n){if(!(n in ct.templates.templates))throw new Error(`[ct.templates] An attempt to create a copy of a non-existent template \`${n}\` detected. A typo?`);if((h=ct.templates.templates[n]).texture&&"-1"!==h.texture){const t=ct.res.getTexture(h.texture);super(t),this[e]=h.texture,this.anchor.x=t[0].defaultAnchor.x,this.anchor.y=t[0].defaultAnchor.y}else super([PIXI.Texture.EMPTY]);this.template=n,this.parent=l,this.blendMode=h.blendMode||PIXI.BLEND_MODES.NORMAL,h.playAnimationOnStart&&this.play(),h.extends&&ct.u.ext(this,h.extends)}else super([PIXI.Texture.EMPTY]);return this[copyTypeSymbol]=!0,this.position.set(a||0,r||0),this.xprev=this.xstart=this.x,this.yprev=this.ystart=this.y,this[o]=0,this[i]=0,this[t]=0,this.speed=this.direction=this.gravity=0,this.gravityDir=90,this.depth=0,c&&(ct.u.ext(this,c),c.tx&&(this.scale.x=c.tx),c.ty&&(this.scale.y=c.ty),c.tr&&(this.angle=c.tr)),this.uid=++s,n&&(ct.u.ext(this,{template:n,depth:h.depth,onStep:h.onStep,onDraw:h.onDraw,onCreate:h.onCreate,onDestroy:h.onDestroy,shape:ct.res.getTextureShape(h.texture||-1)}),c&&void 0!==c.depth&&(this.depth=c.depth),ct.templates.list[n]?ct.templates.list[n].push(this):ct.templates.list[n]=[this],this.onBeforeCreateModifier(),ct.templates.templates[n].onCreate.apply(this)),this}set tex(t){if(this[e]===t)return t;var{playing:o}=this;return this.textures=ct.res.getTexture(t),this[e]=t,this.shape=ct.res.getTextureShape(t),this.anchor.x=this.textures[0].defaultAnchor.x,this.anchor.y=this.textures[0].defaultAnchor.y,o&&this.play(),t}get tex(){return this[e]}get speed(){return Math.hypot(this.hspeed,this.vspeed)}set speed(e){if(0===e)return this[t]=this.direction,void(this.hspeed=this.vspeed=0);if(0===this.speed){const s=this[t];return this[o]=e*Math.cos(s*Math.PI/180),void(this[i]=e*Math.sin(s*Math.PI/180))}var s=e/this.speed;this.hspeed*=s,this.vspeed*=s}get hspeed(){return this[o]}set hspeed(e){return 0===this.vspeed&&0===e&&(this[t]=this.direction),this[o]=e,e}get vspeed(){return this[i]}set vspeed(e){return 0===this.hspeed&&0===e&&(this[t]=this.direction),this[i]=e,e}get direction(){return 0===this.speed?this[t]:(180*Math.atan2(this.vspeed,this.hspeed)/Math.PI+360)%360}set direction(e){if(this[t]=e,this.speed>0){var o=this.speed;this.hspeed=o*Math.cos(e*Math.PI/180),this.vspeed=o*Math.sin(e*Math.PI/180)}return e}move(){this.gravity&&(this.hspeed+=this.gravity*ct.delta*Math.cos(this.gravityDir*Math.PI/180),this.vspeed+=this.gravity*ct.delta*Math.sin(this.gravityDir*Math.PI/180)),this.x+=this.hspeed*ct.delta,this.y+=this.vspeed*ct.delta}addSpeed(e,t){this.hspeed+=e*Math.cos(t*Math.PI/180),this.vspeed+=e*Math.sin(t*Math.PI/180)}getRoom(){let e=this.parent;for(;!(e instanceof Room);)e=e.parent;return e}onBeforeCreateModifier(){}}return n}();!function(ct){const e=function(){this.$chashes=ct.place.getHashes(this);for(const e of this.$chashes)e in ct.place.grid?ct.place.grid[e].push(this):ct.place.grid[e]=[this]};ct.templates={Copy:Copy,list:{BACKGROUND:[],TILEMAP:[]},templates:{},copyIntoRoom(t,o=0,i=0,s,n){if(!(s&&s instanceof Room))throw new Error(`Attempt to spawn a copy of template ${t} inside an invalid room. Room's value provided: ${s}`);const a=new Copy(t,o,i,n);return s.addChild(a),ct.stack.push(a),e.apply(a),a},copy:(e,t=0,o=0,i)=>ct.templates.copyIntoRoom(e,t,o,ct.room,i),each(e){for(const t of ct.stack)t instanceof Copy&&e.apply(t,this)},withCopy(e,t){t.apply(e,this)},withTemplate(e,t){for(const o of ct.templates.list[e])t.apply(o,this)},exists(e){if(!(e in ct.templates.templates))throw new Error(`[ct.templates] ct.templates.exists: There is no such template ${e}.`);return ct.templates.list[e].length>0},valid:e=>e instanceof Copy?!e.kill:e instanceof PIXI.DisplayObject?Boolean(e.position):Boolean(e),isCopy:e=>e instanceof Copy},ct.templates.templates.timer={depth:0,blendMode:PIXI.BLEND_MODES.NORMAL,playAnimationOnStart:!1,texture:"timer",onStep:function(){this.move()},onDraw:function(){},onDestroy:function(){},onCreate:function(){var e=this;this.times=0,this.gotoAndStop(10),this.fullTime=60;var t=setInterval((function(){if(ct.room.gameover)return clearInterval(t),!1;ct.room.paused||(e.fullTime-=1);var o=Math.round(e.fullTime/6);e.gotoAndStop(o),0==e.currentFrame&&ct.room.GameOverFN()}),1e3)},extends:{}},ct.templates.list.timer=[],ct.templates.templates.playpause={depth:6,blendMode:PIXI.BLEND_MODES.NORMAL,playAnimationOnStart:!1,texture:"playpause",onStep:function(){this.move(),ct.touch.collideUi(this)&&(ct.room.gameover||this.pressed||(0==this.currentFrame?(ct.room.paused=!0,ct.pixiApp.ticker.speed=0,this.gotoAndStop(1),this.x=480,this.pauseRoom=ct.rooms.append("Paused",{isUi:!0})):1==this.currentFrame&&(setTimeout((function(){ct.room.paused=!1,ct.pixiApp.ticker.speed=1}),200),this.gotoAndStop(0),this.x=64,ct.rooms.remove(this.pauseRoom))))},onDraw:function(){},onDestroy:function(){},onCreate:function(){this.pauseRoom},extends:{}},ct.templates.list.playpause=[],ct.templates.templates.points={depth:0,blendMode:PIXI.BLEND_MODES.NORMAL,playAnimationOnStart:!1,onStep:function(){this.move(),this.y-=1},onDraw:function(){},onDestroy:function(){},onCreate:function(){this.pointLabel=new PIXI.Text("+9",ct.styles.get("points")),this.pointLabel.x=0,this.pointLabel.y=0,this.addChild(this.pointLabel),ct.timer.add(500,"killtimer").then((()=>{this.kill=!0}))},extends:{}},ct.templates.list.points=[],ct.templates.templates.btn_back={depth:1,blendMode:PIXI.BLEND_MODES.NORMAL,playAnimationOnStart:!1,texture:"btn_back",onStep:function(){if(this.move(),this.move(),ct.touch.collideUi(this)&&(this.tint=16098664,!this.pressed)){this.pressed=!0,ct.u.wait(150).then((()=>{ct.rooms.switch("Start")}));window.parent.postMessage(JSON.stringify({state:"btn_back"}),"*")}},onDraw:function(){},onDestroy:function(){},onCreate:function(){this.pressed=!1},extends:{}},ct.templates.list.btn_back=[],ct.templates.templates.btn_comenzar={depth:1,blendMode:PIXI.BLEND_MODES.NORMAL,playAnimationOnStart:!1,texture:"btn_comenzar",onStep:function(){if(this.move(),ct.touch.collideUi(this)&&(this.tint=16098664,!this.pressed)){this.pressed=!0,ct.sound.spawn("wave"),ct.u.wait(150).then((()=>{ct.rooms.switch("Game")}));window.parent.postMessage(JSON.stringify({state:"btn_comenzar"}),"*")}},onDraw:function(){},onDestroy:function(){},onCreate:function(){this.pressed=!1},extends:{}},ct.templates.list.btn_comenzar=[],ct.templates.templates.btn_siguiente={depth:1,blendMode:PIXI.BLEND_MODES.NORMAL,playAnimationOnStart:!1,texture:"btn_siguiente",onStep:function(){if(this.move(),ct.touch.collideUi(this)&&(this.tint=16098664,!this.pressed)){this.pressed=!0,ct.sound.spawn("wave"),ct.u.wait(150).then((()=>{ct.rooms.switch("Start_extra")}));window.parent.postMessage(JSON.stringify({state:"btn_siguiente1"}),"*")}},onDraw:function(){},onDestroy:function(){},onCreate:function(){this.pressed=!1},extends:{}},ct.templates.list.btn_siguiente=[],ct.templates.templates.btn_back_exit={depth:1,blendMode:PIXI.BLEND_MODES.NORMAL,playAnimationOnStart:!1,texture:"btn_back",onStep:function(){if(this.move(),ct.touch.collideUi(this)&&!this.pressed){this.pressed=!0,window.parent.postMessage("closegame","*"),console.log("closegame");window.parent.postMessage(JSON.stringify({state:"gameclose"}),"*")}},onDraw:function(){},onDestroy:function(){},onCreate:function(){this.pressed=!0,ct.u.wait(1e3).then((()=>{this.pressed=!1}))},extends:{}},ct.templates.list.btn_back_exit=[],ct.templates.templates.linea={depth:0,blendMode:PIXI.BLEND_MODES.NORMAL,playAnimationOnStart:!1,texture:"linea",onStep:function(){this.move(),ct.room.gameover&&(clearInterval(this.builderInterval),this.kill=!0)},onDraw:function(){},onDestroy:function(){},onCreate:function(){var e=this;function t(){var o=ct.templates.copy("sillos",e.x+e.width,e.y);o.speed=2-.1*e.builderspeed,o.direction=180,o.depth=1,o.scale.x=o.scale.y=.6,e.builderspeed-=.2,e.builderspeed=Math.round(10*e.builderspeed)/10,function(){if(ct.room.gameover)return!1;e.builderInterval&&clearInterval(e.builderInterval);ct.u.wait(200).then((()=>{var o=Math.round(1e3*e.builderspeed);e.builderInterval=setInterval(t,o)}))}()}this.builderspeed=5;var o=Math.round(3e3*Math.random());ct.timer.add(o,"start").then((()=>{t()}))},extends:{}},ct.templates.list.linea=[],ct.templates.templates.sillos={depth:0,blendMode:PIXI.BLEND_MODES.NORMAL,playAnimationOnStart:!1,texture:"sillos",onStep:function(){this.move(),this.x<0&&!this.readyToKill&&("sillos"==this.tex&&(this.readyToKill=!0,this.endpart=ct.emitters.fire("killSillo",this.x,this.y,{depth:3}),ct.sound.spawn("sillokill")),ct.u.wait(500).then((()=>{"sillos"==this.tex&&(this.endpart.kill=!0),this.kill=!0}))),ct.room.gameover&&(this.kill=!0)},onDraw:function(){},onDestroy:function(){},onCreate:function(){this.gotoAndStop(Math.round(4*Math.random())),this.readyToKill=!1,this.isSpecial=1==Math.round(Math.random()-.3),this.isSpecial&&ct.emitters.append(this,"goldtool",{position:{x:0,y:0}})},extends:{}},ct.templates.list.sillos=[],ct.templates.templates.tools={depth:0,blendMode:PIXI.BLEND_MODES.NORMAL,playAnimationOnStart:!1,texture:"tools",onStep:function(){if(this.move(),ct.touch.hovers(this)&&ct.actions.TouchAction.pressed){var e=ct.templates.copy("tools_draggable",ct.touch.x,ct.touch.y);e.gotoAndStop(this.currentFrame),e.scale.x=e.scale.y=.6,ct.sound.spawn("grab")}},onDraw:function(){},onDestroy:function(){},onCreate:function(){},extends:{}},ct.templates.list.tools=[],ct.templates.templates.tools_draggable={depth:0,blendMode:PIXI.BLEND_MODES.NORMAL,playAnimationOnStart:!1,texture:"tools",onStep:function(){if(this.move(),this.dragging&&ct.actions.TouchAction.released&&(this.dragging=!1,this.kill=!0,ct.sound.spawn("release")),this.dragging){this.x=ct.touch.x,this.y=ct.touch.y;var e=ct.place.meet(this,"sillos");if(e&&"sillos"==e.tex&&e.currentFrame==this.currentFrame){e.tex=this.tex,e.gotoAndStop(this.currentFrame);var t=0,o="";switch(this.currentFrame){case 0:t=19,o="taladro";break;case 1:t=47,o="martillo";break;case 2:t=79,o="llaves";break;case 3:t=97,o="inglesa";break;case 4:t=149,o="pinzas"}e.isSpecial?(ct.room.addPoints(Math.round(3*t),this.x,this.y,o),ct.sound.spawn("okgold")):(ct.room.addPoints(t,this.x,this.y,o),ct.sound.spawn("ok")),this.kill=!0}}},onDraw:function(){},onDestroy:function(){},onCreate:function(){this.dragging=!0,this.depth=3},extends:{}},ct.templates.list.tools_draggable=[],ct.templates.templates.extra_btn_siguiente={depth:1,blendMode:PIXI.BLEND_MODES.NORMAL,playAnimationOnStart:!1,texture:"btn_siguiente",onStep:function(){if(this.move(),ct.touch.collideUi(this)&&(this.tint=16098664,!this.pressed)){this.pressed=!0,ct.sound.spawn("wave"),ct.u.wait(150).then((()=>{ct.rooms.switch("Start2")}));window.parent.postMessage(JSON.stringify({state:"btn_siguiente2"}),"*")}},onDraw:function(){},onDestroy:function(){},onCreate:function(){this.pressed=!1},extends:{}},ct.templates.list.extra_btn_siguiente=[],ct.templates.templates.anim={depth:0,blendMode:PIXI.BLEND_MODES.NORMAL,playAnimationOnStart:!0,texture:"anim",onStep:function(){this.move()},onDraw:function(){},onDestroy:function(){},onCreate:function(){this.animationSpeed=.1},extends:{}},ct.templates.list.anim=[],ct.templates.beforeStep=function(){},ct.templates.afterStep=function(){},ct.templates.beforeDraw=function(){!1},ct.templates.afterDraw=function(){if(this.transform&&this.transform._localID!==this.transform._currentLocalID||this.x!==this.xprev||this.y!==this.yprev){delete this._shape;const e=this.$chashes||[];this.$chashes=ct.place.getHashes(this);for(const t of e)-1===this.$chashes.indexOf(t)&&ct.place.grid[t].splice(ct.place.grid[t].indexOf(this),1);for(const t of this.$chashes)-1===e.indexOf(t)&&(t in ct.place.grid?ct.place.grid[t].push(this):ct.place.grid[t]=[this])}},ct.templates.onDestroy=function(){if(this.$chashes)for(const e of this.$chashes)ct.place.grid[e].splice(ct.place.grid[e].indexOf(this),1)}}(ct);class Background extends PIXI.TilingSprite{constructor(e,t=0,o=0,i={}){var s=ct.camera.width,n=ct.camera.height;const a=e instanceof PIXI.Texture?e:ct.res.getTexture(e,t||0);"no-repeat"!==i.repeat&&"repeat-x"!==i.repeat||(n=a.height*(i.scaleY||1)),"no-repeat"!==i.repeat&&"repeat-y"!==i.repeat||(s=a.width*(i.scaleX||1)),super(a,s,n),ct.backgrounds.list[e]||(ct.backgrounds.list[e]=[]),ct.backgrounds.list[e].push(this),ct.templates.list.BACKGROUND.push(this),ct.stack.push(this),this.anchor.x=this.anchor.y=0,this.depth=o,this.shiftX=this.shiftY=this.movementX=this.movementY=0,this.parallaxX=this.parallaxY=1,i&&ct.u.extend(this,i),this.scaleX&&(this.tileScale.x=Number(this.scaleX)),this.scaleY&&(this.tileScale.y=Number(this.scaleY)),this.reposition()}onStep(){this.shiftX+=ct.delta*this.movementX,this.shiftY+=ct.delta*this.movementY}reposition(){const e=this.isUi?{x:0,y:0,width:ct.camera.width,height:ct.camera.height}:ct.camera.getBoundingBox();"repeat-x"!==this.repeat&&"no-repeat"!==this.repeat?(this.y=e.y,this.tilePosition.y=-this.y*this.parallaxY+this.shiftY,this.height=e.height+1):this.y=this.shiftY+e.y*(this.parallaxY-1),"repeat-y"!==this.repeat&&"no-repeat"!==this.repeat?(this.x=e.x,this.tilePosition.x=-this.x*this.parallaxX+this.shiftX,this.width=e.width+1):this.x=this.shiftX+e.x*(this.parallaxX-1)}onDraw(){this.reposition()}static onCreate(){}static onDestroy(){}get isUi(){return!!this.parent&&Boolean(this.parent.isUi)}}ct.backgrounds={Background:Background,list:{},add(e,t=0,o=0,i=ct.room){if(!e)throw new Error("[ct.backgrounds] The texName argument is required.");const s=new Background(e,t,o);return i.addChild(s),s}},ct.templates.Background=Background;class Tilemap extends PIXI.Container{constructor(e){if(super(),this.pixiTiles=[],e){this.depth=e.depth,this.tiles=e.tiles.map((e=>({...e}))),e.extends&&Object.assign(this,e.extends);for(let t=0,o=e.tiles.length;t<o;t++){const o=ct.res.getTexture(e.tiles[t].texture),i=new PIXI.Sprite(o[e.tiles[t].frame]);i.anchor.x=i.anchor.y=0,i.shape=o.shape,this.addChild(i),this.pixiTiles.push(i),this.tiles[t].sprite=i,i.x=e.tiles[t].x,i.y=e.tiles[t].y}}else this.tiles=[];ct.templates.list.TILEMAP.push(this)}addTile(e,t,o,i=0){if(this.cached)throw new Error("[ct.tiles] Adding tiles to cached tilemaps is forbidden. Create a new tilemap, or add tiles before caching the tilemap.");const s=ct.res.getTexture(e,i),n=new PIXI.Sprite(s);return n.x=t,n.y=o,n.shape=s.shape,this.tiles.push({texture:e,frame:i,x:t,y:o,width:n.width,height:n.height,sprite:n}),this.addChild(n),this.pixiTiles.push(n),n}cache(e=1024){if(this.cached)throw new Error("[ct.tiles] Attempt to cache an already cached tilemap.");const t=this.getLocalBounds(),o=Math.ceil(t.width/e),i=Math.ceil(t.height/e);this.cells=[];for(let e=0;e<i;e++)for(let e=0;e<o;e++){const e=new PIXI.Container;this.cells.push(e)}for(let i=0,s=this.tiles.length;i<s;i++){const i=this.children[0],s=Math.floor((i.x-t.x)/e),n=Math.floor((i.y-t.y)/e);this.cells[n*o+s].addChild(i)}this.removeChildren();for(let e=0,t=this.cells.length;e<t;e++)0!==this.cells[e].children.length?(this.addChild(this.cells[e]),this.cells[e].cacheAsBitmap=!0):(this.cells.splice(e,1),e--,t--);this.cached=!0}cacheDiamond(e=1024){if(this.cached)throw new Error("[ct.tiles] Attempt to cache an already cached tilemap.");this.cells=[],this.diamondCellMap={};for(let t=0,o=this.tiles.length;t<o;t++){const t=this.children[0],[o,i]=ct.u.rotate(t.x,2*t.y,-45),s=Math.floor(o/e),n=Math.floor(i/e),a=`${s}:${n}`;if(!(a in this.diamondCellMap)){const e=new PIXI.Container;e.chunkX=s,e.chunkY=n,this.diamondCellMap[a]=e,this.cells.push(e)}this.diamondCellMap[a].addChild(t)}this.removeChildren(),this.cells.sort(((e,t)=>{const o=Math.max(e.chunkY,e.chunkX),i=Math.max(t.chunkY,t.chunkX);return o===i?t.chunkX-e.chunkX:o-i}));for(let e=0,t=this.cells.length;e<t;e++)this.addChild(this.cells[e]),this.cells[e].cacheAsBitmap=!0;this.cached=!0}}ct.templates.Tilemap=Tilemap,ct.tilemaps={create(e=0){const t=new Tilemap;return t.depth=e,ct.room.addChild(t),t},addTile:(e,t,o,i,s=0)=>e.addTile(t,o,i,s),cache(e,t){e.cache(t)},cacheDiamond(e,t){e.cacheDiamond(t)}};const Camera=function(){class e extends PIXI.DisplayObject{constructor(e,t,o,i){super(),this.follow=this.rotate=!1,this.followX=this.followY=!0,this.targetX=this.x=e,this.targetY=this.y=t,this.z=500,this.width=o||1920,this.height=i||1080,this.shiftX=this.shiftY=this.interpolatedShiftX=this.interpolatedShiftY=0,this.borderX=this.borderY=null,this.drift=0,this.shake=0,this.shakeDecay=5,this.shakeX=this.shakeY=1,this.shakeFrequency=50,this.shakePhase=this.shakePhaseX=this.shakePhaseY=0,this.shakeMax=10,this.getBounds=this.getBoundingBox}get scale(){return this.transform.scale}set scale(e){"number"==typeof e&&(e={x:e,y:e}),this.transform.scale.copyFrom(e)}moveTo(e,t){this.targetX=e,this.targetY=t}teleportTo(e,t){this.targetX=this.x=e,this.targetY=this.y=t,this.shakePhase=this.shakePhaseX=this.shakePhaseY=0,this.interpolatedShiftX=this.shiftX,this.interpolatedShiftY=this.shiftY}update(e){!function(e,t){const o=t/(PIXI.Ticker.shared.maxFPS||60);e.shake-=o*e.shakeDecay,e.shake=Math.max(0,e.shake),e.shakeMax&&(e.shake=Math.min(e.shake,e.shakeMax));const i=o*e.shakeFrequency;e.shakePhase+=i,e.shakePhaseX+=i*(1+.25*Math.sin(.1489*e.shakePhase)),e.shakePhaseY+=i*(1+.25*Math.sin(.1734*e.shakePhase))}(this,e),this.follow&&this.follow.kill&&(this.follow=!1),this.follow&&"x"in this.follow&&"y"in this.follow&&function(e){const t=null===e.borderX?e.width/2:Math.min(e.borderX,e.width/2),o=null===e.borderY?e.height/2:Math.min(e.borderY,e.height/2),i=e.uiToGameCoord(t,o),s=e.uiToGameCoord(e.width-t,e.height-o);e.followX&&(e.follow.x<i.x-e.interpolatedShiftX?e.targetX=e.follow.x-t+e.width/2:e.follow.x>s.x-e.interpolatedShiftX&&(e.targetX=e.follow.x+t-e.width/2)),e.followY&&(e.follow.y<i.y-e.interpolatedShiftY?e.targetY=e.follow.y-o+e.height/2:e.follow.y>s.y-e.interpolatedShiftY&&(e.targetY=e.follow.y+o-e.height/2))}(this);const t=this.drift?Math.min(1,(1-this.drift)*e):1;this.x=this.targetX*t+this.x*(1-t),this.y=this.targetY*t+this.y*(1-t),this.interpolatedShiftX=this.shiftX*t+this.interpolatedShiftX*(1-t),this.interpolatedShiftY=this.shiftY*t+this.interpolatedShiftY*(1-t),function(e){if(void 0!==e.minX){const t=e.minX+e.width*e.scale.x*.5;e.x=Math.max(t,e.x),e.targetX=Math.max(t,e.targetX)}if(void 0!==e.maxX){const t=e.maxX-e.width*e.scale.x*.5;e.x=Math.min(t,e.x),e.targetX=Math.min(t,e.targetX)}if(void 0!==e.minY){const t=e.minY+e.height*e.scale.y*.5;e.y=Math.max(t,e.y),e.targetY=Math.max(t,e.targetY)}if(void 0!==e.maxY){const t=e.maxY-e.height*e.scale.y*.5;e.y=Math.min(t,e.y),e.targetY=Math.min(t,e.targetY)}}(this),this.x=this.x||0,this.y=this.y||0}get computedX(){const e=(Math.sin(this.shakePhaseX)+.25*Math.sin(3.1846*this.shakePhaseX))/1.25;return this.x+e*this.shake*Math.max(this.width,this.height)/100*this.shakeX+this.interpolatedShiftX}get computedY(){const e=(Math.sin(this.shakePhaseY)+.25*Math.sin(2.8948*this.shakePhaseY))/1.25;return this.y+e*this.shake*Math.max(this.width,this.height)/100*this.shakeY+this.interpolatedShiftY}get left(){return this.computedX-this.width/2*this.scale.x}get top(){return this.computedY-this.height/2*this.scale.y}get right(){return this.computedX+this.width/2*this.scale.x}get bottom(){return this.computedY+this.height/2*this.scale.y}uiToGameCoord(e,t){const o=(e-this.width/2)*this.scale.x,i=(t-this.height/2)*this.scale.y,s=ct.u.rotate(o,i,this.angle);return new PIXI.Point(s.x+this.computedX,s.y+this.computedY)}gameToUiCoord(e,t){const o=e-this.computedX,i=t-this.computedY,s=ct.u.rotate(o,i,-this.angle);return new PIXI.Point(s.x/this.scale.x+this.width/2,s.y/this.scale.y+this.height/2)}getTopLeftCorner(){return this.uiToGameCoord(0,0)}getTopRightCorner(){return this.uiToGameCoord(this.width,0)}getBottomLeftCorner(){return this.uiToGameCoord(0,this.height)}getBottomRightCorner(){return this.uiToGameCoord(this.width,this.height)}getBoundingBox(){const e=new PIXI.Bounds,t=this.getTopLeftCorner(),o=this.getTopRightCorner(),i=this.getBottomLeftCorner(),s=this.getBottomRightCorner();return e.addPoint(new PIXI.Point(t.x,t.y)),e.addPoint(new PIXI.Point(o.x,o.y)),e.addPoint(new PIXI.Point(i.x,i.y)),e.addPoint(new PIXI.Point(s.x,s.y)),e.getRectangle()}contains(e){const t=e.getBounds(!0);return t.right>0&&t.left<this.width*this.scale.x&&t.bottom>0&&t.top<this.width*this.scale.y}realign(e){if(!e.isUi)throw new Error("[ct.camera] An attempt to realing a room that is not in UI space. The room in question is",e);const t=ct.rooms.templates[e.name].width||1,o=ct.rooms.templates[e.name].height||1;for(const i of e.children)"xstart"in i&&!i.skipRealign&&(i.x=i.xstart/t*this.width,i.y=i.ystart/o*this.height)}manageStage(){const e=this.computedX,t=this.computedY,o=1/(isNaN(this.scale.x)?1:this.scale.x),i=1/(isNaN(this.scale.y)?1:this.scale.y);for(const s of ct.stage.children)!s.isUi&&s.pivot&&(s.x=-this.width/2,s.y=-this.height/2,s.pivot.x=e,s.pivot.y=t,s.scale.x=o,s.scale.y=i,s.angle=-this.angle)}}return e}();if(function(){const e=Symbol("time"),t=Symbol("roomUid"),o=Symbol("timeLeftOriginal"),i=Symbol("promiseResolve"),s=Symbol("promiseReject");class n{constructor(n,a=!1,r=!1){this[t]=ct.room.uid||null,this.name=a&&a.toString(),this.isUi=r,this[e]=0,this[o]=n,this.timeLeft=this[o],this.promise=new Promise(((e,t)=>{this[i]=e,this[s]=t})),this.rejected=!1,this.done=!1,this.settled=!1,ct.timer.timers.add(this)}then(...e){return this.promise.then(...e)}catch(e){return this.promise.catch(e)}get time(){return 1e3*this[e]/ct.speed}set time(t){this[e]=t/1e3*ct.speed}update(){!0!==this.rejected&&!0!==this.done?(this[e]+=this.isUi?ct.deltaUi:ct.delta,ct.room.uid!==this[t]&&null!==this[t]&&this.reject({info:"Room switch",from:"ct.timer"}),0!==this.timeLeft&&(this.timeLeft=this[o]-this.time,this.timeLeft<=0&&this.resolve())):this.remove()}resolve(){this.settled||(this.done=!0,this.settled=!0,this[i](),this.remove())}reject(e){this.settled||(this.rejected=!0,this.settled=!0,this[s](e),this.remove())}remove(){ct.timer.timers.delete(this)}}window.CtTimer=n,ct.timer={timers:new Set,counter:0,add:(e,t=!1)=>new n(e,t,!1),addUi:(e,t=!1)=>new n(e,t,!0),updateTimers(){for(const e of this.timers)e.update()}}}(),document.fonts)for(const e of document.fonts)e.load();!function(){var e=function(e,t){ct.inputs.registry["mouse."+e]=t},t={0:"Left",1:"Middle",2:"Right",3:"Special1",4:"Special2",5:"Special3",6:"Special4",7:"Special5",8:"Special6",unknown:"Unknown"};ct.mouse={xui:0,yui:0,xprev:0,yprev:0,xuiprev:0,yuiprev:0,inside:!1,pressed:!1,down:!1,released:!1,button:0,hovers:e=>!!e.shape&&("rect"===e.shape.type?ct.u.prect(ct.mouse.x,ct.mouse.y,e):"circle"===e.shape.type?ct.u.pcircle(ct.mouse.x,ct.mouse.y,e):"point"===e.shape.type&&(ct.mouse.x===e.x&&ct.mouse.y===e.y)),hoversUi:e=>!!e.shape&&("rect"===e.shape.type?ct.u.prect(ct.mouse.xui,ct.mouse.yui,e):"circle"===e.shape.type?ct.u.pcircle(ct.mouse.xui,ct.mouse.yui,e):"point"===e.shape.type&&(ct.mouse.xui===e.x&&ct.mouse.yui===e.y)),hide(){ct.pixiApp.renderer.view.style.cursor="none"},show(){ct.pixiApp.renderer.view.style.cursor=""},get x(){return ct.u.uiToGameCoord(ct.mouse.xui,ct.mouse.yui).x},get y(){return ct.u.uiToGameCoord(ct.mouse.xui,ct.mouse.yui).y}},ct.mouse.listenerMove=function(e){var t=ct.pixiApp.view.getBoundingClientRect();ct.mouse.xui=(e.clientX-t.left)*ct.camera.width/t.width,ct.mouse.yui=(e.clientY-t.top)*ct.camera.height/t.height,ct.mouse.xui>0&&ct.mouse.yui>0&&ct.mouse.yui<ct.camera.height&&ct.mouse.xui<ct.camera.width?ct.mouse.inside=!0:ct.mouse.inside=!1,window.focus()},ct.mouse.listenerDown=function(o){e(t[o.button]||t.unknown,1),ct.mouse.pressed=!0,ct.mouse.down=!0,ct.mouse.button=o.button,window.focus(),o.preventDefault()},ct.mouse.listenerUp=function(o){e(t[o.button]||t.unknown,0),ct.mouse.released=!0,ct.mouse.down=!1,ct.mouse.button=o.button,window.focus(),o.preventDefault()},ct.mouse.listenerContextMenu=function(e){e.preventDefault()},ct.mouse.listenerWheel=function(t){e("Wheel",(t.wheelDelta||-t.detail)<0?-1:1)},ct.mouse.setupListeners=function(){document.addEventListener?(document.addEventListener("mousemove",ct.mouse.listenerMove,!1),document.addEventListener("mouseup",ct.mouse.listenerUp,!1),document.addEventListener("mousedown",ct.mouse.listenerDown,!1),document.addEventListener("wheel",ct.mouse.listenerWheel,!1,{passive:!1}),document.addEventListener("contextmenu",ct.mouse.listenerContextMenu,!1),document.addEventListener("DOMMouseScroll",ct.mouse.listenerWheel,{passive:!1})):(document.attachEvent("onmousemove",ct.mouse.listenerMove),document.attachEvent("onmouseup",ct.mouse.listenerUp),document.attachEvent("onmousedown",ct.mouse.listenerDown),document.attachEvent("onmousewheel",ct.mouse.listenerWheel),document.attachEvent("oncontextmenu",ct.mouse.listenerContextMenu))}}(),function(){var e=function(e,t){ct.inputs.registry["keyboard."+e]=t};ct.keyboard={string:"",lastKey:"",lastCode:"",alt:!1,shift:!1,ctrl:!1,clear(){delete ct.keyboard.lastKey,delete ct.keyboard.lastCode,ct.keyboard.string="",ct.keyboard.alt=!1,ct.keyboard.shift=!1,ct.keyboard.ctrl=!1},check:[],onDown(t){ct.keyboard.shift=t.shiftKey,ct.keyboard.alt=t.altKey,ct.keyboard.ctrl=t.ctrlKey,ct.keyboard.lastKey=t.key,ct.keyboard.lastCode=t.code,t.code?e(t.code,1):e("Unknown",1),t.key&&(1===t.key.length?ct.keyboard.string+=t.key:"Backspace"===t.key?ct.keyboard.string=ct.keyboard.string.slice(0,-1):"Enter"===t.key&&(ct.keyboard.string="")),t.preventDefault()},onUp(t){ct.keyboard.shift=t.shiftKey,ct.keyboard.alt=t.altKey,ct.keyboard.ctrl=t.ctrlKey,t.code?e(t.code,0):e("Unknown",0),t.preventDefault()}},document.addEventListener?(document.addEventListener("keydown",ct.keyboard.onDown,!1),document.addEventListener("keyup",ct.keyboard.onUp,!1)):(document.attachEvent("onkeydown",ct.keyboard.onDown),document.attachEvent("onkeyup",ct.keyboard.onUp))}(),function(e){"use strict";var t="KeyboardEvent"in e;t||(e.KeyboardEvent=function(){throw TypeError("Illegal constructor")}),[["DOM_KEY_LOCATION_STANDARD",0],["DOM_KEY_LOCATION_LEFT",1],["DOM_KEY_LOCATION_RIGHT",2],["DOM_KEY_LOCATION_NUMPAD",3]].forEach((function(t){t[0]in e.KeyboardEvent||(e.KeyboardEvent[t[0]]=t[1])}));var o=e.KeyboardEvent.DOM_KEY_LOCATION_STANDARD,i=e.KeyboardEvent.DOM_KEY_LOCATION_LEFT,s=e.KeyboardEvent.DOM_KEY_LOCATION_RIGHT,n=e.KeyboardEvent.DOM_KEY_LOCATION_NUMPAD;function a(e,t){return-1!==String(e).indexOf(t)}var r=a(navigator.platform,"Win")?"win":a(navigator.platform,"Mac")?"mac":a(navigator.platform,"CrOS")?"cros":a(navigator.platform,"Linux")?"linux":a(navigator.userAgent,"iPad")||a(navigator.platform,"iPod")||a(navigator.platform,"iPhone")?"ios":"",c=a(navigator.userAgent,"Chrome/")?"chrome":a(navigator.vendor,"Apple")?"safari":a(navigator.userAgent,"MSIE")?"ie":a(navigator.userAgent,"Gecko/")?"moz":a(navigator.userAgent,"Opera/")?"opera":"",l=c+"-"+r;function h(e,t,o){l!==t&&c!==t&&r!==t||Object.keys(o).forEach((function(t){e[t]=o[t]}))}var d={3:{code:"Cancel"},6:{code:"Help"},8:{code:"Backspace"},9:{code:"Tab"},12:{code:"Clear"},13:{code:"Enter"},16:{code:"Shift"},17:{code:"Control"},18:{code:"Alt"},19:{code:"Pause"},20:{code:"CapsLock"},21:{code:"KanaMode"},22:{code:"Lang1"},25:{code:"Lang2"},27:{code:"Escape"},28:{code:"Convert"},29:{code:"NonConvert"},30:{code:"Accept"},31:{code:"ModeChange"},32:{code:"Space"},33:{code:"PageUp"},34:{code:"PageDown"},35:{code:"End"},36:{code:"Home"},37:{code:"ArrowLeft"},38:{code:"ArrowUp"},39:{code:"ArrowRight"},40:{code:"ArrowDown"},41:{code:"Select"},42:{code:"Print"},43:{code:"Execute"},44:{code:"PrintScreen"},45:{code:"Insert"},46:{code:"Delete"},47:{code:"Help"},48:{code:"Digit0",keyCap:"0"},49:{code:"Digit1",keyCap:"1"},50:{code:"Digit2",keyCap:"2"},51:{code:"Digit3",keyCap:"3"},52:{code:"Digit4",keyCap:"4"},53:{code:"Digit5",keyCap:"5"},54:{code:"Digit6",keyCap:"6"},55:{code:"Digit7",keyCap:"7"},56:{code:"Digit8",keyCap:"8"},57:{code:"Digit9",keyCap:"9"},65:{code:"KeyA",keyCap:"a"},66:{code:"KeyB",keyCap:"b"},67:{code:"KeyC",keyCap:"c"},68:{code:"KeyD",keyCap:"d"},69:{code:"KeyE",keyCap:"e"},70:{code:"KeyF",keyCap:"f"},71:{code:"KeyG",keyCap:"g"},72:{code:"KeyH",keyCap:"h"},73:{code:"KeyI",keyCap:"i"},74:{code:"KeyJ",keyCap:"j"},75:{code:"KeyK",keyCap:"k"},76:{code:"KeyL",keyCap:"l"},77:{code:"KeyM",keyCap:"m"},78:{code:"KeyN",keyCap:"n"},79:{code:"KeyO",keyCap:"o"},80:{code:"KeyP",keyCap:"p"},81:{code:"KeyQ",keyCap:"q"},82:{code:"KeyR",keyCap:"r"},83:{code:"KeyS",keyCap:"s"},84:{code:"KeyT",keyCap:"t"},85:{code:"KeyU",keyCap:"u"},86:{code:"KeyV",keyCap:"v"},87:{code:"KeyW",keyCap:"w"},88:{code:"KeyX",keyCap:"x"},89:{code:"KeyY",keyCap:"y"},90:{code:"KeyZ",keyCap:"z"},91:{code:"MetaLeft",location:i},92:{code:"MetaRight",location:s},93:{code:"ContextMenu"},95:{code:"Standby"},96:{code:"Numpad0",keyCap:"0",location:n},97:{code:"Numpad1",keyCap:"1",location:n},98:{code:"Numpad2",keyCap:"2",location:n},99:{code:"Numpad3",keyCap:"3",location:n},100:{code:"Numpad4",keyCap:"4",location:n},101:{code:"Numpad5",keyCap:"5",location:n},102:{code:"Numpad6",keyCap:"6",location:n},103:{code:"Numpad7",keyCap:"7",location:n},104:{code:"Numpad8",keyCap:"8",location:n},105:{code:"Numpad9",keyCap:"9",location:n},106:{code:"NumpadMultiply",keyCap:"*",location:n},107:{code:"NumpadAdd",keyCap:"+",location:n},108:{code:"NumpadComma",keyCap:",",location:n},109:{code:"NumpadSubtract",keyCap:"-",location:n},110:{code:"NumpadDecimal",keyCap:".",location:n},111:{code:"NumpadDivide",keyCap:"/",location:n},112:{code:"F1"},113:{code:"F2"},114:{code:"F3"},115:{code:"F4"},116:{code:"F5"},117:{code:"F6"},118:{code:"F7"},119:{code:"F8"},120:{code:"F9"},121:{code:"F10"},122:{code:"F11"},123:{code:"F12"},124:{code:"F13"},125:{code:"F14"},126:{code:"F15"},127:{code:"F16"},128:{code:"F17"},129:{code:"F18"},130:{code:"F19"},131:{code:"F20"},132:{code:"F21"},133:{code:"F22"},134:{code:"F23"},135:{code:"F24"},144:{code:"NumLock",location:n},145:{code:"ScrollLock"},160:{code:"ShiftLeft",location:i},161:{code:"ShiftRight",location:s},162:{code:"ControlLeft",location:i},163:{code:"ControlRight",location:s},164:{code:"AltLeft",location:i},165:{code:"AltRight",location:s},166:{code:"BrowserBack"},167:{code:"BrowserForward"},168:{code:"BrowserRefresh"},169:{code:"BrowserStop"},170:{code:"BrowserSearch"},171:{code:"BrowserFavorites"},172:{code:"BrowserHome"},173:{code:"AudioVolumeMute"},174:{code:"AudioVolumeDown"},175:{code:"AudioVolumeUp"},176:{code:"MediaTrackNext"},177:{code:"MediaTrackPrevious"},178:{code:"MediaStop"},179:{code:"MediaPlayPause"},180:{code:"LaunchMail"},181:{code:"MediaSelect"},182:{code:"LaunchApp1"},183:{code:"LaunchApp2"},186:{code:"Semicolon",keyCap:";"},187:{code:"Equal",keyCap:"="},188:{code:"Comma",keyCap:","},189:{code:"Minus",keyCap:"-"},190:{code:"Period",keyCap:"."},191:{code:"Slash",keyCap:"/"},192:{code:"Backquote",keyCap:"`"},219:{code:"BracketLeft",keyCap:"["},220:{code:"Backslash",keyCap:"\\"},221:{code:"BracketRight",keyCap:"]"},222:{code:"Quote",keyCap:"'"},226:{code:"IntlBackslash",keyCap:"\\"},229:{code:"Process"},246:{code:"Attn"},247:{code:"CrSel"},248:{code:"ExSel"},249:{code:"EraseEof"},250:{code:"Play"},251:{code:"ZoomToggle"},254:{code:"Clear"}};h(d,"moz",{59:{code:"Semicolon",keyCap:";"},61:{code:"Equal",keyCap:"="},107:{code:"Equal",keyCap:"="},109:{code:"Minus",keyCap:"-"},187:{code:"NumpadAdd",keyCap:"+",location:n},189:{code:"NumpadSubtract",keyCap:"-",location:n}}),h(d,"moz-mac",{12:{code:"NumLock",location:n},173:{code:"Minus",keyCap:"-"}}),h(d,"moz-win",{173:{code:"Minus",keyCap:"-"}}),h(d,"chrome-mac",{93:{code:"MetaRight",location:s}}),h(d,"safari",{3:{code:"Enter"},25:{code:"Tab"}}),h(d,"ios",{10:{code:"Enter",location:o}}),h(d,"safari-mac",{91:{code:"MetaLeft",location:i},93:{code:"MetaRight",location:s},229:{code:"KeyQ",keyCap:"Q"}});var p={};"cros"===r&&(p["U+00A0"]={code:"ShiftLeft",location:i},p["U+00A1"]={code:"ShiftRight",location:s},p["U+00A2"]={code:"ControlLeft",location:i},p["U+00A3"]={code:"ControlRight",location:s},p["U+00A4"]={code:"AltLeft",location:i},p["U+00A5"]={code:"AltRight",location:s}),"chrome-mac"===l&&(p["U+0010"]={code:"ContextMenu"}),"safari-mac"===l&&(p["U+0010"]={code:"ContextMenu"}),"ios"===r&&(p["U+0010"]={code:"Function"},p["U+001C"]={code:"ArrowLeft"},p["U+001D"]={code:"ArrowRight"},p["U+001E"]={code:"ArrowUp"},p["U+001F"]={code:"ArrowDown"},p["U+0001"]={code:"Home"},p["U+0004"]={code:"End"},p["U+000B"]={code:"PageUp"},p["U+000C"]={code:"PageDown"});var u=[];u[i]={16:{code:"ShiftLeft",location:i},17:{code:"ControlLeft",location:i},18:{code:"AltLeft",location:i}},u[s]={16:{code:"ShiftRight",location:s},17:{code:"ControlRight",location:s},18:{code:"AltRight",location:s}},u[n]={13:{code:"NumpadEnter",location:n}},h(u[n],"moz",{109:{code:"NumpadSubtract",location:n},107:{code:"NumpadAdd",location:n}}),h(u[i],"moz-mac",{224:{code:"MetaLeft",location:i}}),h(u[s],"moz-mac",{224:{code:"MetaRight",location:s}}),h(u[s],"moz-win",{91:{code:"MetaRight",location:s}}),h(u[s],"mac",{93:{code:"MetaRight",location:s}}),h(u[n],"chrome-mac",{12:{code:"NumLock",location:n}}),h(u[n],"safari-mac",{12:{code:"NumLock",location:n},187:{code:"NumpadAdd",location:n},189:{code:"NumpadSubtract",location:n},190:{code:"NumpadDecimal",location:n},191:{code:"NumpadDivide",location:n}});var m={ShiftLeft:{key:"Shift"},ShiftRight:{key:"Shift"},ControlLeft:{key:"Control"},ControlRight:{key:"Control"},AltLeft:{key:"Alt"},AltRight:{key:"Alt"},MetaLeft:{key:"Meta"},MetaRight:{key:"Meta"},NumpadEnter:{key:"Enter"},Space:{key:" "},Digit0:{key:"0",shiftKey:")"},Digit1:{key:"1",shiftKey:"!"},Digit2:{key:"2",shiftKey:"@"},Digit3:{key:"3",shiftKey:"#"},Digit4:{key:"4",shiftKey:"$"},Digit5:{key:"5",shiftKey:"%"},Digit6:{key:"6",shiftKey:"^"},Digit7:{key:"7",shiftKey:"&"},Digit8:{key:"8",shiftKey:"*"},Digit9:{key:"9",shiftKey:"("},KeyA:{key:"a",shiftKey:"A"},KeyB:{key:"b",shiftKey:"B"},KeyC:{key:"c",shiftKey:"C"},KeyD:{key:"d",shiftKey:"D"},KeyE:{key:"e",shiftKey:"E"},KeyF:{key:"f",shiftKey:"F"},KeyG:{key:"g",shiftKey:"G"},KeyH:{key:"h",shiftKey:"H"},KeyI:{key:"i",shiftKey:"I"},KeyJ:{key:"j",shiftKey:"J"},KeyK:{key:"k",shiftKey:"K"},KeyL:{key:"l",shiftKey:"L"},KeyM:{key:"m",shiftKey:"M"},KeyN:{key:"n",shiftKey:"N"},KeyO:{key:"o",shiftKey:"O"},KeyP:{key:"p",shiftKey:"P"},KeyQ:{key:"q",shiftKey:"Q"},KeyR:{key:"r",shiftKey:"R"},KeyS:{key:"s",shiftKey:"S"},KeyT:{key:"t",shiftKey:"T"},KeyU:{key:"u",shiftKey:"U"},KeyV:{key:"v",shiftKey:"V"},KeyW:{key:"w",shiftKey:"W"},KeyX:{key:"x",shiftKey:"X"},KeyY:{key:"y",shiftKey:"Y"},KeyZ:{key:"z",shiftKey:"Z"},Numpad0:{key:"0"},Numpad1:{key:"1"},Numpad2:{key:"2"},Numpad3:{key:"3"},Numpad4:{key:"4"},Numpad5:{key:"5"},Numpad6:{key:"6"},Numpad7:{key:"7"},Numpad8:{key:"8"},Numpad9:{key:"9"},NumpadMultiply:{key:"*"},NumpadAdd:{key:"+"},NumpadComma:{key:","},NumpadSubtract:{key:"-"},NumpadDecimal:{key:"."},NumpadDivide:{key:"/"},Semicolon:{key:";",shiftKey:":"},Equal:{key:"=",shiftKey:"+"},Comma:{key:",",shiftKey:"<"},Minus:{key:"-",shiftKey:"_"},Period:{key:".",shiftKey:">"},Slash:{key:"/",shiftKey:"?"},Backquote:{key:"`",shiftKey:"~"},BracketLeft:{key:"[",shiftKey:"{"},Backslash:{key:"\\",shiftKey:"|"},BracketRight:{key:"]",shiftKey:"}"},Quote:{key:"'",shiftKey:'"'},IntlBackslash:{key:"\\",shiftKey:"|"}};h(m,"mac",{MetaLeft:{key:"Meta"},MetaRight:{key:"Meta"}});var y,f,g,x={Add:"+",Decimal:".",Divide:"/",Subtract:"-",Multiply:"*",Spacebar:" ",Esc:"Escape",Nonconvert:"NonConvert",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Menu:"ContextMenu",MediaNextTrack:"MediaTrackNext",MediaPreviousTrack:"MediaTrackPrevious",SelectMedia:"MediaSelect",HalfWidth:"Hankaku",FullWidth:"Zenkaku",RomanCharacters:"Romaji",Crsel:"CrSel",Exsel:"ExSel",Zoom:"ZoomToggle"},w=(y=d,f="code",g={},Object.keys(y).forEach((function(e){var t=y[e];f in t&&(g[t[f]]=t)})),g);try{var v=t&&"location"in new KeyboardEvent("")}catch(e){}function k(e){var t="keyCode"in e?e.keyCode:"which"in e?e.which:0,o=function(){if(v||"keyLocation"in e){var o=v?e.location:e.keyLocation;if(o&&t in u[o])return u[o][t]}return"keyIdentifier"in e&&e.keyIdentifier in p?p[e.keyIdentifier]:t in d?d[t]:null}();if(!o)return null;var i,s=(i=m[o.code])?e.shiftKey&&"shiftKey"in i?i.shiftKey:i.key:o.code;return{code:o.code,key:s,location:o.location,keyCap:o.keyCap}}"KeyboardEvent"in e&&"defineProperty"in Object&&function(){function e(e,t,o){t in e||Object.defineProperty(e,t,o)}if(e(KeyboardEvent.prototype,"code",{get:function(){var e=k(this);return e?e.code:""}}),"key"in KeyboardEvent.prototype){var t=Object.getOwnPropertyDescriptor(KeyboardEvent.prototype,"key");Object.defineProperty(KeyboardEvent.prototype,"key",{get:function(){var e=t.get.call(this);return x.hasOwnProperty(e)?x[e]:e}})}e(KeyboardEvent.prototype,"key",{get:function(){var e=k(this);return e&&"key"in e?e.key:"Unidentified"}}),e(KeyboardEvent.prototype,"location",{get:function(){var e=k(this);return e&&"location"in e?e.location:o}}),e(KeyboardEvent.prototype,"locale",{get:function(){return""}})}(),"queryKeyCap"in e.KeyboardEvent||(e.KeyboardEvent.queryKeyCap=function(e,t){if(e=String(e),!w.hasOwnProperty(e))return"Undefined";if(t&&"en-us"!==String(t).toLowerCase())throw Error("Unsupported locale");var o=w[e];return o.keyCap||o.code||"Undefined"}),e.identifyKey=function(e){if(!("code"in e)){var t=k(e);e.code=t?t.code:"",e.key=t&&"key"in t?t.key:"Unidentified",e.location="location"in e?e.location:"keyLocation"in e?e.keyLocation:t&&"location"in t?t.location:o,e.locale=""}}}(self),function(){ct.sound={},ct.sound.howler=Howler,Howler.orientation(0,-1,0,0,0,1),Howler.pos(0,0,0),ct.sound.howl=Howl;var e=[][0]||2500;ct.sound.useDepth=!1,ct.sound.manageListenerPosition=!1,ct.sound.detect=Howler.codecs,ct.sound.init=function(e,t,o){o=o||{};var i=[];t.wav&&".wav"===t.wav.slice(-4)&&i.push(t.wav),t.mp3&&".mp3"===t.mp3.slice(-4)&&i.push(t.mp3),t.ogg&&".ogg"===t.ogg.slice(-4)&&i.push(t.ogg);var s=!navigator.userAgent.startsWith("ct.js")&&o.music,n=new Howl({src:i,autoplay:!1,preload:!s,html5:s,loop:o.loop,pool:o.poolSize||5,onload:function(){s||ct.res.soundsLoaded++},onloaderror:function(){ct.res.soundsError++,n.buggy=!0,console.error("[ct.sound.howler] Oh no! We couldn't load "+(t.wav||t.mp3||t.ogg)+"!")}});s&&ct.res.soundsLoaded++,ct.res.sounds[e]=n};ct.sound.spawn=function(t,o,i){"function"==typeof(o=o||{})&&(i=o,o={});var s=ct.res.sounds[t],n=s.play();if(o.loop&&s.loop(!0,n),void 0!==o.volume&&s.volume(o.volume,n),void 0!==o.rate&&s.rate(o.rate,n),void 0!==o.x||o.position){if(void 0!==o.x)s.pos(o.x,o.y||0,o.z||0,n);else{const e=o.position;s.pos(e.x,e.y,o.z||(ct.sound.useDepth?e.depth:0),n)}((t,o,i)=>{t.pannerAttr({coneInnerAngle:o.coneInnerAngle||360,coneOuterAngle:o.coneOuterAngle||360,coneOuterGain:o.coneOuterGain||1,distanceModel:o.distanceModel||"linear",maxDistance:o.maxDistance||e,refDistance:o.refDistance||1,rolloffFactor:o.rolloffFactor||1,panningModel:o.panningModel||"HRTF"},i)})(s,o,n)}return i&&s.once("end",i,n),n},ct.sound.stop=function(e,t){ct.sound.playing(e,t)&&ct.res.sounds[e].stop(t)},ct.sound.pause=function(e,t){ct.res.sounds[e].pause(t)},ct.sound.resume=function(e,t){ct.res.sounds[e].play(t)},ct.sound.playing=function(e,t){return ct.res.sounds[e].playing(t)},ct.sound.load=function(e){ct.res.sounds[e].load()},ct.sound.volume=function(e,t,o){return ct.res.sounds[e].volume(t,o)},ct.sound.fade=function(e,t,o,i){if(ct.sound.playing(e,i)){var s=ct.res.sounds[e],n=i?s.volume(i):s.volume;try{s.fade(n,t,o,i)}catch(o){console.warn("Could not reliably fade a sound, reason:",o),ct.sound.volume(e,t,i)}}},ct.sound.moveListener=function(e,t,o){Howler.pos(e,t,o||0)},ct.sound.position=function(e,t,o,i,s){if(ct.sound.playing(e,t)){var n=ct.res.sounds[e],a=n.pos(t);n.pos(o,i,s||a[2],t)}},ct.sound.globalVolume=Howler.volume.bind(Howler),ct.sound.exists=function(e){return e in ct.res.sounds}}(),function(ct){var e=function(e,t){ct.inputs.registry["touch."+e]=t},t=0,o=0,i=0,s=0,n=0,a=()=>{e("Any",ct.touch.events.length>0?1:0),e("Double",ct.touch.events.length>1?1:0),e("Triple",ct.touch.events.length>2?1:0)},r=e=>{const t=ct.pixiApp.view.getBoundingClientRect(),o=(e.clientX-t.left)/t.width*ct.camera.width,i=(e.clientY-t.top)/t.height*ct.camera.height,s=ct.u.uiToGameCoord(o,i);return{id:e.identifier,x:s.x,y:s.y,xui:o,yui:i,xprev:s.x,yprev:s.y,xuiprev:o,yuiprev:i,r:e.radiusX?Math.max(e.radiusX,e.radiusY):0}},c=e=>{for(let t=0;t<ct.touch.events.length;t++)if(ct.touch.events[t].id===e)return ct.touch.events[t];return!1},l=e=>{for(let t=0;t<ct.touch.events.length;t++)if(ct.touch.events[t].id===e)return t;return-1},h=function(e){e.preventDefault();for(let o=0,i=e.changedTouches.length;o<i;o++){var t=r(e.changedTouches[o]);ct.touch.events.push(t),ct.touch.x=t.x,ct.touch.y=t.y,ct.touch.xui=t.xui,ct.touch.yui=t.yui}a()},d=function(e){e.preventDefault();for(let t=0,o=e.changedTouches.length;t<o;t++){const o=e.changedTouches[t],i=c(e.changedTouches[t].identifier);if(i){const e=ct.pixiApp.view.getBoundingClientRect();i.xui=(o.clientX-e.left)/e.width*ct.camera.width,i.yui=(o.clientY-e.top)/e.height*ct.camera.height,({x:i.x,y:i.y}=ct.u.uiToGameCoord(i.xui,i.yui)),i.r=o.radiusX?Math.max(o.radiusX,o.radiusY):0,ct.touch.x=i.x,ct.touch.y=i.y,ct.touch.xui=i.xui,ct.touch.yui=i.yui}}},p=function(e){e.preventDefault();var t=e.changedTouches;for(let e=0;e<t.length;e++){const o=l(t[e].identifier);-1!==o&&ct.touch.released.push(ct.touch.events.splice(o,1)[0])}a()},u=function(e){const t=ct.pixiApp.view.getBoundingClientRect();var o={id:-1,xui:(e.clientX-t.left)*ct.camera.width/t.width,yui:(e.clientY-t.top)*ct.camera.height/t.height,r:0};({x:o.x,y:o.y}=ct.u.uiToGameCoord(o.xui,o.yui)),ct.touch.events.push(o),ct.touch.x=o.x,ct.touch.y=o.y,ct.touch.xui=o.xui,ct.touch.yui=o.yui,a()},m=function(e){const t=ct.pixiApp.view.getBoundingClientRect(),o=c(-1);o&&(o.xui=(e.clientX-t.left)*ct.camera.width/t.width,o.yui=(e.clientY-t.top)*ct.camera.height/t.height,({x:o.x,y:o.y}=ct.u.uiToGameCoord(o.xui,o.yui)),ct.touch.x=o.x,ct.touch.y=o.y,ct.touch.xui=o.xui,ct.touch.yui=o.yui)},y=function(){ct.touch.events=ct.touch.events.filter((e=>-1!==e.id)),a()};ct.touch={released:[],setupListeners(){document.addEventListener("touchstart",h,!1),document.addEventListener("touchstart",(()=>{ct.touch.enabled=!0}),{once:!0}),document.addEventListener("touchend",p,!1),document.addEventListener("touchcancel",p,!1),document.addEventListener("touchmove",d,!1)},setupMouseListeners(){document.addEventListener("mousemove",m,!1),document.addEventListener("mouseup",y,!1),document.addEventListener("mousedown",u,!1)},enabled:!1,events:[],x:0,y:0,xprev:0,yprev:0,xui:0,yui:0,xuiprev:0,yuiprev:0,clear(){ct.touch.events.length=0,ct.touch.clearReleased(),a()},clearReleased(){ct.touch.released.length=0},collide(e,t,o){var i=o?ct.touch.released:ct.touch.events;if(void 0!==t&&!1!==t){const o=l(t);return-1!==o&&ct.place.collide(e,{x:i[o].x,y:i[o].y,shape:{type:i[o].r?"circle":"point",r:i[o].r},scale:{x:1,y:1}})}for(let t=0,o=i.length;t<o;t++)if(ct.place.collide(e,{x:i[t].x,y:i[t].y,shape:{type:i[t].r?"circle":"point",r:i[t].r},scale:{x:1,y:1}}))return!0;return!1},collideUi(e,t,o){var i=o?ct.touch.released:ct.touch.events;if(void 0!==t&&!1!==t){const o=l(t);return-1!==o&&ct.place.collide(e,{x:i[o].xui,y:i[o].yui,shape:{type:i[o].r?"circle":"point",r:i[o].r},scale:{x:1,y:1}})}for(let t=0,o=i.length;t<o;t++)if(ct.place.collide(e,{x:i[t].xui,y:i[t].yui,shape:{type:i[t].r?"circle":"point",r:i[t].r},scale:{x:1,y:1}}))return!0;return!1},hovers:(e,t,o)=>ct.mouse&&ct.mouse.hovers(e)||ct.touch.collide(e,t,o),hoversUi:(e,t,o)=>ct.mouse&&ct.mouse.hoversUi(e)||ct.touch.collideUi(e,t,o),getById:c,updateGestures:function(){let a=0,r=0;const c=ct.pixiApp.view.getBoundingClientRect();for(const e of ct.touch.events)a+=(e.clientX-c.left)/c.width,r+=(e.clientY-c.top)/c.height;a/=ct.touch.events.length,r/=ct.touch.events.length;let l=0,h=s;if(ct.touch.events.length>1){const e=[ct.touch.events[0],ct.touch.events[1]].sort(((e,t)=>e.id-t.id));l=ct.u.pdn(e[0].x,e[0].y,e[1].x,e[1].y),h=ct.u.pdc(e[0].x,e[0].y,e[1].x,e[1].y)}t===ct.touch.events.length?(ct.touch.events.length>1?(e("DeltaRotation",ct.u.degToRad(ct.u.deltaDir(n,l))),e("DeltaPinch",h/s-1)):(e("DeltaPinch",0),e("DeltaRotation",0)),ct.touch.events.length?(e("PanX",a-o),e("PanY",r-i)):(e("PanX",0),e("PanY",0))):(t=ct.touch.events.length,e("DeltaPinch",0),e("DeltaRotation",0),e("PanX",0),e("PanY",0)),o=a,i=r,n=l,s=h}}}(ct),function(ct){const e=0*Math.PI;var t=function(t){switch(t.shape.type){case"rect":return function(e){const{shape:t}=e,o=new SSCD.Vector(e.x,e.y);if(0===e.angle)return o.x-=e.scale.x>0?t.left*e.scale.x:-e.scale.x*t.right,o.y-=e.scale.y>0?t.top*e.scale.y:-t.bottom*e.scale.y,new SSCD.Rectangle(o,new SSCD.Vector(Math.abs((t.left+t.right)*e.scale.x),Math.abs((t.bottom+t.top)*e.scale.y)));const i=ct.u.rotate(-t.left*e.scale.x,-t.top*e.scale.y,e.angle),s=ct.u.rotate(-t.left*e.scale.x,t.bottom*e.scale.y,e.angle),n=ct.u.rotate(t.right*e.scale.x,t.bottom*e.scale.y,e.angle),a=ct.u.rotate(t.right*e.scale.x,-t.top*e.scale.y,e.angle);return new SSCD.LineStrip(o,[new SSCD.Vector(i.x,i.y),new SSCD.Vector(s.x,s.y),new SSCD.Vector(n.x,n.y),new SSCD.Vector(a.x,a.y)],!0)}(t);case"circle":return function(t){const{shape:o}=t,i=new SSCD.Vector(t.x,t.y);if(Math.abs(t.scale.x)===Math.abs(t.scale.y))return new SSCD.Circle(i,o.r*Math.abs(t.scale.x));const s=[];for(let i=0;i<16;i++){const n=[Math.sin(e/16*i)*o.r*t.scale.x,Math.cos(e/16*i)*o.r*t.scale.y];if(0!==t.angle){const{x:e,y:o}=ct.u.rotate(n[0],n[1],t.angle);s.push(e,o)}else s.push(n)}return new SSCD.LineStrip(i,s,!0)}(t);case"strip":return function(e){const{shape:t}=e,o=new SSCD.Vector(e.x,e.y),i=[];if(0!==e.angle)for(const o of t.points){const{x:t,y:s}=ct.u.rotate(o.x*e.scale.x,o.y*e.scale.y,e.angle);i.push(new SSCD.Vector(t,s))}else for(const o of t.points)i.push(new SSCD.Vector(o.x*e.scale.x,o.y*e.scale.y));return new SSCD.LineStrip(o,i,Boolean(t.closedStrip))}(t);case"line":return function(e){const{shape:t}=e;if(0!==e.angle){const{x:o,y:i}=ct.u.rotate(t.x1*e.scale.x,t.y1*e.scale.y,e.angle),{x:s,y:n}=ct.u.rotate(t.x2*e.scale.x,t.y2*e.scale.y,e.angle);return new SSCD.Line(new SSCD.Vector(e.x+o,e.y+i),new SSCD.Vector(s-o,n-i))}return new SSCD.Line(new SSCD.Vector(e.x+t.x1*e.scale.x,e.y+t.y1*e.scale.y),new SSCD.Vector((t.x2-t.x1)*e.scale.x,(t.y2-t.y1)*e.scale.y))}(t);default:return new SSCD.Circle(new SSCD.Vector(t.x,t.y),0)}};const o=(e,t,o)=>t.template===o,i=(e,t,o)=>!o||o===t.cgroup,s=function(e,o,i,s,n,a,r){const c=e.x,l=e.y,h=e._shape;let d,p;void 0===o||c===o&&l===i?(d=e.$chashes||ct.place.getHashes(e),e._shape=e._shape||t(e)):(e.x=o,e.y=i,e._shape=t(e),d=ct.place.getHashes(e)),n&&(p=[]);for(const t of d){const o=s[t];if(o)for(const t of o)if(t!==e&&a(e,t,r)&&ct.place.collide(e,t)){if(!n)return c===e.x&&l===e.y||(e.x=c,e.y=l,e._shape=h),t;p.includes(t)||p.push(t)}}return c===e.x&&l===e.y||(e.x=c,e.y=l,e._shape=h),!!n&&p};ct.place={m:1,gridX:512,gridY:512,grid:{},tileGrid:{},getHashes(e){var t=[],o=Math.round(e.x/ct.place.gridX),i=Math.round(e.y/ct.place.gridY),s=Math.sign(e.x-ct.place.gridX*o),n=Math.sign(e.y-ct.place.gridY*i);return t.push(`${o}:${i}`),s&&(t.push(`${o+s}:${i}`),n&&t.push(`${o+s}:${i+n}`)),n&&t.push(`${o}:${i+n}`),t},drawDebugGraphic(e){const o=this._shape||t(this),i=this.$cDebugCollision;let s=65535;if(this instanceof Copy?s=26367:this instanceof PIXI.Sprite&&(s=6684927),this.$cHadCollision&&(s=65280),i.lineStyle(2,s),o instanceof SSCD.Rectangle){const t=o.get_position(),n=o.get_size();i.beginFill(s,.1),e?i.drawRect(t.x,t.y,n.x,n.y):i.drawRect(t.x-this.x,t.y-this.y,n.x,n.y),i.endFill()}else if(o instanceof SSCD.LineStrip)if(e){i.moveTo(o.__points[0].x+this.x,o.__points[0].y+this.y);for(let e=1;e<o.__points.length;e++)i.lineTo(o.__points[e].x+this.x,o.__points[e].y+this.y)}else{i.moveTo(o.__points[0].x,o.__points[0].y);for(let e=1;e<o.__points.length;e++)i.lineTo(o.__points[e].x,o.__points[e].y)}else if(o instanceof SSCD.Circle&&o.get_radius()>0)i.beginFill(s,.1),e?i.drawCircle(this.x,this.y,o.get_radius()):i.drawCircle(0,0,o.get_radius()),i.endFill();else if(o instanceof SSCD.Line)if(e){const e=o.get_p1(),t=o.get_p2();i.moveTo(e.x,e.y).lineTo(t.x,t.y)}else i.moveTo(o.__position.x,o.__position.y).lineTo(o.__position.x+o.__dest.x,o.__position.y+o.__dest.y);else e?i.moveTo(-16+this.x,-16+this.y).lineTo(16+this.x,16+this.y).moveTo(-16+this.x,16+this.y).lineTo(16+this.x,-16+this.y):i.moveTo(-16,-16).lineTo(16,16).moveTo(-16,16).lineTo(16,-16)},collide(e,o){if(e._shape=e._shape||t(e),o._shape=o._shape||t(o),"strip"===e._shape.__type||"strip"===o._shape.__type||"complex"===e._shape.__type||"complex"===o._shape.__type){const t=e._shape.get_aabb(),i=o._shape.get_aabb();if(!t.intersects(i))return!1}return!!SSCD.CollisionManager.test_collision(e._shape,o._shape)},occupied(e,t,o,n){"number"!=typeof o&&(n=t,t=void 0,o=void 0);const a=s(e,t,o,ct.place.grid,!1,i,n);return a||s(e,t,o,ct.place.tileGrid,!1,i,n)},occupiedMultiple(e,t,o,n){"number"!=typeof o&&(n=t,t=void 0,o=void 0);const a=s(e,t,o,ct.place.grid,!0,i,n),r=s(e,t,o,ct.place.tileGrid,!0,i,n);return a.concat(r)},free:(e,t,o,i)=>!ct.place.occupied(e,t,o,i),meet:(e,t,i,n)=>("number"!=typeof i&&(n=t,t=void 0,i=void 0),s(e,t,i,ct.place.grid,!1,o,n)),meetMultiple:(e,t,i,n)=>("number"!=typeof i&&(n=t,t=void 0,i=void 0),s(e,t,i,ct.place.grid,!0,o,n)),copies:(e,t,o,n)=>("number"!=typeof o&&(n=t,t=void 0,o=void 0),s(e,t,o,ct.place.grid,!1,i,n)),copiesMultiple:(e,t,o,n)=>("number"!=typeof o&&(n=t,t=void 0,o=void 0),s(e,t,o,ct.place.grid,!0,i,n)),tiles:(e,t,o,n)=>("number"!=typeof o&&(n=t,t=void 0,o=void 0),s(e,t,o,ct.place.tileGrid,!1,i,n)),tilesMultiple:(e,t,o,n)=>("number"!=typeof o&&(n=t,t=void 0,o=void 0),s(e,t,o,ct.place.tileGrid,!0,i,n)),lastdist:null,nearest(e,t,o){const i=ct.templates.list[o];if(i.length>0){var s=Math.hypot(e-i[0].x,t-i[0].y),n=i[0];for(const o of i)Math.hypot(e-o.x,t-o.y)<s&&(s=Math.hypot(e-o.x,t-o.y),n=o);return ct.place.lastdist=s,n}return!1},furthest(e,t,o){const i=ct.templates.list[o];if(i.length>0){var s=Math.hypot(e-i[0].x,t-i[0].y),n=i[0];for(const o of i)Math.hypot(e-o.x,t-o.y)>s&&(s=Math.hypot(e-o.x,t-o.y),n=o);return ct.place.lastdist=s,n}return!1},enableTilemapCollisions(e,o){const i=o||e.cgroup;if(e.addedCollisions)throw new Error("[ct.place] The tilemap already has collisions enabled.");e.cgroup=i;for(const o of e.pixiTiles){o._shape=t(o),o.cgroup=i,o.$chashes=ct.place.getHashes(o);for(const e of o.$chashes)e in ct.place.tileGrid?ct.place.tileGrid[e].push(o):ct.place.tileGrid[e]=[o];o.depth=e.depth}e.addedCollisions=!0},moveAlong(e,t,o,i,s){if(!o)return!1;"number"==typeof i&&(s=i,i=void 0),s=Math.abs(s||1),o<0&&(o*=-1,t+=180);for(var n=Math.cos(t*Math.PI/180)*s,a=Math.sin(t*Math.PI/180)*s;o>0;){o<1&&(n*=o,a*=o);const t=ct.place.occupied(e,e.x+n,e.y+a,i);if(t)return t;e.x+=n,e.y+=a,delete e._shape,o--}return!1},moveByAxes(e,t,o,i,s){if(t===o===0)return!1;"number"==typeof i&&(s=i,i=void 0);const n={x:!1,y:!1};for(s=Math.abs(s||1);Math.abs(t)>s;){const o=ct.place.occupied(e,e.x+Math.sign(t)*s,e.y,i);if(o){n.x=o;break}e.x+=Math.sign(t)*s,t-=Math.sign(t)*s}for(;Math.abs(o)>s;){const t=ct.place.occupied(e,e.x,e.y+Math.sign(o)*s,i);if(t){n.y=t;break}e.y+=Math.sign(o)*s,o-=Math.sign(o)*s}return Math.abs(t)<s&&ct.place.free(e,e.x+t,e.y,i)&&(e.x+=t),Math.abs(o)<s&&ct.place.free(e,e.x,e.y+o,i)&&(e.y+=o),!(!n.x&&!n.y)&&n},go(e,t,o,i,s){if(ct.u.pdc(e.x,e.y,t,o)<i)return void(ct.place.free(e,t,o,s)&&(e.x=t,e.y=o,delete e._shape));var n=ct.u.pdn(e.x,e.y,t,o);let a=e.x+ct.u.ldx(i,n),r=e.y+ct.u.ldy(i,n);if(ct.place.free(e,a,r,s))e.x=a,e.y=r,delete e._shape,e.dir=n;else for(var c=-1;c<=1;c+=2)for(var l=30;l<150;l+=30)if(a=e.x+ct.u.ldx(i,n+l*ct.place.m*c),r=e.y+ct.u.ldy(i,n+l*ct.place.m*c),ct.place.free(e,a,r,s))return e.x=a,e.y=r,delete e._shape,void(e.dir=n+l*ct.place.m*c)},traceCustom(e,t,o,i){const s=[];if(!t)return i?ct.place.occupiedMultiple(e,o):ct.place.occupied(e,o);for(const t of ct.stack)if((!o||t.cgroup===o)&&ct.place.collide(e,t)){if(!i)return t;s.push(t)}for(const t of ct.templates.list.TILEMAP)if(t.addedCollisions&&(!o||t.cgroup===o))for(const o of t.pixiTiles)if(ct.place.collide(e,o)){if(!i)return o;s.push(o)}return!!i&&s},traceLine(e,t,o){let i=!1;(Math.abs(e.x1-e.x2)>ct.place.gridX||Math.abs(e.y1-e.y2)>ct.place.gridY)&&(i=!0);const s={x:e.x1,y:e.y1,scale:{x:1,y:1},rotation:0,angle:0,shape:{type:"line",x1:0,y1:0,x2:e.x2-e.x1,y2:e.y2-e.y1}},n=ct.place.traceCustom(s,i,t,o);return o&&n.sort((function(t,o){return ct.u.pdc(e.x1,e.y1,t.x,t.y)-ct.u.pdc(e.x1,e.y1,o.x,o.y)})),n},traceRect(e,t,o){let i=!1;"x1"in(e={...e})&&(e.x=e.x1,e.y=e.y1,e.width=e.x2-e.x1,e.height=e.y2-e.y1),(Math.abs(e.width)>ct.place.gridX||Math.abs(e.height)>ct.place.gridY)&&(i=!0);const s={x:e.x,y:e.y,scale:{x:1,y:1},rotation:0,angle:0,shape:{type:"rect",left:0,top:0,right:e.width,bottom:e.height}};return ct.place.traceCustom(s,i,t,o)},traceCircle(e,t,o){let i=!1;(2*e.radius>ct.place.gridX||2*e.radius>ct.place.gridY)&&(i=!0);const s={x:e.x,y:e.y,scale:{x:1,y:1},rotation:0,angle:0,shape:{type:"circle",r:e.radius}};return ct.place.traceCustom(s,i,t,o)},tracePolyline(e,t,o){const i={x:0,y:0,scale:{x:1,y:1},rotation:0,angle:0,shape:{type:"strip",points:e}};return ct.place.traceCustom(i,!0,t,o)},tracePoint(e,t,o){const i={x:e.x,y:e.y,scale:{x:1,y:1},rotation:0,angle:0,shape:{type:"point"}};return ct.place.traceCustom(i,!1,t,o)}},ct.place.traceRectange=ct.place.traceRect,setInterval((function(){ct.place.m*=-1}),789)}(ct),function(ct){document.body.style.overflow="hidden";var e=ct.pixiApp.view;var t=function(){const{mode:t}=ct.fittoscreen,o=ct.highDensity&&window.devicePixelRatio||1,i=window.innerWidth/ct.roomWidth,s=window.innerHeight/ct.roomHeight;let n=Math.min(i,s);var a,r,c,l;"fastScaleInteger"===t&&(n=n<1?n:Math.floor(n)),"expandViewport"===t||"expand"===t?(a=Math.ceil(window.innerWidth*o),r=Math.ceil(window.innerHeight*o),c=window.innerWidth,l=window.innerHeight):"fastScale"===t||"fastScaleInteger"===t?(a=Math.ceil(ct.roomWidth*o),r=Math.ceil(ct.roomHeight*o),c=ct.roomWidth,l=ct.roomHeight):"scaleFit"!==t&&"scaleFill"!==t||("scaleFill"===t?(a=Math.ceil(ct.roomWidth*i*o),r=Math.ceil(ct.roomHeight*s*o),c=window.innerWidth/n,l=window.innerHeight/n):(a=Math.ceil(ct.roomWidth*n*o),r=Math.ceil(ct.roomHeight*n*o),c=ct.roomWidth,l=ct.roomHeight)),ct.pixiApp.renderer.resize(a,r),ct.pixiApp.stage.scale.x=ct.pixiApp.stage.scale.y="scaleFill"!==t&&"scaleFit"!==t?o:o*n,e.style.width=Math.ceil(a/o)+"px",e.style.height=Math.ceil(r/o)+"px",ct.camera&&(ct.camera.width=c,ct.camera.height=l),function(t,o){"fastScale"===t||"fastScaleInteger"===t?(e.style.transform=`translate(-50%, -50%) scale(${o})`,e.style.position="absolute",e.style.top="50%",e.style.left="50%"):"expandViewport"===t||"expand"===t||"scaleFill"===t?(e.style.position="static",e.style.top="unset",e.style.left="unset"):"scaleFit"===t&&(e.style.transform="translate(-50%, -50%)",e.style.position="absolute",e.style.top="50%",e.style.left="50%")}(t,n)},o=function e(){!function(){try{const e=require("electron").remote.BrowserWindow.getFocusedWindow();return void e.setFullScreen(!e.isFullScreen())}catch(e){}var e=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement,t=document.getElementById("ct"),o=t.requestFullscreen||t.webkitRequestFullscreen||t.mozRequestFullScreen||t.msRequestFullscreen,i=document.exitFullscreen||document.webkitExitFullscreen||document.mozCancelFullScreen||document.msExitFullscreen;if(e)i&&i.call(document);else{var s=o.call(t);s&&s.catch((function(e){console.error("[ct.fittoscreen]",e)}))}}(),document.removeEventListener("mouseup",e),document.removeEventListener("keyup",e),document.removeEventListener("click",e)};window.addEventListener("resize",t),ct.fittoscreen=t,ct.fittoscreen.toggleFullscreen=function(){document.addEventListener("mouseup",o),document.addEventListener("keyup",o),document.addEventListener("click",o)};var i="scaleFit";Object.defineProperty(ct.fittoscreen,"mode",{configurable:!1,enumerable:!0,set(e){i=e},get:()=>i}),ct.fittoscreen.mode=i,ct.fittoscreen.getIsFullscreen=function(){try{return require("electron").remote.BrowserWindow.getFocusedWindow.isFullScreen}catch(e){}return document.fullscreen||document.webkitIsFullScreen||document.mozFullScreen}}(ct),function(ct){const e=document.querySelector(".ct-aLoadingScreen"),t=e.querySelector(".ct-aLoadingBar"),o=window.dragonBones?dragonBones.PixiFactory.factory:null;ct.res={sounds:{},textures:{},skeletons:{},loadScript(e=ct.u.required("url","ct.res.loadScript")){var t=document.createElement("script");t.src=e;const o=new Promise(((e,o)=>{t.onload=()=>{e()},t.onerror=()=>{o()}}));return document.getElementsByTagName("head")[0].appendChild(t),o},loadTexture(e=ct.u.required("url","ct.res.loadTexture"),t=ct.u.required("name","ct.res.loadTexture"),o={}){const i=new PIXI.Loader;return i.add(e,e),new Promise(((t,o)=>{i.load(((e,o)=>{t(o)})),i.onError.add((()=>{o(new Error("[ct.res] Could not load image "+e))}))})).then((i=>{const s=[i[e].texture];return s.shape=s[0].shape=o.shape||{},s[0].defaultAnchor=new PIXI.Point(o.anchor.x||0,o.anchor.x||0),ct.res.textures[t]=s,s}))},loadDragonBonesSkeleton(e,t,o,i=ct.u.required("name","ct.res.loadDragonBonesSkeleton")){const s=dragonBones.PixiFactory.factory,n=new PIXI.Loader;return n.add(e,e).add(t,t).add(o,o),new Promise(((i,s)=>{n.load((()=>{i()})),n.onError.add((()=>{s(new Error(`[ct.res] Could not load skeleton with _ske.json: ${e}, _tex.json: ${t}, _tex.png: ${o}.`))}))})).then((()=>{s.parseDragonBonesData(n.resources[e].data),s.parseTextureAtlasData(n.resources[t].data,n.resources[o].texture),ct.res.skeletons[i]=n.resources[e].data}))},loadAtlas(e=ct.u.required("url","ct.res.loadAtlas")){const t=new PIXI.Loader;return t.add(e,e),new Promise(((o,i)=>{t.load(((e,t)=>{o(t)})),t.onError.add((()=>{i(new Error("[ct.res] Could not load atlas "+e))}))})).then((t=>{const o=t[e].spritesheet;for(const e in o.animations){const t=o.animations[e],i=o.data.animations;for(let s=0,n=i[e].length;s<n;s++){const n=i[e][s];t[s].shape=o.data.frames[n].shape}t.shape=t[0].shape||{},ct.res.textures[e]=t}return Object.keys(o.animations)}))},loadBitmapFont(e=ct.u.required("url","ct.res.loadBitmapFont"),t=ct.u.required("name","ct.res.loadBitmapFont")){const o=new PIXI.Loader;return o.add(t,e),new Promise(((t,i)=>{o.load(((e,o)=>{t(o)})),o.onError.add((()=>{i(new Error("[ct.res] Could not load bitmap font "+e))}))}))},loadGame(){const o=["./img/a0.json"],i={pausedbg:{source:"./img/t0.png",shape:{type:"rect",top:0,bottom:800,left:0,right:544},anchor:{x:0,y:0}},screen_intro2:{source:"./img/t1.png",shape:{type:"rect",top:0,bottom:960,left:0,right:544},anchor:{x:0,y:0}},screen_intro:{source:"./img/t2.png",shape:{type:"rect",top:0,bottom:960,left:0,right:544},anchor:{x:0,y:0}},screen_end:{source:"./img/t3.png",shape:{type:"rect",top:0,bottom:960,left:0,right:544},anchor:{x:0,y:0}},"linea-cubierta":{source:"./img/t4.png",shape:{type:"rect",top:120,bottom:120,left:44,right:0},anchor:{x:1,y:.5}},bottom:{source:"./img/t5.png",shape:{type:"rect",top:156,bottom:0,left:272,right:272},anchor:{x:.5,y:1}},screen_intro_extra:{source:"./img/t6.png",shape:{type:"rect",top:0,bottom:960,left:0,right:544},anchor:{x:0,y:0}}},s=[{name:"wave",wav:!1,mp3:"./snd/efe1e943-a521-4ffa-9341-067dd7e77d99.mp3",ogg:!1,poolSize:5,isMusic:!1},{name:"end",wav:!1,mp3:"./snd/4db9c70a-ee26-4848-96d6-91f8a462ab0a.mp3",ogg:!1,poolSize:5,isMusic:!1},{name:"sillokill",wav:!1,mp3:"./snd/3e2b2be2-fd47-468e-973d-f75dff920188.mp3",ogg:!1,poolSize:2,isMusic:!1},{name:"grab",wav:!1,mp3:"./snd/fb8310ff-fc9f-4987-a5de-06bfc44720f3.mp3",ogg:!1,poolSize:2,isMusic:!1},{name:"release",wav:!1,mp3:"./snd/eb7c55c9-0611-4676-a0e4-cc7f1f0e64cb.mp3",ogg:!1,poolSize:2,isMusic:!1},{name:"ok",wav:!1,mp3:"./snd/b955c811-ce69-4017-8cb2-51fc902aff7c.mp3",ogg:!1,poolSize:2,isMusic:!1},{name:"okgold",wav:!1,mp3:"./snd/0d7328de-bd1f-4bf6-86cc-3c0c978f3073.mp3",ogg:!1,poolSize:2,isMusic:!1}],n={},a=[];if(s.length&&!ct.sound)throw new Error("[ct.res] No sound system found. Make sure you enable one of the `sound` catmods. If you don't need sounds, remove them from your ct.js project.");const r=o.length;let c=0;const l=[];l.push(...o.map((o=>ct.res.loadAtlas(o).then((o=>{var i;return c++,i=c/r*100,e.setAttribute("data-progress",i),t.style.width=i+"%",o})))));for(const e in i)l.push(ct.res.loadTexture(i[e].source,e,{anchor:i[e].anchor,shape:i[e].shape}));for(const e in n)l.push(ct.res.loadBitmapFont(n[e],e));for(const e of a)ct.res.loadDragonBonesSkeleton(...e);for(const e of s)ct.sound.init(e.name,{wav:e.wav||!1,mp3:e.mp3||!1,ogg:e.ogg||!1},{poolSize:e.poolSize,music:e.isMusic});Promise.all(l).then((()=>{ct.mouse.setupListeners(),ct.touch.setupListeners(),ct.touch.setupMouseListeners(),Object.defineProperty(ct.templates.Copy.prototype,"cgroup",{set:function(e){this.$cgroup=e},get:function(){return this.$cgroup}}),Object.defineProperty(ct.templates.Copy.prototype,"moveContinuous",{value:function(e,t){return this.gravity&&(this.hspeed+=this.gravity*ct.delta*Math.cos(this.gravityDir*Math.PI/180),this.vspeed+=this.gravity*ct.delta*Math.sin(this.gravityDir*Math.PI/180)),ct.place.moveAlong(this,this.direction,this.speed*ct.delta,e,t)}}),Object.defineProperty(ct.templates.Copy.prototype,"moveContinuousByAxes",{value:function(e,t){return this.gravity&&(this.hspeed+=this.gravity*ct.delta*Math.cos(this.gravityDir*Math.PI/180),this.vspeed+=this.gravity*ct.delta*Math.sin(this.gravityDir*Math.PI/180)),ct.place.moveByAxes(this,this.hspeed*ct.delta,this.vspeed*ct.delta,e,t)}}),Object.defineProperty(ct.templates.Tilemap.prototype,"enableCollisions",{value:function(e){ct.place.enableTilemapCollisions(this,e)}}),e.classList.add("hidden"),ct.pixiApp.ticker.add(ct.loop),ct.rooms.forceSwitch(ct.rooms.starting)})).catch(console.error)},getTexture(e,t){if(null===t&&(t=void 0),-1===e)return void 0!==t?PIXI.Texture.EMPTY:[PIXI.Texture.EMPTY];if(!(e in ct.res.textures))throw new Error("Attempt to get a non-existent texture "+e);const o=ct.res.textures[e];return void 0!==t?o[t]:o},getTextureShape(e){if(-1===e)return{};if(!(e in ct.res.textures))throw new Error("Attempt to get a shape of a non-existent texture "+e);return ct.res.textures[e].shape},makeSkeleton(e,t){const i=ct.res.skeletons[e],s=o.buildArmatureDisplay("Armature",i.name,t);return s.ctName=e,s.on(dragonBones.EventObject.SOUND_EVENT,(function(e){ct.sound.exists(e.name)?ct.sound.spawn(e.name):console.warn(`Skeleton ${s.ctName} tries to play a non-existing sound ${e.name} at animation ${s.animation.lastAnimationName}`)})),s}},ct.res.loadGame()}(ct),ct.content=JSON.parse("{}");