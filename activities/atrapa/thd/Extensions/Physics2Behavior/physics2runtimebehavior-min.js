gdjs.Physics2SharedData=function(t,e){this.gravityX=e.gravityX,this.gravityY=e.gravityY,this.scaleX=0===e.scaleX?100:e.scaleX,this.scaleY=0===e.scaleY?100:e.scaleY,this.invScaleX=1/this.scaleX,this.invScaleY=1/this.scaleY,this.timeStep=1/60,this.frameTime=0,this.stepped=!1,this.timeScale=1,this.world=new Box2D.b2World(new Box2D.b2Vec2(this.gravityX,this.gravityY),!0),this.staticBody=this.world.CreateBody(new Box2D.b2BodyDef),this.contactListener=new Box2D.JSContactListener,this.contactListener.BeginContact=function(t){var e=Box2D.wrapPointer(t,Box2D.b2Contact);if(null!==e.GetFixtureA().GetBody()&&null!==e.GetFixtureB().GetBody()){var i=e.GetFixtureA().GetBody().gdjsAssociatedBehavior,o=e.GetFixtureB().GetBody().gdjsAssociatedBehavior;i.currentContacts.push(o),o.currentContacts.push(i)}},this.contactListener.EndContact=function(t){var e=Box2D.wrapPointer(t,Box2D.b2Contact);if(null!==e.GetFixtureA().GetBody()&&null!==e.GetFixtureB().GetBody()){var i=e.GetFixtureA().GetBody().gdjsAssociatedBehavior,o=e.GetFixtureB().GetBody().gdjsAssociatedBehavior,s=i.currentContacts.indexOf(o);-1!==s&&i.currentContacts.splice(s,1),s=o.currentContacts.indexOf(i),-1!==s&&o.currentContacts.splice(s,1)}},this.contactListener.PreSolve=function(){},this.contactListener.PostSolve=function(){},this.world.SetContactListener(this.contactListener),this._nextJointId=1,this.joints={}},gdjs.Physics2SharedData.getSharedData=function(t,e){if(!t.physics2SharedData){var i=t.getInitialSharedDataForBehavior(e);t.physics2SharedData=new gdjs.Physics2SharedData(t,i)}return t.physics2SharedData},gdjs.Physics2SharedData.prototype.step=function(t){if(this.frameTime+=t,this.frameTime>=this.timeStep){var e=Math.floor(this.frameTime/this.timeStep);this.frameTime-=e*this.timeStep,e>5&&(e=5);for(var i=0;i<e;i++)this.world.Step(this.timeStep*this.timeScale,8,10);this.world.ClearForces()}this.stepped=!0},gdjs.registerRuntimeSceneUnloadedCallback(function(t){t.physics2SharedData&&t.physics2SharedData.world&&Box2D.destroy(t.physics2SharedData.world)}),gdjs.Physics2SharedData.prototype.clearBodyJoints=function(t){for(var e in this.joints)this.joints.hasOwnProperty(e)&&(this.joints[e].GetBodyA()!==t&&this.joints[e].GetBodyB()!==t||this.removeJoint(e))},gdjs.Physics2SharedData.prototype.addJoint=function(t){return this.joints[this._nextJointId.toString(10)]=t,this._nextJointId++},gdjs.Physics2SharedData.prototype.getJoint=function(t){return t=t.toString(10),this.joints.hasOwnProperty(t)?this.joints[t]:null},gdjs.Physics2SharedData.prototype.getJointId=function(t){for(var e in this.joints)if(this.joints.hasOwnProperty(e)&&this.joints[e]===t)return parseInt(e,10);return 0},gdjs.Physics2SharedData.prototype.removeJoint=function(t){if(t=t.toString(10),this.joints.hasOwnProperty(t)){var e=this.joints[t];if(e.GetType()===Box2D.e_revoluteJoint||e.GetType()===Box2D.e_prismaticJoint)for(var i in this.joints)this.joints.hasOwnProperty(i)&&(this.joints[i].GetType()!==Box2D.e_gearJoint||Box2D.getPointer(this.joints[i].GetJoint1())!==Box2D.getPointer(e)&&Box2D.getPointer(this.joints[i].GetJoint2())!==Box2D.getPointer(e)||this.removeJoint(parseInt(i,10)));this.world.DestroyJoint(e),delete this.joints[t]}},gdjs.Physics2RuntimeBehavior=function(t,e,i){gdjs.RuntimeBehavior.call(this,t,e,i),this.bodyType=e.bodyType,this.bullet=e.bullet,this.fixedRotation=e.fixedRotation,this.canSleep=e.canSleep,this.shape=e.shape,this.shapeDimensionA=e.shapeDimensionA,this.shapeDimensionB=e.shapeDimensionB,this.shapeOffsetX=e.shapeOffsetX,this.shapeOffsetY=e.shapeOffsetY,this.polygonOrigin=e.polygonOrigin,this.polygon="Polygon"===this.shape?gdjs.Physics2RuntimeBehavior.getPolygon(e.vertices):null,this.density=e.density,this.friction=e.friction,this.restitution=e.restitution,this.linearDamping=e.linearDamping,this.angularDamping=e.angularDamping,this.gravityScale=e.gravityScale,this.layers=e.layers,this.masks=e.masks,this.shapeScale=1,this.currentContacts=this.currentContacts||[],this.currentContacts.length=0,this._body=null,this._sharedData=gdjs.Physics2SharedData.getSharedData(t,e.name),this._tempb2Vec2=new Box2D.b2Vec2,this._tempb2Vec2Sec=new Box2D.b2Vec2,this._objectOldX=0,this._objectOldY=0,this._objectOldAngle=0,this._objectOldWidth=0,this._objectOldHeight=0,this._verticesBuffer=0},gdjs.Physics2RuntimeBehavior.prototype=Object.create(gdjs.RuntimeBehavior.prototype),gdjs.registerBehavior("Physics2::Physics2Behavior",gdjs.Physics2RuntimeBehavior),gdjs.Physics2RuntimeBehavior.prototype.b2Vec2=function(t,e){return this._tempb2Vec2.set_x(t),this._tempb2Vec2.set_y(e),this._tempb2Vec2},gdjs.Physics2RuntimeBehavior.prototype.b2Vec2Sec=function(t,e){return this._tempb2Vec2Sec.set_x(t),this._tempb2Vec2Sec.set_y(e),this._tempb2Vec2Sec},gdjs.Physics2RuntimeBehavior.prototype.updateFromBehaviorData=function(t,e){return t.bullet!==e.bullet&&this.setBullet(e.bullet),t.fixedRotation!==e.fixedRotation&&this.setFixedRotation(e.fixedRotation),t.canSleep!==e.canSleep&&this.setSleepingAllowed(e.canSleep),t.shapeDimensionA!==e.shapeDimensionA&&(this.shapeDimensionA=e.shapeDimensionA,this.recreateShape()),t.shapeDimensionB!==e.shapeDimensionB&&(this.shapeDimensionB=e.shapeDimensionB,this.recreateShape()),t.shapeOffsetX!==e.shapeOffsetX&&(this.shapeOffsetX=e.shapeOffsetX,this.recreateShape()),t.shapeOffsetY!==e.shapeOffsetY&&(this.shapeOffsetY=e.shapeOffsetY,this.recreateShape()),t.polygonOrigin!==e.polygonOrigin&&(this.polygonOrigin=e.polygonOrigin,this.recreateShape()),t.density!==e.density&&this.setDensity(e.density),t.friction!==e.friction&&this.setFriction(e.friction),t.restitution!==e.restitution&&this.setRestitution(e.restitution),t.linearDamping!==e.linearDamping&&this.setLinearDamping(e.linearDamping),t.angularDamping!==e.angularDamping&&this.setAngularDamping(e.angularDamping),t.gravityScale!==e.gravityScale&&this.setGravityScale(e.gravityScale),t.layers===e.layers&&(t.masks===e.masks&&(t.vertices===e.vertices&&(t.bodyType===e.bodyType&&t.shape===e.shape)))},gdjs.Physics2RuntimeBehavior.prototype.onDeActivate=function(){null!==this._body&&(this._sharedData.clearBodyJoints(this._body),this._verticesBuffer&&(Box2D._free(this._verticesBuffer),this._verticesBuffer=0),this._sharedData.world.DestroyBody(this._body),this._body=null)},gdjs.Physics2RuntimeBehavior.prototype.onDestroy=function(){this.onDeActivate()},gdjs.Physics2RuntimeBehavior.getPolygon=function(t){if(!t)return null;for(var e=new gdjs.Polygon,i=8,o=0,s=t.length;o<Math.min(s,8);o++)e.vertices.push([t[o].x,t[o].y]);return e},gdjs.Physics2RuntimeBehavior.isPolygonConvex=function(t){if(!t.isConvex())return!1;var e=!0,o=!0;for(i=0;i<t.vertices.length-1;++i){for(var s=i+1;s<t.vertices.length;++s)if(t.vertices[i][0]===t.vertices[s][0]&&t.vertices[i][1]===t.vertices[s][1])return!1;t.vertices[i][0]!==t.vertices[i+1][0]&&(e=!1),t.vertices[i][1]!==t.vertices[i+1][1]&&(o=!1)}return!e&&!o},gdjs.Physics2RuntimeBehavior.prototype.createShape=function(){var t=this.shapeOffsetX?this.shapeOffsetX*this.shapeScale*this._sharedData.invScaleX:0,e=this.shapeOffsetY?this.shapeOffsetY*this.shapeScale*this._sharedData.invScaleY:0,i;if("Circle"===this.shape){if(i=new Box2D.b2CircleShape,this.shapeDimensionA>0)i.set_m_radius(this.shapeDimensionA*this.shapeScale*this._sharedData.invScaleX);else{var o=(this.owner.getWidth()*this._sharedData.invScaleX+this.owner.getHeight()*this._sharedData.invScaleY)/4;i.set_m_radius(o>0?o:1)}i.set_m_p(this.b2Vec2(t,e))}else if("Polygon"===this.shape)if(i=new Box2D.b2PolygonShape,this.polygon&&gdjs.Physics2RuntimeBehavior.isPolygonConvex(this.polygon)){var s=0,a=0;if("Origin"===this.polygonOrigin?(s=(this.owner.getWidth()>0?-this.owner.getWidth()/2:0)+(this.owner.getX()-this.owner.getDrawableX()),a=(this.owner.getHeight()>0?-this.owner.getHeight()/2:0)+(this.owner.getY()-this.owner.getDrawableY())):"TopLeft"===this.polygonOrigin&&(s=this.owner.getWidth()>0?-this.owner.getWidth()/2:0,a=this.owner.getHeight()>0?-this.owner.getHeight()/2:0),!this._verticesBuffer){var n=Box2D._malloc(8*this.polygon.vertices.length,"float",Box2D.ALLOC_STACK);this._verticesBuffer=n}for(var r=0,h=0,c=this.polygon.vertices.length;h<c;h++)Box2D.HEAPF32[this._verticesBuffer+r>>2]=(this.polygon.vertices[h][0]*this.shapeScale+s)*this._sharedData.invScaleX+t,Box2D.HEAPF32[this._verticesBuffer+(r+4)>>2]=(this.polygon.vertices[h][1]*this.shapeScale+a)*this._sharedData.invScaleY+e,r+=8;var d=Box2D.wrapPointer(this._verticesBuffer,Box2D.b2Vec2);i.Set(d,this.polygon.vertices.length)}else{var l=(this.owner.getWidth()>0?this.owner.getWidth():1)*this._sharedData.invScaleX,y=(this.owner.getHeight()>0?this.owner.getHeight():1)*this._sharedData.invScaleY;i.SetAsBox(l/2,y/2,this.b2Vec2(t,e),0)}else if("Edge"===this.shape){i=new Box2D.b2EdgeShape;var u=(this.shapeDimensionA>0?this.shapeDimensionA*this.shapeScale:this.owner.getWidth()>0?this.owner.getWidth():1)*this._sharedData.invScaleX,y=this.owner.getHeight()>0?this.owner.getHeight()*this._sharedData.invScaleY:0,g=this.shapeDimensionB?gdjs.toRad(this.shapeDimensionB):0;i.Set(this.b2Vec2(-u/2*Math.cos(g)+t,y/2-u/2*Math.sin(g)+e),this.b2Vec2Sec(u/2*Math.cos(g)+t,y/2+u/2*Math.sin(g)+e))}else{i=new Box2D.b2PolygonShape;var l=(this.shapeDimensionA>0?this.shapeDimensionA*this.shapeScale:this.owner.getWidth()>0?this.owner.getWidth():1)*this._sharedData.invScaleX,y=(this.shapeDimensionB>0?this.shapeDimensionB*this.shapeScale:this.owner.getHeight()>0?this.owner.getHeight():1)*this._sharedData.invScaleY;i.SetAsBox(l/2,y/2,this.b2Vec2(t,e),0)}var p=new Box2D.b2Filter;p.set_categoryBits(this.layers),p.set_maskBits(this.masks);var _=new Box2D.b2FixtureDef;return _.set_shape(i),_.set_filter(p),this.density<0&&(this.density=0),_.set_density(this.density),this.friction<0&&(this.friction=0),_.set_friction(this.friction),this.restitution<0&&(this.restitution=0),_.set_restitution(this.restitution),_},gdjs.Physics2RuntimeBehavior.prototype.recreateShape=function(){if(null===this._body)return void this.createBody();this._body.DestroyFixture(this._body.GetFixtureList()),this._body.CreateFixture(this.createShape()),this._objectOldWidth=this.owner.getWidth(),this._objectOldHeight=this.owner.getHeight()},gdjs.Physics2RuntimeBehavior.prototype.getShapeScale=function(){return this.shapeScale},gdjs.Physics2RuntimeBehavior.prototype.setShapeScale=function(t){t!==this.shapeScale&&t>0&&(this.shapeScale=t,this.recreateShape())},gdjs.Physics2RuntimeBehavior.prototype.getBody=function(){return null===this._body&&this.createBody(),this._body},gdjs.Physics2RuntimeBehavior.prototype.createBody=function(){var t=new Box2D.b2BodyDef;t.set_position(this.b2Vec2((this.owner.getDrawableX()+this.owner.getWidth()/2)*this._sharedData.invScaleX,(this.owner.getDrawableY()+this.owner.getHeight()/2)*this._sharedData.invScaleY)),t.set_angle(gdjs.toRad(this.owner.getAngle())),t.set_type("Static"===this.bodyType?Box2D.b2_staticBody:"Kinematic"===this.bodyType?Box2D.b2_kinematicBody:Box2D.b2_dynamicBody),t.set_bullet(this.bullet),t.set_fixedRotation(this.fixedRotation),t.set_allowSleep(this.canSleep),t.set_linearDamping(this.linearDamping),t.set_angularDamping(this.angularDamping),t.set_gravityScale(this.gravityScale),this._body=this._sharedData.world.CreateBody(t),this._body.CreateFixture(this.createShape()),this._body.gdjsAssociatedBehavior=this,this._objectOldWidth=this.owner.getWidth(),this._objectOldHeight=this.owner.getHeight()},gdjs.Physics2RuntimeBehavior.prototype.doStepPreEvents=function(t){null===this._body&&this.createBody(),this._sharedData.stepped||this._sharedData.step(t.getTimeManager().getElapsedTime()/1e3),this.owner.setX(this._body.GetPosition().get_x()*this._sharedData.scaleX-this.owner.getWidth()/2+this.owner.getX()-this.owner.getDrawableX()),this.owner.setY(this._body.GetPosition().get_y()*this._sharedData.scaleY-this.owner.getHeight()/2+this.owner.getY()-this.owner.getDrawableY()),this.owner.setAngle(gdjs.toDegrees(this._body.GetAngle())),this._objectOldX=this.owner.getX(),this._objectOldY=this.owner.getY(),this._objectOldAngle=this.owner.getAngle()},gdjs.Physics2RuntimeBehavior.prototype.doStepPostEvents=function(t){this._updateBodyFromObject(),this._sharedData.stepped=!1},gdjs.Physics2RuntimeBehavior.prototype.onObjectHotReloaded=function(){this._updateBodyFromObject()},gdjs.Physics2RuntimeBehavior.prototype._updateBodyFromObject=function(){if(null===this._body&&this.createBody(),!(this._objectOldWidth!==this.owner.getWidth()&&this.shapeDimensionA<=0)&&(this._objectOldHeight===this.owner.getHeight()||"Edge"===this.shape||"Box"===this.shape&&this.shapeDimensionB>0||"Circle"===this.shape&&this.shapeDimensionA>0)||this.recreateShape(),this._objectOldX!==this.owner.getX()||this._objectOldY!==this.owner.getY()||this._objectOldAngle!==this.owner.getAngle()){var t=this.b2Vec2((this.owner.getDrawableX()+this.owner.getWidth()/2)*this._sharedData.invScaleX,(this.owner.getDrawableY()+this.owner.getHeight()/2)*this._sharedData.invScaleY);this._body.SetTransform(t,gdjs.toRad(this.owner.getAngle())),this._body.SetAwake(!0)}},gdjs.Physics2RuntimeBehavior.prototype.getGravityX=function(){return this._sharedData.gravityX},gdjs.Physics2RuntimeBehavior.prototype.getGravityY=function(){return this._sharedData.gravityY},gdjs.Physics2RuntimeBehavior.prototype.setGravity=function(t,e){this._sharedData.gravityX===t&&this._sharedData.gravityY===e||(this._sharedData.gravityX=t,this._sharedData.gravityY=e,this._sharedData.world.SetGravity(this.b2Vec2(this._sharedData.gravityX,this._sharedData.gravityY)))},gdjs.Physics2RuntimeBehavior.prototype.getTimeScale=function(){return this._sharedData.timeScale},gdjs.Physics2RuntimeBehavior.prototype.setTimeScale=function(t){t<0||(this._sharedData.timeScale=t)},gdjs.Physics2RuntimeBehavior.setTimeScaleFromObject=function(t,e,i){null!==t&&t.hasBehavior(e)&&t.getBehavior(e).setTimeScale(i)},gdjs.Physics2RuntimeBehavior.prototype.isDynamic=function(){return"Dynamic"===this.bodyType},gdjs.Physics2RuntimeBehavior.prototype.setDynamic=function(){if("Dynamic"!==this.bodyType){if(this.bodyType="Dynamic",null===this._body)return void this.createBody();this._body.SetType(Box2D.b2_dynamicBody),this._body.SetAwake(!0)}},gdjs.Physics2RuntimeBehavior.prototype.isStatic=function(){return"Static"===this.bodyType},gdjs.Physics2RuntimeBehavior.prototype.setStatic=function(){if("Static"!==this.bodyType){if(this.bodyType="Static",null===this._body)return void this.createBody();this._body.SetType(Box2D.b2_staticBody),this._body.SetAwake(!0)}},gdjs.Physics2RuntimeBehavior.prototype.isKinematic=function(){return"Kinematic"===this.bodyType},gdjs.Physics2RuntimeBehavior.prototype.setKinematic=function(){if("Kinematic"!==this.bodyType){if(this.bodyType="Kinematic",null===this._body)return void this.createBody();this._body.SetType(Box2D.b2_kinematicBody),this._body.SetAwake(!0)}},gdjs.Physics2RuntimeBehavior.prototype.isBullet=function(){return this.bullet},gdjs.Physics2RuntimeBehavior.prototype.setBullet=function(t){if(this.bullet!==t){if(this.bullet=t,null===this._body)return void this.createBody();this._body.SetBullet(this.bullet)}},gdjs.Physics2RuntimeBehavior.prototype.hasFixedRotation=function(){return this.fixedRotation},gdjs.Physics2RuntimeBehavior.prototype.setFixedRotation=function(t){if(this.fixedRotation=t,null===this._body)return void this.createBody();this._body.SetFixedRotation(this.fixedRotation)},gdjs.Physics2RuntimeBehavior.prototype.isSleepingAllowed=function(){return this.canSleep},gdjs.Physics2RuntimeBehavior.prototype.setSleepingAllowed=function(t){if(this.canSleep=t,null===this._body)return void this.createBody();this._body.SetSleepingAllowed(this.canSleep)},gdjs.Physics2RuntimeBehavior.prototype.isSleeping=function(){return null===this._body&&this.createBody(),!this._body.IsAwake()},gdjs.Physics2RuntimeBehavior.prototype.getDensity=function(){return this.density},gdjs.Physics2RuntimeBehavior.prototype.setDensity=function(t){if(t<0&&(t=0),this.density!==t){if(this.density=t,null===this._body)return void this.createBody();this._body.GetFixtureList().SetDensity(this.density),this._body.ResetMassData()}},gdjs.Physics2RuntimeBehavior.prototype.getFriction=function(){return this.friction},gdjs.Physics2RuntimeBehavior.prototype.setFriction=function(t){if(t<0&&(t=0),this.friction!==t){if(this.friction=t,null===this._body)return void this.createBody();this._body.GetFixtureList().SetFriction(this.friction);for(var e=this._body.GetContactList();Box2D.getPointer(e);)e.get_contact().ResetFriction(),e=e.get_next()}},gdjs.Physics2RuntimeBehavior.prototype.getRestitution=function(){return this.restitution},gdjs.Physics2RuntimeBehavior.prototype.setRestitution=function(t){if(t<0&&(t=0),this.restitution!==t){if(this.restitution=t,null===this._body)return void this.createBody();this._body.GetFixtureList().SetRestitution(this.restitution);for(var e=this._body.GetContactList();Box2D.getPointer(e);)e.get_contact().ResetRestitution(),e=e.get_next()}},gdjs.Physics2RuntimeBehavior.prototype.getLinearDamping=function(){return this.linearDamping},gdjs.Physics2RuntimeBehavior.prototype.setLinearDamping=function(t){if(this.linearDamping!==t){if(this.linearDamping=t,null===this._body)return void this.createBody();this._body.SetLinearDamping(this.linearDamping)}},gdjs.Physics2RuntimeBehavior.prototype.getAngularDamping=function(){return this.angularDamping},gdjs.Physics2RuntimeBehavior.prototype.setAngularDamping=function(t){if(this.angularDamping!==t){if(this.angularDamping=t,null===this._body)return void this.createBody();this._body.SetAngularDamping(this.angularDamping)}},gdjs.Physics2RuntimeBehavior.prototype.getGravityScale=function(){return this.gravityScale},gdjs.Physics2RuntimeBehavior.prototype.setGravityScale=function(t){if(this.gravityScale!==t){if(this.gravityScale=t,null===this._body)return void this.createBody();this._body.SetGravityScale(this.gravityScale)}},gdjs.Physics2RuntimeBehavior.prototype.layerEnabled=function(t){return!((t=Math.floor(t))<1||t>16)&&!!(this.layers&1<<t-1)},gdjs.Physics2RuntimeBehavior.prototype.enableLayer=function(t,e){if(!((t=Math.floor(t))<1||t>16)){if(e?this.layers|=1<<t-1:this.layers&=~(1<<t-1),null===this._body)return void this.createBody();var i=this._body.GetFixtureList().GetFilterData();i.set_categoryBits(this.layers),this._body.GetFixtureList().SetFilterData(i)}},gdjs.Physics2RuntimeBehavior.prototype.maskEnabled=function(t){return!((t=Math.floor(t))<1||t>16)&&!!(this.masks&1<<t-1)},gdjs.Physics2RuntimeBehavior.prototype.enableMask=function(t,e){if(!((t=Math.floor(t))<1||t>16)){if(e?this.masks|=1<<t-1:this.masks&=~(1<<t-1),null===this._body)return void this.createBody();var i=this._body.GetFixtureList().GetFilterData();i.set_maskBits(this.masks),this._body.GetFixtureList().SetFilterData(i)}},gdjs.Physics2RuntimeBehavior.prototype.getLinearVelocityX=function(){return null===this._body?(this.createBody(),0):this._body.GetLinearVelocity().get_x()*this._sharedData.scaleX},gdjs.Physics2RuntimeBehavior.prototype.setLinearVelocityX=function(t){null===this._body&&this.createBody(),this._body.SetLinearVelocity(this.b2Vec2(t*this._sharedData.invScaleX,this._body.GetLinearVelocity().get_y()))},gdjs.Physics2RuntimeBehavior.prototype.getLinearVelocityY=function(){return null===this._body?(this.createBody(),0):this._body.GetLinearVelocity().get_y()*this._sharedData.scaleY},gdjs.Physics2RuntimeBehavior.prototype.setLinearVelocityY=function(t){null===this._body&&this.createBody(),this._body.SetLinearVelocity(this.b2Vec2(this._body.GetLinearVelocity().get_x(),t*this._sharedData.invScaleY))},gdjs.Physics2RuntimeBehavior.prototype.getLinearVelocityLength=function(){return null===this._body?(this.createBody(),0):this.b2Vec2(this._body.GetLinearVelocity().get_x()*this._sharedData.scaleX,this._body.GetLinearVelocity().get_y()*this._sharedData.scaleY).Length()},gdjs.Physics2RuntimeBehavior.prototype.getAngularVelocity=function(){return null===this._body&&this.createBody(),gdjs.toDegrees(this._body.GetAngularVelocity())},gdjs.Physics2RuntimeBehavior.prototype.setAngularVelocity=function(t){null===this._body&&this.createBody(),this._body.SetAngularVelocity(gdjs.toRad(t))},gdjs.Physics2RuntimeBehavior.prototype.applyForce=function(t,e,i,o){null===this._body&&this.createBody(),this._body.SetAwake(!0),this._body.ApplyForce(this.b2Vec2(t,e),this.b2Vec2Sec(i*this._sharedData.invScaleX,o*this._sharedData.invScaleY))},gdjs.Physics2RuntimeBehavior.prototype.applyPolarForce=function(t,e,i,o){null===this._body&&this.createBody(),this._body.SetAwake(!0),t=gdjs.toRad(t),this._body.ApplyForce(this.b2Vec2(e*Math.cos(t),e*Math.sin(t)),this.b2Vec2Sec(i*this._sharedData.invScaleX,o*this._sharedData.invScaleY))},gdjs.Physics2RuntimeBehavior.prototype.applyForceTowardPosition=function(t,e,i,o,s){null===this._body&&this.createBody(),this._body.SetAwake(!0);var a=Math.atan2(i*this._sharedData.invScaleY-this._body.GetPosition().get_y(),e*this._sharedData.invScaleX-this._body.GetPosition().get_x());this._body.ApplyForce(this.b2Vec2(t*Math.cos(a),t*Math.sin(a)),this.b2Vec2Sec(o*this._sharedData.invScaleX,s*this._sharedData.invScaleY))},gdjs.Physics2RuntimeBehavior.prototype.applyImpulse=function(t,e,i,o){null===this._body&&this.createBody(),this._body.SetAwake(!0),this._body.ApplyLinearImpulse(this.b2Vec2(t,e),this.b2Vec2Sec(i*this._sharedData.invScaleX,o*this._sharedData.invScaleY))},gdjs.Physics2RuntimeBehavior.prototype.applyPolarImpulse=function(t,e,i,o){null===this._body&&his.createBody(),this._body.SetAwake(!0),t=gdjs.toRad(t),this._body.ApplyLinearImpulse(this.b2Vec2(e*Math.cos(t),e*Math.sin(t)),this.b2Vec2Sec(i*this._sharedData.invScaleX,o*this._sharedData.invScaleY))},gdjs.Physics2RuntimeBehavior.prototype.applyImpulseTowardPosition=function(t,e,i,o,s){null===this._body&&this.createBody(),this._body.SetAwake(!0);var a=Math.atan2(i*this._sharedData.invScaleY-this._body.GetPosition().get_y(),e*this._sharedData.invScaleX-this._body.GetPosition().get_x());this._body.ApplyLinearImpulse(this.b2Vec2(t*Math.cos(a),t*Math.sin(a)),this.b2Vec2Sec(o*this._sharedData.invScaleX,s*this._sharedData.invScaleY))},gdjs.Physics2RuntimeBehavior.prototype.applyTorque=function(t){null===this._body&&this.createBody(),this._body.SetAwake(!0),this._body.ApplyTorque(t)},gdjs.Physics2RuntimeBehavior.prototype.applyAngularImpulse=function(t){null===this._body&&this.createBody(),this._body.SetAwake(!0),this._body.ApplyAngularImpulse(t)},gdjs.Physics2RuntimeBehavior.prototype.getMassCenterX=function(){return null===this._body&&this.createBody(),this._body.GetWorldCenter().get_x()*this._sharedData.scaleX},gdjs.Physics2RuntimeBehavior.prototype.getMassCenterY=function(){return null===this._body&&this.createBody(),this._body.GetWorldCenter().get_y()*this._sharedData.scaleY},gdjs.Physics2RuntimeBehavior.prototype.isJointFirstObject=function(t){if(null===this._body)return this.createBody(),!1;var e=this._sharedData.getJoint(t);return null!==e&&e.GetBodyA()===this._body},gdjs.Physics2RuntimeBehavior.prototype.isJointSecondObject=function(t){if(null===this._body)return this.createBody(),!1;var e=this._sharedData.getJoint(t);return null!==e&&e.GetBodyB()===this._body},gdjs.Physics2RuntimeBehavior.prototype.getJointFirstAnchorX=function(t){var e=this._sharedData.getJoint(t);return null===e?0:e.GetBodyA().GetWorldPoint(e.GetLocalAnchorA()).get_x()},gdjs.Physics2RuntimeBehavior.prototype.getJointFirstAnchorY=function(t){var e=this._sharedData.getJoint(t);return null===e?0:e.GetBodyA().GetWorldPoint(e.GetLocalAnchorA()).get_y()},gdjs.Physics2RuntimeBehavior.prototype.getJointSecondAnchorX=function(t){var e=this._sharedData.getJoint(t);return null===e?0:e.GetBodyB().GetWorldPoint(e.GetLocalAnchorB()).get_x()},gdjs.Physics2RuntimeBehavior.prototype.getJointSecondAnchorY=function(t){var e=this._sharedData.getJoint(t);return null===e?0:e.GetBodyB().GetWorldPoint(e.GetLocalAnchorB()).get_y()},gdjs.Physics2RuntimeBehavior.prototype.getJointReactionForce=function(t){var e=this._sharedData.getJoint(t);return null===e?0:e.GetReactionForce(1/this._sharedData.timeStep).Length()},gdjs.Physics2RuntimeBehavior.prototype.getJointReactionTorque=function(t){var e=this._sharedData.getJoint(t);return null===e?0:e.GetReactionTorque(1/this._sharedData.timeStep)},gdjs.Physics2RuntimeBehavior.prototype.removeJoint=function(t){this._sharedData.removeJoint(t)},gdjs.Physics2RuntimeBehavior.prototype.addDistanceJoint=function(t,e,i,o,s,a,n,r,h,c){if(null===this._body&&this.createBody(),null!=i&&i.hasBehavior(this.name)){var d=i.getBehavior(this.name).getBody();if(this._body!==d){var l=new Box2D.b2DistanceJointDef;l.set_bodyA(this._body),l.set_localAnchorA(this._body.GetLocalPoint(this.b2Vec2(t*this._sharedData.invScaleX,e*this._sharedData.invScaleY))),l.set_bodyB(d),l.set_localAnchorB(d.GetLocalPoint(this.b2Vec2(o*this._sharedData.invScaleX,s*this._sharedData.invScaleY))),l.set_length(a>0?a*this._sharedData.invScaleX:this.b2Vec2((o-t)*this._sharedData.invScaleX,(s-e)*this._sharedData.invScaleY).Length()),l.set_frequencyHz(n>=0?n:0),l.set_dampingRatio(r>=0?r:1),l.set_collideConnected(h);var y=this._sharedData.addJoint(Box2D.castObject(this._sharedData.world.CreateJoint(l),Box2D.b2DistanceJoint));c.setNumber(y)}}},gdjs.Physics2RuntimeBehavior.prototype.getDistanceJointLength=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_distanceJoint?0:e.GetLength()*this._sharedData.scaleX},gdjs.Physics2RuntimeBehavior.prototype.setDistanceJointLength=function(t,e){if(!(e<=0)){var i=this._sharedData.getJoint(t);null!==i&&i.GetType()===Box2D.e_distanceJoint&&(i.SetLength(e*this._sharedData.invScaleX),i.GetBodyA().SetAwake(!0),i.GetBodyB().SetAwake(!0))}},gdjs.Physics2RuntimeBehavior.prototype.getDistanceJointFrequency=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_distanceJoint?0:e.GetFrequency()},gdjs.Physics2RuntimeBehavior.prototype.setDistanceJointFrequency=function(t,e){if(!(e<0)){var i=this._sharedData.getJoint(t);null!==i&&i.GetType()===Box2D.e_distanceJoint&&i.SetFrequency(e)}},gdjs.Physics2RuntimeBehavior.prototype.getDistanceJointDampingRatio=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_distanceJoint?0:e.GetDampingRatio()},gdjs.Physics2RuntimeBehavior.prototype.setDistanceJointDampingRatio=function(t,e){if(!(e<0)){var i=this._sharedData.getJoint(t);null===i||(i.GetType(),Box2D.e_distanceJoint),i.SetDampingRatio(e)}},gdjs.Physics2RuntimeBehavior.prototype.addRevoluteJoint=function(t,e,i,o,s,a,n,r,h,c){null===this._body&&this.createBody();var d=new Box2D.b2RevoluteJointDef;if(d.set_bodyA(this._sharedData.staticBody),d.set_localAnchorA(this._sharedData.staticBody.GetLocalPoint(this.b2Vec2(t*this._sharedData.invScaleX,e*this._sharedData.invScaleY))),d.set_bodyB(this._body),d.set_localAnchorB(this._body.GetLocalPoint(this.b2Vec2(t*this._sharedData.invScaleX,e*this._sharedData.invScaleY))),d.set_enableLimit(i),d.set_referenceAngle(gdjs.toRad(o)),a<s){var l=s;s=a,a=l}d.set_lowerAngle(gdjs.toRad(s)),d.set_upperAngle(gdjs.toRad(a)),d.set_enableMotor(n),d.set_motorSpeed(gdjs.toRad(r)),d.set_maxMotorTorque(h>=0?h:0),d.set_collideConnected(!1);var y=this._sharedData.addJoint(Box2D.castObject(this._sharedData.world.CreateJoint(d),Box2D.b2RevoluteJoint));c.setNumber(y)},gdjs.Physics2RuntimeBehavior.prototype.addRevoluteJointBetweenTwoBodies=function(t,e,i,o,s,a,n,r,h,c,d,l,y,u){if(null===this._body&&this.createBody(),null!=i&&i.hasBehavior(this.name)){var g=i.getBehavior(this.name).getBody();if(this._body!==g){var p=new Box2D.b2RevoluteJointDef;if(p.set_bodyA(this._body),p.set_localAnchorA(this._body.GetLocalPoint(this.b2Vec2(t*this._sharedData.invScaleX,e*this._sharedData.invScaleY))),p.set_bodyB(g),p.set_localAnchorB(g.GetLocalPoint(this.b2Vec2(o*this._sharedData.invScaleX,s*this._sharedData.invScaleY))),p.set_enableLimit(a),p.set_referenceAngle(gdjs.toRad(n)),h<r){var _=r;r=h,h=_}p.set_lowerAngle(gdjs.toRad(r)),p.set_upperAngle(gdjs.toRad(h)),p.set_enableMotor(c),p.set_motorSpeed(gdjs.toRad(d)),p.set_maxMotorTorque(l>=0?l:0),p.set_collideConnected(y);var v=this._sharedData.addJoint(Box2D.castObject(this._sharedData.world.CreateJoint(p),Box2D.b2RevoluteJoint));u.setNumber(v)}}},gdjs.Physics2RuntimeBehavior.prototype.getRevoluteJointReferenceAngle=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_revoluteJoint?0:gdjs.toDegrees(e.GetReferenceAngle())},gdjs.Physics2RuntimeBehavior.prototype.getRevoluteJointAngle=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_revoluteJoint?0:gdjs.toDegrees(e.GetJointAngle())},gdjs.Physics2RuntimeBehavior.prototype.getRevoluteJointSpeed=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_revoluteJoint?0:gdjs.toDegrees(e.GetJointSpeed())},gdjs.Physics2RuntimeBehavior.prototype.isRevoluteJointLimitsEnabled=function(t){var e=this._sharedData.getJoint(t);return null!==e&&e.GetType()===Box2D.e_revoluteJoint&&e.IsLimitEnabled()},gdjs.Physics2RuntimeBehavior.prototype.enableRevoluteJointLimits=function(t,e){var i=this._sharedData.getJoint(t);null!==i&&i.GetType()===Box2D.e_revoluteJoint&&i.EnableLimit(e)},gdjs.Physics2RuntimeBehavior.prototype.getRevoluteJointMinAngle=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_revoluteJoint?0:gdjs.toDegrees(e.GetLowerLimit())},gdjs.Physics2RuntimeBehavior.prototype.getRevoluteJointMaxAngle=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_revoluteJoint?0:gdjs.toDegrees(e.GetUpperLimit())},gdjs.Physics2RuntimeBehavior.prototype.setRevoluteJointLimits=function(t,e,i){var o=this._sharedData.getJoint(t);if(null!==o&&o.GetType()===Box2D.e_revoluteJoint){if(i<e){var s=e;e=i,i=s}o.SetLimits(gdjs.toRad(e),gdjs.toRad(i))}},gdjs.Physics2RuntimeBehavior.prototype.isRevoluteJointMotorEnabled=function(t){var e=this._sharedData.getJoint(t);return null!==e&&e.GetType()===Box2D.e_revoluteJoint&&e.IsMotorEnabled()},gdjs.Physics2RuntimeBehavior.prototype.enableRevoluteJointMotor=function(t,e){var i=this._sharedData.getJoint(t);null!==i&&i.GetType()===Box2D.e_revoluteJoint&&i.EnableMotor(e)},gdjs.Physics2RuntimeBehavior.prototype.getRevoluteJointMotorSpeed=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_revoluteJoint?0:gdjs.toDegrees(e.GetMotorSpeed())},gdjs.Physics2RuntimeBehavior.prototype.setRevoluteJointMotorSpeed=function(t,e){var i=this._sharedData.getJoint(t);null!==i&&i.GetType()===Box2D.e_revoluteJoint&&i.SetMotorSpeed(gdjs.toRad(e))},gdjs.Physics2RuntimeBehavior.prototype.getRevoluteJointMaxMotorTorque=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_revoluteJoint?0:e.GetMaxMotorTorque()},gdjs.Physics2RuntimeBehavior.prototype.setRevoluteJointMaxMotorTorque=function(t,e){if(!(e<0)){var i=this._sharedData.getJoint(t);null!==i&&i.GetType()===Box2D.e_revoluteJoint&&i.SetMaxMotorTorque(e)}},gdjs.Physics2RuntimeBehavior.prototype.getRevoluteJointMotorTorque=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_revoluteJoint?0:e.GetMotorTorque(1/this._sharedData.timeStep)},gdjs.Physics2RuntimeBehavior.prototype.addPrismaticJoint=function(t,e,i,o,s,a,n,r,h,c,d,l,y,u,g){if(null===this._body&&this.createBody(),null!=i&&i.hasBehavior(this.name)){var p=i.getBehavior(this.name).getBody();if(this._body!==p){var _=new Box2D.b2PrismaticJointDef;if(_.set_bodyA(this._body),_.set_localAnchorA(this._body.GetLocalPoint(this.b2Vec2(t*this._sharedData.invScaleX,e*this._sharedData.invScaleY))),_.set_bodyB(p),_.set_localAnchorB(p.GetLocalPoint(this.b2Vec2(o*this._sharedData.invScaleX,s*this._sharedData.invScaleY))),a=gdjs.toRad(a)-this._body.GetAngle(),_.set_localAxisA(this.b2Vec2(Math.cos(a),Math.sin(a))),_.set_referenceAngle(gdjs.toRad(n)),_.set_enableLimit(r),c<h){var v=h;h=c,c=v}_.set_lowerTranslation(h<0?h*this._sharedData.invScaleX:0),_.set_upperTranslation(c>0?c*this._sharedData.invScaleX:0),
_.set_enableMotor(d),_.set_motorSpeed(l*this._sharedData.invScaleX),_.set_maxMotorForce(y),_.set_collideConnected(u);var D=this._sharedData.addJoint(Box2D.castObject(this._sharedData.world.CreateJoint(_),Box2D.b2PrismaticJoint));g.setNumber(D)}}},gdjs.Physics2RuntimeBehavior.prototype.getPrismaticJointAxisAngle=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_prismaticJoint?0:gdjs.toDegrees(Math.atan2(e.GetLocalAxisA().get_y(),e.GetLocalAxisA().get_x())+e.GetBodyA().GetAngle())},gdjs.Physics2RuntimeBehavior.prototype.getPrismaticJointReferenceAngle=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_prismaticJoint?0:gdjs.toDegrees(e.GetReferenceAngle())},gdjs.Physics2RuntimeBehavior.prototype.getPrismaticJointTranslation=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_prismaticJoint?0:e.GetJointTranslation()*this._sharedData.scaleX},gdjs.Physics2RuntimeBehavior.prototype.getPrismaticJointSpeed=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_prismaticJoint?0:e.GetJointSpeed()*this._sharedData.scaleX},gdjs.Physics2RuntimeBehavior.prototype.isPrismaticJointLimitsEnabled=function(t){var e=this._sharedData.getJoint(t);return null!==e&&e.GetType()===Box2D.e_prismaticJoint&&e.IsLimitEnabled()},gdjs.Physics2RuntimeBehavior.prototype.enablePrismaticJointLimits=function(t,e){var i=this._sharedData.getJoint(t);null!==i&&i.GetType()===Box2D.e_prismaticJoint&&i.EnableLimit(e)},gdjs.Physics2RuntimeBehavior.prototype.getPrismaticJointMinTranslation=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_prismaticJoint?0:e.GetLowerLimit()*this._sharedData.scaleX},gdjs.Physics2RuntimeBehavior.prototype.getPrismaticJointMaxTranslation=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_prismaticJoint?0:e.GetUpperLimit()*this._sharedData.scaleX},gdjs.Physics2RuntimeBehavior.prototype.setPrismaticJointLimits=function(t,e,i){var o=this._sharedData.getJoint(t);if(null!==o&&o.GetType()===Box2D.e_prismaticJoint){if(i<e){var s=e;e=i,i=s}e=e<0?e:0,i=i>0?i:0,o.SetLimits(e*this._sharedData.invScaleX,i*this._sharedData.invScaleX)}},gdjs.Physics2RuntimeBehavior.prototype.isPrismaticJointMotorEnabled=function(t){var e=this._sharedData.getJoint(t);return null!==e&&e.GetType()===Box2D.e_prismaticJoint&&e.IsMotorEnabled()},gdjs.Physics2RuntimeBehavior.prototype.enablePrismaticJointMotor=function(t,e){var i=this._sharedData.getJoint(t);null!==i&&i.GetType()===Box2D.e_prismaticJoint&&i.EnableMotor(e)},gdjs.Physics2RuntimeBehavior.prototype.getPrismaticJointMotorSpeed=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_prismaticJoint?0:e.GetMotorSpeed()*this._sharedData.scaleX},gdjs.Physics2RuntimeBehavior.prototype.setPrismaticJointMotorSpeed=function(t,e){var i=this._sharedData.getJoint(t);null!==i&&i.GetType()===Box2D.e_prismaticJoint&&i.SetMotorSpeed(e*this._sharedData.invScaleX)},gdjs.Physics2RuntimeBehavior.prototype.getPrismaticJointMaxMotorForce=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_prismaticJoint?0:e.GetMaxMotorForce()},gdjs.Physics2RuntimeBehavior.prototype.setPrismaticJointMaxMotorForce=function(t,e){if(!(e<0)){var i=this._sharedData.getJoint(t);null!==i&&i.GetType()===Box2D.e_prismaticJoint&&i.SetMaxMotorForce(e)}},gdjs.Physics2RuntimeBehavior.prototype.getPrismaticJointMotorForce=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_prismaticJoint?0:e.GetMotorForce(1/this._sharedData.timeStep)},gdjs.Physics2RuntimeBehavior.prototype.addPulleyJoint=function(t,e,i,o,s,a,n,r,h,c,d,l,y,u){if(null===this._body&&this.createBody(),null!=i&&i.hasBehavior(this.name)){var g=i.getBehavior(this.name).getBody();if(this._body!==g){var p=new Box2D.b2PulleyJointDef;p.set_bodyA(this._body),p.set_localAnchorA(this._body.GetLocalPoint(this.b2Vec2(t*this._sharedData.invScaleX,e*this._sharedData.invScaleY))),p.set_bodyB(g),p.set_localAnchorB(g.GetLocalPoint(this.b2Vec2(o*this._sharedData.invScaleX,s*this._sharedData.invScaleY))),p.set_groundAnchorA(this.b2Vec2(a*this._sharedData.invScaleX,n*this._sharedData.invScaleY)),p.set_groundAnchorB(this.b2Vec2(r*this._sharedData.invScaleX,h*this._sharedData.invScaleY)),p.set_lengthA(c>0?c*this._sharedData.invScaleX:this.b2Vec2((a-t)*this._sharedData.invScaleX,(n-e)*this._sharedData.invScaleY).Length()),p.set_lengthB(d>0?d*this._sharedData.invScaleX:this.b2Vec2((r-o)*this._sharedData.invScaleX,(h-s)*this._sharedData.invScaleY).Length()),p.set_ratio(l>0?l:1),p.set_collideConnected(y);var _=this._sharedData.addJoint(Box2D.castObject(this._sharedData.world.CreateJoint(p),Box2D.b2PulleyJoint));u.setNumber(_)}}},gdjs.Physics2RuntimeBehavior.prototype.getPulleyJointFirstGroundAnchorX=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_pulleyJoint?0:e.GetGroundAnchorA().get_x()*this._sharedData.scaleX},gdjs.Physics2RuntimeBehavior.prototype.getPulleyJointFirstGroundAnchorY=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_pulleyJoint?0:e.GetGroundAnchorA().get_y()*this._sharedData.scaleY},gdjs.Physics2RuntimeBehavior.prototype.getPulleyJointSecondGroundAnchorX=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_pulleyJoint?0:e.GetGroundAnchorB().get_x()*this._sharedData.scaleX},gdjs.Physics2RuntimeBehavior.prototype.getPulleyJointSecondGroundAnchorY=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_pulleyJoint?0:e.GetGroundAnchorB().get_y()*this._sharedData.scaleY},gdjs.Physics2RuntimeBehavior.prototype.getPulleyJointFirstLength=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_pulleyJoint?0:e.GetCurrentLengthA()*this._sharedData.scaleX},gdjs.Physics2RuntimeBehavior.prototype.getPulleyJointSecondLength=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_pulleyJoint?0:e.GetCurrentLengthB()*this._sharedData.scaleX},gdjs.Physics2RuntimeBehavior.prototype.getPulleyJointRatio=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_pulleyJoint?0:e.GetRatio()},gdjs.Physics2RuntimeBehavior.prototype.addGearJoint=function(t,e,i,o,s){null===this._body&&this.createBody();var a=this._sharedData.getJoint(t);if(null!==a&&(a.GetType()===Box2D.e_revoluteJoint||a.GetType()===Box2D.e_prismaticJoint)){var n=this._sharedData.getJoint(e);if(null!==n&&(n.GetType()===Box2D.e_revoluteJoint||n.GetType()===Box2D.e_prismaticJoint)&&a!==n){var r=new Box2D.b2GearJointDef;r.set_bodyA(this._sharedData.staticBody),r.set_bodyB(this._body),r.set_joint1(a),r.set_joint2(n),r.set_ratio(i),r.set_collideConnected(o);var h=this._sharedData.addJoint(Box2D.castObject(this._sharedData.world.CreateJoint(r),Box2D.b2GearJoint));s.setNumber(h)}}},gdjs.Physics2RuntimeBehavior.prototype.getGearJointFirstJoint=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_gearJoint?0:this._sharedData.getJointId(e.GetJoint1())},gdjs.Physics2RuntimeBehavior.prototype.getGearJointSecondJoint=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_gearJoint?0:this._sharedData.getJointId(e.GetJoint2())},gdjs.Physics2RuntimeBehavior.prototype.getGearJointRatio=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_gearJoint?0:e.GetRatio()},gdjs.Physics2RuntimeBehavior.prototype.setGearJointRatio=function(t,e){var i=this._sharedData.getJoint(t);null!==i&&i.GetType()===Box2D.e_gearJoint&&(i.SetRatio(e),i.GetBodyA().SetAwake(!0),i.GetBodyB().SetAwake(!0))},gdjs.Physics2RuntimeBehavior.prototype.addMouseJoint=function(t,e,i,o,s,a){null===this._body&&this.createBody();var n=new Box2D.b2MouseJointDef;n.set_bodyA(this._sharedData.staticBody),n.set_bodyB(this._body),n.set_target(this.b2Vec2(t*this._sharedData.invScaleX,e*this._sharedData.invScaleY)),n.set_maxForce(i>=0?i:0),n.set_frequencyHz(o>0?o:1),n.set_dampingRatio(s>=0?s:0);var r=this._sharedData.addJoint(Box2D.castObject(this._sharedData.world.CreateJoint(n),Box2D.b2MouseJoint));a.setNumber(r)},gdjs.Physics2RuntimeBehavior.prototype.getMouseJointTargetX=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_mouseJoint?0:e.GetTarget().get_x()*this._sharedData.scaleX},gdjs.Physics2RuntimeBehavior.prototype.getMouseJointTargetY=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_mouseJoint?0:e.GetTarget().get_y()*this._sharedData.scaleY},gdjs.Physics2RuntimeBehavior.prototype.setMouseJointTarget=function(t,e,i){var o=this._sharedData.getJoint(t);null!==o&&o.GetType()===Box2D.e_mouseJoint&&(o.SetTarget(this.b2Vec2(e*this._sharedData.invScaleX,i*this._sharedData.invScaleY)),o.GetBodyB().SetAwake(!0))},gdjs.Physics2RuntimeBehavior.prototype.getMouseJointMaxForce=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_mouseJoint?0:e.GetMaxForce()},gdjs.Physics2RuntimeBehavior.prototype.setMouseJointMaxForce=function(t,e){if(!(e<0)){var i=this._sharedData.getJoint(t);null!==i&&i.GetType()===Box2D.e_mouseJoint&&i.SetMaxForce(e)}},gdjs.Physics2RuntimeBehavior.prototype.getMouseJointFrequency=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_mouseJoint?0:e.GetFrequency()},gdjs.Physics2RuntimeBehavior.prototype.setMouseJointFrequency=function(t,e){if(!(e<=0)){var i=this._sharedData.getJoint(t);null!==i&&i.GetType()===Box2D.e_mouseJoint&&i.SetFrequency(e)}},gdjs.Physics2RuntimeBehavior.prototype.getMouseJointDampingRatio=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_mouseJoint?0:e.GetDampingRatio()},gdjs.Physics2RuntimeBehavior.prototype.setMouseJointDampingRatio=function(t,e){if(!(e<0)){var i=this._sharedData.getJoint(t);null!==i&&i.GetType()===Box2D.e_mouseJoint&&i.SetDampingRatio(e)}},gdjs.Physics2RuntimeBehavior.prototype.addWheelJoint=function(t,e,i,o,s,a,n,r,h,c,d,l,y){if(null===this._body&&this.createBody(),null!=i&&i.hasBehavior(this.name)){var u=i.getBehavior(this.name).getBody();if(this._body!==u){var g=new Box2D.b2WheelJointDef;g.set_bodyA(this._body),g.set_localAnchorA(this._body.GetLocalPoint(this.b2Vec2(t*this._sharedData.invScaleX,e*this._sharedData.invScaleY))),g.set_bodyB(u),g.set_localAnchorB(u.GetLocalPoint(this.b2Vec2(o*this._sharedData.invScaleX,s*this._sharedData.invScaleY))),a=gdjs.toRad(a)-this._body.GetAngle(),g.set_localAxisA(this.b2Vec2(Math.cos(a),Math.sin(a))),g.set_frequencyHz(n>0?n:1),g.set_dampingRatio(r>=0?r:0),g.set_enableMotor(h),g.set_motorSpeed(gdjs.toRad(c)),g.set_maxMotorTorque(d),g.set_collideConnected(l);var p=this._sharedData.addJoint(Box2D.castObject(this._sharedData.world.CreateJoint(g),Box2D.b2WheelJoint));y.setNumber(p)}}},gdjs.Physics2RuntimeBehavior.prototype.getWheelJointAxisAngle=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_wheelJoint?0:gdjs.toDegrees(Math.atan2(e.GetLocalAxisA().get_y(),e.GetLocalAxisA().get_x())+e.GetBodyA().GetAngle())},gdjs.Physics2RuntimeBehavior.prototype.getWheelJointTranslation=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_wheelJoint?0:e.GetJointTranslation()*this._sharedData.scaleX},gdjs.Physics2RuntimeBehavior.prototype.getWheelJointSpeed=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_wheelJoint?0:gdjs.toDegrees(e.GetJointSpeed())},gdjs.Physics2RuntimeBehavior.prototype.isWheelJointMotorEnabled=function(t){var e=this._sharedData.getJoint(t);return null!==e&&e.GetType()===Box2D.e_wheelJoint&&e.IsMotorEnabled()},gdjs.Physics2RuntimeBehavior.prototype.enableWheelJointMotor=function(t,e){var i=this._sharedData.getJoint(t);null!==i&&i.GetType()===Box2D.e_wheelJoint&&i.EnableMotor(e)},gdjs.Physics2RuntimeBehavior.prototype.getWheelJointMotorSpeed=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_wheelJoint?0:gdjs.toDegrees(e.GetMotorSpeed())},gdjs.Physics2RuntimeBehavior.prototype.setWheelJointMotorSpeed=function(t,e){var i=this._sharedData.getJoint(t);null!==i&&i.GetType()===Box2D.e_wheelJoint&&i.SetMotorSpeed(gdjs.toRad(e))},gdjs.Physics2RuntimeBehavior.prototype.getWheelJointMaxMotorTorque=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_wheelJoint?0:e.GetMaxMotorTorque()},gdjs.Physics2RuntimeBehavior.prototype.setWheelJointMaxMotorTorque=function(t,e){if(!(e<0)){var i=this._sharedData.getJoint(t);null!==i&&i.GetType()===Box2D.e_wheelJoint&&i.SetMaxMotorTorque(e)}},gdjs.Physics2RuntimeBehavior.prototype.getWheelJointMotorTorque=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_wheelJoint?0:e.GetMotorTorque(1/this._sharedData.timeStep)},gdjs.Physics2RuntimeBehavior.prototype.getWheelJointFrequency=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_wheelJoint?0:e.GetSpringFrequencyHz()},gdjs.Physics2RuntimeBehavior.prototype.setWheelJointFrequency=function(t,e){if(!(e<0)){var i=this._sharedData.getJoint(t);null!==i&&i.GetType()===Box2D.e_wheelJoint&&i.SetSpringFrequencyHz(e)}},gdjs.Physics2RuntimeBehavior.prototype.getWheelJointDampingRatio=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_wheelJoint?0:e.GetSpringDampingRatio()},gdjs.Physics2RuntimeBehavior.prototype.setWheelJointDampingRatio=function(t,e){if(!(e<0)){var i=this._sharedData.getJoint(t);null!==i&&i.GetType()===Box2D.e_wheelJoint&&i.SetSpringDampingRatio(e)}},gdjs.Physics2RuntimeBehavior.prototype.addWeldJoint=function(t,e,i,o,s,a,n,r,h,c){if(null===this._body&&this.createBody(),null!=i&&i.hasBehavior(this.name)){var d=i.getBehavior(this.name).getBody();if(this._body!==d){var l=new Box2D.b2WeldJointDef;l.set_bodyA(this._body),l.set_localAnchorA(this._body.GetLocalPoint(this.b2Vec2(t*this._sharedData.invScaleX,e*this._sharedData.invScaleY))),l.set_bodyB(d),l.set_localAnchorB(d.GetLocalPoint(this.b2Vec2(o*this._sharedData.invScaleX,s*this._sharedData.invScaleY))),l.set_referenceAngle(gdjs.toRad(a)),l.set_frequencyHz(n>0?n:1),l.set_dampingRatio(r>=0?r:0),l.set_collideConnected(h);var y=Box2D.castObject(this._sharedData.world.CreateJoint(l),Box2D.b2WeldJoint);y.referenceAngle=l.get_referenceAngle(),c.setNumber(this._sharedData.addJoint(y))}}},gdjs.Physics2RuntimeBehavior.prototype.getWeldJointReferenceAngle=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_weldJoint?0:gdjs.toDegrees(e.referenceAngle)},gdjs.Physics2RuntimeBehavior.prototype.getWeldJointFrequency=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_weldJoint?0:e.GetFrequency()},gdjs.Physics2RuntimeBehavior.prototype.setWeldJointFrequency=function(t,e){if(!(e<0)){var i=this._sharedData.getJoint(t);null!==i&&i.GetType()===Box2D.e_weldJoint&&i.SetFrequency(e)}},gdjs.Physics2RuntimeBehavior.prototype.getWeldJointDampingRatio=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_weldJoint?0:e.GetDampingRatio()},gdjs.Physics2RuntimeBehavior.prototype.setWeldJointDampingRatio=function(t,e){if(!(e<0)){var i=this._sharedData.getJoint(t);null!==i&&i.GetType()===Box2D.e_weldJoint&&i.SetDampingRatio(e)}},gdjs.Physics2RuntimeBehavior.prototype.addRopeJoint=function(t,e,i,o,s,a,n,r){if(null===this._body&&this.createBody(),null!=i&&i.hasBehavior(this.name)){var h=i.getBehavior(this.name).getBody();if(this._body!==h){var c=new Box2D.b2RopeJointDef;c.set_bodyA(this._body),c.set_localAnchorA(this._body.GetLocalPoint(this.b2Vec2(t*this._sharedData.invScaleX,e*this._sharedData.invScaleY))),c.set_bodyB(h),c.set_localAnchorB(h.GetLocalPoint(this.b2Vec2(o*this._sharedData.invScaleX,s*this._sharedData.invScaleY))),c.set_maxLength(a>0?a*this._sharedData.invScaleX:this.b2Vec2((o-t)*this._sharedData.invScaleX,(s-e)*this._sharedData.invScaleY).Length()),c.set_collideConnected(n);var d=this._sharedData.addJoint(Box2D.castObject(this._sharedData.world.CreateJoint(c),Box2D.b2RopeJoint));r.setNumber(d)}}},gdjs.Physics2RuntimeBehavior.prototype.getRopeJointMaxLength=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_ropeJoint?0:e.GetMaxLength()*this._sharedData.scaleX},gdjs.Physics2RuntimeBehavior.prototype.setRopeJointMaxLength=function(t,e){if(!(e<0)){var i=this._sharedData.getJoint(t);null!==i&&i.GetType()===Box2D.e_ropeJoint&&(i.SetMaxLength(e*this._sharedData.invScaleX),i.GetBodyA().SetAwake(!0),i.GetBodyB().SetAwake(!0))}},gdjs.Physics2RuntimeBehavior.prototype.addFrictionJoint=function(t,e,i,o,s,a,n,r,h){if(null===this._body&&this.createBody(),null!=i&&i.hasBehavior(this.name)){var c=i.getBehavior(this.name).getBody();if(this._body!==c){var d=new Box2D.b2FrictionJointDef;d.set_bodyA(this._body),d.set_localAnchorA(this._body.GetLocalPoint(this.b2Vec2(t*this._sharedData.invScaleX,e*this._sharedData.invScaleY))),d.set_bodyB(c),d.set_localAnchorB(c.GetLocalPoint(this.b2Vec2(o*this._sharedData.invScaleX,s*this._sharedData.invScaleY))),d.set_maxForce(a>=0?a:0),d.set_maxTorque(n>=0?n:0),d.set_collideConnected(r);var l=this._sharedData.addJoint(Box2D.castObject(this._sharedData.world.CreateJoint(d),Box2D.b2FrictionJoint));h.setNumber(l)}}},gdjs.Physics2RuntimeBehavior.prototype.getFrictionJointMaxForce=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_frictionJoint?0:e.GetMaxForce()},gdjs.Physics2RuntimeBehavior.prototype.setFrictionJointMaxForce=function(t,e){if(!(e<0)){var i=this._sharedData.getJoint(t);null!==i&&i.GetType()===Box2D.e_frictionJoint&&i.SetMaxForce(e)}},gdjs.Physics2RuntimeBehavior.prototype.getFrictionJointMaxTorque=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_frictionJoint?0:e.GetMaxTorque()},gdjs.Physics2RuntimeBehavior.prototype.setFrictionJointMaxTorque=function(t,e){if(!(e<0)){var i=this._sharedData.getJoint(t);null!==i&&i.GetType()===Box2D.e_frictionJoint&&i.SetMaxTorque(e)}},gdjs.Physics2RuntimeBehavior.prototype.addMotorJoint=function(t,e,i,o,s,a,n,r,h){if(null===this._body&&this.createBody(),null!=t&&t.hasBehavior(this.name)){var c=t.getBehavior(this.name).getBody();if(this._body!==c){var d=new Box2D.b2MotorJointDef;d.set_bodyA(this._body),d.set_bodyB(c),d.set_linearOffset(this.b2Vec2(e*this._sharedData.invScaleX,i*this._sharedData.invScaleY)),d.set_angularOffset(gdjs.toRad(o)),d.set_maxForce(s>=0?s:0),d.set_maxTorque(a>=0?a:0),d.set_correctionFactor(n<0?0:n>1?1:n),d.set_collideConnected(r);var l=this._sharedData.addJoint(Box2D.castObject(this._sharedData.world.CreateJoint(d),Box2D.b2MotorJoint));h.setNumber(l)}}},gdjs.Physics2RuntimeBehavior.prototype.getMotorJointOffsetX=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_motorJoint?0:e.GetLinearOffset().get_x()*this._sharedData.scaleX},gdjs.Physics2RuntimeBehavior.prototype.getMotorJointOffsetY=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_motorJoint?0:e.GetLinearOffset().get_y()*this._sharedData.scaleY},gdjs.Physics2RuntimeBehavior.prototype.setMotorJointOffset=function(t,e,i){var o=this._sharedData.getJoint(t);null!==o&&o.GetType()===Box2D.e_motorJoint&&o.SetLinearOffset(this.b2Vec2(e*this._sharedData.invScaleX,i*this._sharedData.invScaleY))},gdjs.Physics2RuntimeBehavior.prototype.getMotorJointAngularOffset=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_motorJoint?0:gdjs.toDegrees(e.GetAngularOffset())},gdjs.Physics2RuntimeBehavior.prototype.setMotorJointAngularOffset=function(t,e){var i=this._sharedData.getJoint(t);null!==i&&i.GetType()===Box2D.e_motorJoint&&i.SetAngularOffset(gdjs.toRad(e))},gdjs.Physics2RuntimeBehavior.prototype.getMotorJointMaxForce=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_motorJoint?0:e.GetMaxForce()},gdjs.Physics2RuntimeBehavior.prototype.setMotorJointMaxForce=function(t,e){if(!(e<0)){var i=this._sharedData.getJoint(t);null!==i&&i.GetType()===Box2D.e_motorJoint&&i.SetMaxForce(e)}},gdjs.Physics2RuntimeBehavior.prototype.getMotorJointMaxTorque=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_motorJoint?0:e.GetMaxTorque()},gdjs.Physics2RuntimeBehavior.prototype.setMotorJointMaxTorque=function(t,e){if(!(e<0)){var i=this._sharedData.getJoint(t);null!==i&&i.GetType()===Box2D.e_motorJoint&&(i.SetMaxTorque(e),i.GetBodyA().SetAwake(!0),i.GetBodyB().SetAwake(!0))}},gdjs.Physics2RuntimeBehavior.prototype.getMotorJointCorrectionFactor=function(t){var e=this._sharedData.getJoint(t);return null===e||e.GetType()!==Box2D.e_motorJoint?0:e.GetCorrectionFactor()},gdjs.Physics2RuntimeBehavior.prototype.setMotorJointCorrectionFactor=function(t,e){if(!(e<0||e>1)){var i=this._sharedData.getJoint(t);null!==i&&i.GetType()===Box2D.e_motorJoint&&(i.SetCorrectionFactor(e),i.GetBodyA().SetAwake(!0),i.GetBodyB().SetAwake(!0))}},gdjs.Physics2RuntimeBehavior.collisionTest=function(t,e,i){if(null===t||!t.hasBehavior(i))return!1;if(null===e||!e.hasBehavior(i))return!1;for(var o=t.getBehavior(i),s=0,a=o.currentContacts.length;s<a;++s)if(o.currentContacts[s].owner===e)return!0;return!1};