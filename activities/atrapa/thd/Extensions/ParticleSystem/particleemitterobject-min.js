gdjs.ParticleEmitterObject=function(t,e){gdjs.RuntimeObject.call(this,t,e),this._renderer=new gdjs.ParticleEmitterObjectRenderer(t,this,e),this.singleAngle=e.emissionEditionSimpleMode,this.angleA=e.emitterAngleA,this.angleB=e.emitterAngleB,this.forceMin=e.emitterForceMin,this.forceMax=e.emitterForceMax,this.zoneRadius=e.zoneRadius,this.lifeTimeMin=e.particleLifeTimeMin,this.lifeTimeMax=e.particleLifeTimeMax,this.gravityX=e.particleGravityX,this.gravityY=e.particleGravityY,this.colorR1=e.particleRed1,this.colorR2=e.particleRed2,this.colorG1=e.particleGreen1,this.colorG2=e.particleGreen2,this.colorB1=e.particleBlue1,this.colorB2=e.particleBlue2,this.size1=e.particleSize1,this.size2=e.particleSize2,this.sizeParam=e.sizeParam,this.alpha1=e.particleAlpha1,this.alpha2=e.particleAlpha2,this.rendererType=e.rendererType,this.rendererParam1=e.rendererParam1,this.rendererParam2=e.rendererParam2,this.texture=e.textureParticleName,this.flow=e.flow,this.tank=e.tank,this.destroyWhenNoParticles=e.destroyWhenNoParticles,this._posDirty=!0,this._angleDirty=!0,this._forceDirty=!0,this._zoneRadiusDirty=!0,this._lifeTimeDirty=!0,this._gravityDirty=!0,this._colorDirty=!0,this._sizeDirty=!0,this._alphaDirty=!0,this._textureDirty=""!==this.texture,this._flowDirty=!0,this.onCreated()},gdjs.ParticleEmitterObject.prototype=Object.create(gdjs.RuntimeObject.prototype),gdjs.registerObject("ParticleSystem::ParticleEmitter",gdjs.ParticleEmitterObject),gdjs.ParticleEmitterObject.prototype.setX=function(t){this.x!==t&&(this._posDirty=!0),gdjs.RuntimeObject.prototype.setX.call(this,t)},gdjs.ParticleEmitterObject.prototype.setY=function(t){this.y!==t&&(this._posDirty=!0),gdjs.RuntimeObject.prototype.setY.call(this,t)},gdjs.ParticleEmitterObject.prototype.setAngle=function(t){this.angle!==t&&(this._angleDirty=!0),gdjs.RuntimeObject.prototype.setAngle.call(this,t)},gdjs.ParticleEmitterObject.prototype.getRendererObject=function(){return this._renderer.getRendererObject()},gdjs.ParticleEmitterObject.prototype.updateFromObjectData=function(t,e){if(t.emissionEditionSimpleMode!==e.emissionEditionSimpleMode&&(this.singleAngle=e.emissionEditionSimpleMode,this._angleDirty=!0),t.emitterAngleA!==e.emitterAngleA&&this.setEmitterAngleA(e.emitterAngleA),t.emitterAngleB!==e.emitterAngleB&&this.setEmitterAngleB(e.emitterAngleB),t.emitterForceMin!==e.emitterForceMin&&this.setEmitterForceMin(e.emitterForceMin),t.emitterForceMax!==e.emitterForceMax&&this.setEmitterForceMax(e.emitterForceMax),t.zoneRadius!==e.zoneRadius&&this.setZoneRadius(e.zoneRadius),t.particleLifeTimeMin!==e.particleLifeTimeMin&&this.setParticleLifeTimeMin(e.particleLifeTimeMin),t.particleLifeTimeMax!==e.particleLifeTimeMax&&this.setParticleLifeTimeMax(e.particleLifeTimeMax),t.particleGravityX!==e.particleGravityX&&this.setParticleGravityX(e.particleGravityX),t.particleGravityY!==e.particleGravityY&&this.setParticleGravityY(e.particleGravityY),t.particleRed1!==e.particleRed1&&this.setParticleRed1(e.particleRed1),t.particleRed2!==e.particleRed2&&this.setParticleRed2(e.particleRed2),t.particleGreen1!==e.particleGreen1&&this.setParticleGreen1(e.particleGreen1),t.particleGreen2!==e.particleGreen2&&this.setParticleGreen2(e.particleGreen2),t.particleBlue1!==e.particleBlue1&&this.setParticleBlue1(e.particleBlue1),t.particleBlue2!==e.particleBlue2&&this.setParticleBlue2(e.particleBlue2),t.particleSize1!==e.particleSize1&&this.setParticleSize1(e.particleSize1),t.particleSize2!==e.particleSize2&&this.setParticleSize2(e.particleSize2),t.sizeParam!==e.sizeParam&&(this.sizeParam=e.sizeParam,this._sizeDirty=!0),t.particleAlpha1!==e.particleAlpha1&&this.setParticleAlpha1(e.particleAlpha1),t.particleAlpha2!==e.particleAlpha2&&this.setParticleAlpha2(e.particleAlpha2),t.textureParticleName!==e.textureParticleName&&this.setTexture(e.textureParticleName,this._runtimeScene),t.flow!==e.flow&&this.setFlow(e.flow),t.tank!==e.tank&&this.setTank(e.tank),t.destroyWhenNoParticles!==e.destroyWhenNoParticles&&(this.destroyWhenNoParticles=e.destroyWhenNoParticles),t.particleSizeRandomness1!==e.particleSizeRandomness1||t.particleSizeRandomness2!==e.particleSizeRandomness2||t.particleAngle1!==e.particleAngle1||t.particleAngle2!==e.particleAngle2||t.maxParticleNb!==e.maxParticleNb||t.additive!==e.additive||t.rendererType!==e.rendererType||t.rendererParam1!==e.rendererParam1||t.rendererParam2!==e.rendererParam2){this._runtimeScene.getLayer(this.layer).getRenderer().removeRendererObject(this._renderer.getRendererObject()),this._renderer.destroy(),this._renderer=new gdjs.ParticleEmitterObjectRenderer(this._runtimeScene,this,e),this._posDirty=this._angleDirty=this._forceDirty=this._zoneRadiusDirty=!0,this._lifeTimeDirty=this._gravityDirty=this._colorDirty=this._sizeDirty=!0,this._alphaDirty=this._flowDirty=this._textureDirty=!0}return!0},gdjs.ParticleEmitterObject.prototype.update=function(t){if(this._posDirty&&this._renderer.setPosition(this.getX(),this.getY()),this._angleDirty){var e=this.getAngle();this.singleAngle?this._renderer.setAngle(this.angle-this.angleB/2,this.angle+this.angleB/2):this._renderer.setAngle(this.angle+this.angleA,this.angle+this.angleB)}this._forceDirty&&this._renderer.setForce(this.forceMin,this.forceMax),this._zoneRadiusDirty&&this._renderer.setZoneRadius(this.zoneRadius),this._lifeTimeDirty&&this._renderer.setLifeTime(this.lifeTimeMin,this.lifeTimeMax),this._gravityDirty&&this._renderer.setGravity(this.gravityX,this.gravityY),this._colorDirty&&this._renderer.setColor(this.colorR1,this.colorG1,this.colorB1,this.colorR2,this.colorG2,this.colorB2),this._sizeDirty&&"Mutable"===this.sizeParam&&this._renderer.setSize(this.size1,this.size2),this._alphaDirty&&this._renderer.setAlpha(this.alpha1,this.alpha2),this._flowDirty&&this._renderer.setFlow(this.flow,this.tank),this._textureDirty&&this._renderer.setTextureName(this.texture,t),this._posDirty=this._angleDirty=this._forceDirty=this._zoneRadiusDirty=!1,this._lifeTimeDirty=this._gravityDirty=this._colorDirty=this._sizeDirty=!1,this._alphaDirty=this._flowDirty=this._textureDirty=!1,this._renderer.update(this.getElapsedTime(t)/1e3),this.tank>0&&this._renderer.getTotalParticleCount()>this.tank&&this._renderer.stop(),this._renderer.hasStarted()&&0===this._renderer.getParticleCount()&&this.destroyWhenNoParticles&&this.deleteFromScene(t)},gdjs.ParticleEmitterObject.prototype.onDestroyFromScene=function(t){this._renderer.destroy(),gdjs.RuntimeObject.prototype.onDestroyFromScene.call(this,t)},gdjs.ParticleEmitterObject.prototype.getEmitterForceMin=function(){return this.forceMin},gdjs.ParticleEmitterObject.prototype.setEmitterForceMin=function(t){t<0&&(t=0),this.forceMin!==t&&(this._forceDirty=!0,this.forceMin=t)},gdjs.ParticleEmitterObject.prototype.getEmitterForceMax=function(){return this.forceMax},gdjs.ParticleEmitterObject.prototype.setEmitterForceMax=function(t){t<0&&(t=0),this.forceMax!==t&&(this._forceDirty=!0,this.forceMax=t)},gdjs.ParticleEmitterObject.prototype.getEmitterAngle=function(){return(this.angleA+this.angleB)/2},gdjs.ParticleEmitterObject.prototype.setEmitterAngle=function(t){var e=this.getEmitterAngle();t!==e&&(this._angleDirty=!0,this.angleA+=t-e,this.angleB+=t-e)},gdjs.ParticleEmitterObject.prototype.getEmitterAngleA=function(){return this.angleA},gdjs.ParticleEmitterObject.prototype.setEmitterAngleA=function(t){this.angleA!==t&&(this._angleDirty=!0,this.angleA=t)},gdjs.ParticleEmitterObject.prototype.getEmitterAngleB=function(){return this.angleB},gdjs.ParticleEmitterObject.prototype.setEmitterAngleB=function(t){this.angleB!==t&&(this._angleDirty=!0,this.angleB=t)},gdjs.ParticleEmitterObject.prototype.getConeSprayAngle=function(){return Math.abs(this.angleB-this.angleA)},gdjs.ParticleEmitterObject.prototype.setConeSprayAngle=function(t){if(this.getConeSprayAngle()!==t){this._angleDirty=!0;var e=this.getEmitterAngle();this.angleA=e-t/2,this.angleB=e+t/2}},gdjs.ParticleEmitterObject.prototype.getZoneRadius=function(){return this.zoneRadius},gdjs.ParticleEmitterObject.prototype.setZoneRadius=function(t){t<0&&(t=0),this.zoneRadius!==t&&t>0&&(this._zoneRadiusDirty=!0,this.zoneRadius=t)},gdjs.ParticleEmitterObject.prototype.getParticleLifeTimeMin=function(){return this.lifeTimeMin},gdjs.ParticleEmitterObject.prototype.setParticleLifeTimeMin=function(t){t<0&&(t=0),this.lifeTimeMin!==t&&(this._lifeTimeDirty=!0,this.lifeTimeMin=t)},gdjs.ParticleEmitterObject.prototype.getParticleLifeTimeMax=function(){return this.lifeTimeMax},gdjs.ParticleEmitterObject.prototype.setParticleLifeTimeMax=function(t){t<0&&(t=0),this.lifeTimeMax!==t&&(this._lifeTimeDirty=!0,this.lifeTimeMax=t)},gdjs.ParticleEmitterObject.prototype.getParticleGravityX=function(){return this.gravityX},gdjs.ParticleEmitterObject.prototype.setParticleGravityX=function(t){this.gravityX!==t&&(this._gravityDirty=!0,this.gravityX=t)},gdjs.ParticleEmitterObject.prototype.getParticleGravityY=function(){return this.gravityY},gdjs.ParticleEmitterObject.prototype.setParticleGravityY=function(t){this.gravityY!==t&&(this._gravityDirty=!0,this.gravityY=t)},gdjs.ParticleEmitterObject.prototype.getParticleGravityAngle=function(){return 180*Math.atan2(this.gravityY,this.gravityX)/Math.PI},gdjs.ParticleEmitterObject.prototype.setParticleGravityAngle=function(t){if(this.getParticleGravityAngle()!==t){this._gravityDirty=!0;var e=this.getParticleGravityLength();this.gravityX=e*Math.cos(t*Math.PI/180),this.gravityY=e*Math.sin(t*Math.PI/180)}},gdjs.ParticleEmitterObject.prototype.getParticleGravityLength=function(){return Math.sqrt(this.gravityX*this.gravityX+this.gravityY*this.gravityY)},gdjs.ParticleEmitterObject.prototype.setParticleGravityLength=function(t){t<0&&(t=0);var e=this.getParticleGravityLength();e!==t&&(this._gravityDirty=!0,this.gravityX*=t/e,this.gravityY*=t/e)},gdjs.ParticleEmitterObject.prototype.getParticleRed1=function(){return this.colorR1},gdjs.ParticleEmitterObject.prototype.setParticleRed1=function(t){t<0&&(t=0),t>255&&(t=255),this.colorR1!==t&&(this._colorDirty=!0,this.colorR1=t)},gdjs.ParticleEmitterObject.prototype.getParticleRed2=function(){return this.colorR2},gdjs.ParticleEmitterObject.prototype.setParticleRed2=function(t){t<0&&(t=0),t>255&&(t=255),this.colorR2!==t&&(this._colorDirty=!0,this.colorR2=t)},gdjs.ParticleEmitterObject.prototype.getParticleGreen1=function(){return this.colorG1},gdjs.ParticleEmitterObject.prototype.setParticleGreen1=function(t){t<0&&(t=0),t>255&&(t=255),this.colorG1!==t&&(this._colorDirty=!0,this.colorG1=t)},gdjs.ParticleEmitterObject.prototype.getParticleGreen2=function(){return this.colorG2},gdjs.ParticleEmitterObject.prototype.setParticleGreen2=function(t){t<0&&(t=0),t>255&&(t=255),this.colorG2!==t&&(this._colorDirty=!0,this.colorG2=t)},gdjs.ParticleEmitterObject.prototype.getParticleBlue1=function(){return this.colorB1},gdjs.ParticleEmitterObject.prototype.setParticleBlue1=function(t){t<0&&(t=0),t>255&&(t=255),this.colorB1!==t&&(this._colorDirty=!0,this.colorB1=t)},gdjs.ParticleEmitterObject.prototype.getParticleBlue2=function(){return this.colorB2},gdjs.ParticleEmitterObject.prototype.setParticleBlue2=function(t){t<0&&(t=0),t>255&&(t=255),this.colorB2!==t&&(this._colorDirty=!0,this.colorB2=t)},gdjs.ParticleEmitterObject.prototype.setParticleColor1=function(t){var e=t.split(";");e.length<3||(this.setParticleRed1(parseInt(e[0],10)),this.setParticleGreen1(parseInt(e[1],10)),this.setParticleBlue1(parseInt(e[2],10)))},gdjs.ParticleEmitterObject.prototype.setParticleColor2=function(t){var e=t.split(";");e.length<3||(this.setParticleRed2(parseInt(e[0],10)),this.setParticleGreen2(parseInt(e[1],10)),this.setParticleBlue2(parseInt(e[2],10)))},gdjs.ParticleEmitterObject.prototype.getParticleSize1=function(){return this.size1},gdjs.ParticleEmitterObject.prototype.setParticleSize1=function(t){t<0&&(t=0),this.size1!==t&&(this._sizeDirty=!0,this.size1=t)},gdjs.ParticleEmitterObject.prototype.getParticleSize2=function(){return this.size2},gdjs.ParticleEmitterObject.prototype.setParticleSize2=function(t){this.size2!==t&&(this._sizeDirty=!0,this.size2=t)},gdjs.ParticleEmitterObject.prototype.getParticleAlpha1=function(){return this.alpha1},gdjs.ParticleEmitterObject.prototype.setParticleAlpha1=function(t){this.alpha1!==t&&(this._alphaDirty=!0,this.alpha1=t)},gdjs.ParticleEmitterObject.prototype.getParticleAlpha2=function(){return this.alpha2},gdjs.ParticleEmitterObject.prototype.setParticleAlpha2=function(t){this.alpha2!==t&&(this._alphaDirty=!0,this.alpha2=t)},gdjs.ParticleEmitterObject.prototype.noMoreParticles=function(){this._renderer.stop()},gdjs.ParticleEmitterObject.prototype.recreateParticleSystem=function(){this._renderer.recreate()},gdjs.ParticleEmitterObject.prototype.getFlow=function(){return this.flow},gdjs.ParticleEmitterObject.prototype.setFlow=function(t){this.flow!==t&&(this.flow=t,this._flowDirty=!0)},gdjs.ParticleEmitterObject.prototype.getTank=function(){return this.tank},gdjs.ParticleEmitterObject.prototype.setTank=function(t){this.tank=t},gdjs.ParticleEmitterObject.prototype.getTexture=function(){return this.texture},gdjs.ParticleEmitterObject.prototype.setTexture=function(t,e){this.texture!==t&&this._renderer.isTextureNameValid(t,e)&&(this.texture=t,this._textureDirty=!0)};