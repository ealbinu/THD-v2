gdjs.FontFaceObserverFontManager=function(e){this._resources=e,this._loadedFontFamily={},this._loadedFonts={},this._filenameToFontFamily={}},gdjs.FontManager=gdjs.FontFaceObserverFontManager,gdjs.FontFaceObserverFontManager.prototype.setResources=function(e){this._resources=e},gdjs.FontFaceObserverFontManager.prototype.getFontFamily=function(e){return this._loadedFontFamily[e]?this._loadedFontFamily[e]:"Arial"},gdjs.FontFaceObserverFontManager.prototype.getFontFile=function(e){return this._loadedFonts[e]?this._loadedFonts[e].file||"":e},gdjs.FontFaceObserverFontManager.prototype._getFontFamilyFromFilename=function(e){if(this._filenameToFontFamily[e])return this._filenameToFontFamily[e];for(var n="gdjs_font_"+e.toLowerCase().replace(/[^\w]/gi,"-"),o=n,t=2;this._filenameToFontFamily[n];)n=n+"-"+t,t++;return this._filenameToFontFamily[e]=o},gdjs.FontFaceObserverFontManager._loadFont=function(e,n){var o={},t="url("+encodeURI(n)+")";if("undefined"!=typeof FontFace){var a=new FontFace(e,t,o);return document.fonts.add(a),a.load()}var r=document.createElement("style");return r.appendChild(document.createTextNode("@font-face { font-family: '"+e+"'; src: "+t+"; }")),document.head.appendChild(r),new FontFaceObserver(e,o).load()},gdjs.FontFaceObserverFontManager.prototype.loadFonts=function(e,n){for(var o=this._resources,t={},a=0,r=o.length;a<r;++a){var F=o[a];if(F.file&&"font"===F.kind){if(this._loadedFonts[F.name])continue;t[F.file]=t[F.file]?t[F.file].concat(F):[F]}}var i=Object.keys(t).length;if(0===i)return n(i);var s=0,l=this,d=function(o,t){t.forEach(function(e){l._loadedFontFamily[e.name]=o,l._loadedFonts[e.name]=e}),s++,e(s,i),s===i&&n(i)};Object.keys(t).forEach(function(e){var n=l._getFontFamilyFromFilename(e),o=t[e];gdjs.FontFaceObserverFontManager._loadFont(n,e).then(function(){d(n,o)},function(t){console.error('Error loading font resource "'+o[0].name+'" (file: '+e+"): "+(t.message||"Unknown error")),d(n,o)})})};