gdjs.evtTools.storage=gdjs.evtTools.storage||{loadedFiles:new Hashtable,localStorage:"undefined"!=typeof cc?cc.sys.localStorage:localStorage,fileUtils:null},gdjs.evtTools.storage.loadJSONFileFromStorage=function(e){if(!gdjs.evtTools.storage.loadedFiles.containsKey(e)){var o=null;if(gdjs.evtTools.storage.fileUtils){var s=gdjs.evtTools.storage.fileUtils,t=jsb.fileUtils.getWritablePath()+e;jsb.fileUtils.isFileExist(t)?o=jsb.fileUtils.getStringFromFile(t):console.log('File "'+e+'" does not exist.')}else{o=gdjs.evtTools.storage.localStorage.getItem("GDJS_"+e)}try{null!==o?gdjs.evtTools.storage.loadedFiles.put(e,JSON.parse(o)):gdjs.evtTools.storage.loadedFiles.put(e,{})}catch(o){console.log('Unable to load data from "'+e+'"!'),gdjs.evtTools.storage.loadedFiles.put(e,{})}}},gdjs.evtTools.storage.unloadJSONFile=function(e){if(gdjs.evtTools.storage.loadedFiles.containsKey(e)){var o=gdjs.evtTools.storage.loadedFiles.get(e),s=JSON.stringify(o);if(gdjs.evtTools.storage.fileUtils){var t=gdjs.evtTools.storage.fileUtils,l=jsb.fileUtils.getWritablePath()+e;jsb.fileUtils.writeToFile(s,l)||console.log('Unable to save data to file "'+e+'"!')}else{var a=gdjs.evtTools.storage.localStorage;try{a.setItem("GDJS_"+e,s)}catch(o){console.log('Unable to save data to localStorage for "'+e+'"!')}}gdjs.evtTools.storage.loadedFiles.remove(e)}},gdjs.evtTools.storage.clearJSONFile=function(e){var o=!1;gdjs.evtTools.storage.loadedFiles.containsKey(e)||(o=!0,gdjs.evtTools.storage.loadJSONFileFromStorage(e));var s=gdjs.evtTools.storage.loadedFiles.get(e);for(var t in s)s.hasOwnProperty(t)&&delete s[t];return o&&gdjs.evtTools.storage.unloadJSONFile(e),!0},gdjs.evtTools.storage.elementExistsInJSONFile=function(e,o){var s=!1;gdjs.evtTools.storage.loadedFiles.containsKey(e)||(s=!0,gdjs.evtTools.storage.loadJSONFileFromStorage(e));for(var t=o.split("/"),l=gdjs.evtTools.storage.loadedFiles.get(e),a=0;a<t.length;++a){if(!l[t[a]])return s&&gdjs.evtTools.storage.unloadJSONFile(e),!1;l=l[t[a]]}return s&&gdjs.evtTools.storage.unloadJSONFile(e),!0},gdjs.evtTools.storage.deleteElementFromJSONFile=function(e,o){var s=!1;gdjs.evtTools.storage.loadedFiles.containsKey(e)||(s=!0,gdjs.evtTools.storage.loadJSONFileFromStorage(e));for(var t=o.split("/"),l=gdjs.evtTools.storage.loadedFiles.get(e),a=0;a<t.length;++a){if(!l[t[a]])return s&&gdjs.evtTools.storage.unloadJSONFile(e),!1;a==t.length-1?delete l[t[a]]:l=l[t[a]]}return s&&gdjs.evtTools.storage.unloadJSONFile(e),!0},gdjs.evtTools.storage.writeNumberInJSONFile=function(e,o,s){var t=!1;gdjs.evtTools.storage.loadedFiles.containsKey(e)||(t=!0,gdjs.evtTools.storage.loadJSONFileFromStorage(e));for(var l=o.split("/"),a=gdjs.evtTools.storage.loadedFiles.get(e),g=0;g<l.length;++g)a[l[g]]||(a[l[g]]={}),g==l.length-1?a[l[g]].value=s:a=a[l[g]];return t&&gdjs.evtTools.storage.unloadJSONFile(e),!0},gdjs.evtTools.storage.writeStringInJSONFile=function(e,o,s){var t=!1;gdjs.evtTools.storage.loadedFiles.containsKey(e)||(t=!0,gdjs.evtTools.storage.loadJSONFileFromStorage(e));for(var l=o.split("/"),a=gdjs.evtTools.storage.loadedFiles.get(e),g=0;g<l.length;++g)a[l[g]]||(a[l[g]]={}),g==l.length-1?a[l[g]].str=s:a=a[l[g]];return t&&gdjs.evtTools.storage.unloadJSONFile(e),!0},gdjs.evtTools.storage.readNumberFromJSONFile=function(e,o,s,t){var l=!1;gdjs.evtTools.storage.loadedFiles.containsKey(e)||(l=!0,gdjs.evtTools.storage.loadJSONFileFromStorage(e));for(var a=o.split("/"),g=gdjs.evtTools.storage.loadedFiles.get(e),r=0;r<a.length;++r){if(!g[a[r]])return l&&gdjs.evtTools.storage.unloadJSONFile(e),!1;r==a.length-1&&void 0!==g[a[r]].value?t.setNumber(g[a[r]].value):g=g[a[r]]}return l&&gdjs.evtTools.storage.unloadJSONFile(e),!0},gdjs.evtTools.storage.readStringFromJSONFile=function(e,o,s,t){var l=!1;gdjs.evtTools.storage.loadedFiles.containsKey(e)||(l=!0,gdjs.evtTools.storage.loadJSONFileFromStorage(e));for(var a=o.split("/"),g=gdjs.evtTools.storage.loadedFiles.get(e),r=0;r<a.length;++r){if(!g[a[r]])return l&&gdjs.evtTools.storage.unloadJSONFile(e),!1;r==a.length-1&&void 0!==g[a[r]].str?t.setString(g[a[r]].str):g=g[a[r]]}return l&&gdjs.evtTools.storage.unloadJSONFile(e),!0};