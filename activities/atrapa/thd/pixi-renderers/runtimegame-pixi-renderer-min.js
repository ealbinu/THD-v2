gdjs.RuntimeGamePixiRenderer=function(e,t){this._game=e,this._isFullPage=!0,this._isFullscreen=!1,this._forceFullscreen=t,this._pixiRenderer=null,this._canvasWidth=0,this._canvasHeight=0,this._keepRatio=!0,this._marginLeft=this._marginTop=this._marginRight=this._marginBottom=0},gdjs.RuntimeGameRenderer=gdjs.RuntimeGamePixiRenderer,gdjs.RuntimeGamePixiRenderer.prototype.createStandardCanvas=function(e){this._pixiRenderer=PIXI.autoDetectRenderer({width:this._game.getGameResolutionWidth(),height:this._game.getGameResolutionHeight(),preserveDrawingBuffer:!0,antialias:!1}),e.appendChild(this._pixiRenderer.view),this._pixiRenderer.view.style.position="absolute",this._pixiRenderer.view.tabIndex=1,this._resizeCanvas(),"nearest"===this._game.getScaleMode()&&(this._pixiRenderer.view.style["image-rendering"]="-moz-crisp-edges",this._pixiRenderer.view.style["image-rendering"]="-webkit-optimize-contrast",this._pixiRenderer.view.style["image-rendering"]="-webkit-crisp-edges",this._pixiRenderer.view.style["image-rendering"]="pixelated");var t=this;return window.addEventListener("resize",function(){t._game.onWindowInnerSizeChanged(),t._resizeCanvas(),t._game._notifySceneForResize=!0}),this._pixiRenderer},gdjs.RuntimeGamePixiRenderer.getWindowInnerWidth=function(){return"undefined"!=typeof window?window.innerWidth:800},gdjs.RuntimeGamePixiRenderer.getWindowInnerHeight=function(){return"undefined"!=typeof window?window.innerHeight:800},gdjs.RuntimeGamePixiRenderer.prototype.updateRendererSize=function(){this._resizeCanvas()},gdjs.RuntimeGamePixiRenderer.prototype._resizeCanvas=function(){this._pixiRenderer.width===this._game.getGameResolutionWidth()&&this._pixiRenderer.height===this._game.getGameResolutionHeight()||this._pixiRenderer.resize(this._game.getGameResolutionWidth(),this._game.getGameResolutionHeight());var e=this._forceFullscreen||this._isFullPage||this._isFullscreen,t=this._game.getGameResolutionWidth(),n=this._game.getGameResolutionHeight(),i=window.innerWidth-this._marginLeft-this._marginRight,o=window.innerHeight-this._marginTop-this._marginBottom;if(i<0&&(i=0),o<0&&(o=0),e&&!this._keepRatio)t=i,n=o;else if(e&&this._keepRatio||t>i||n>o){var r=i/t;n*r>o&&(r=o/n),t*=r,n*=r}this._pixiRenderer.view.style.top=this._marginTop+(o-n)/2+"px",this._pixiRenderer.view.style.left=this._marginLeft+(i-t)/2+"px",this._pixiRenderer.view.style.width=t+"px",this._pixiRenderer.view.style.height=n+"px",this._canvasWidth=t,this._canvasHeight=n},gdjs.RuntimeGamePixiRenderer.prototype.keepAspectRatio=function(e){this._keepRatio!==e&&(this._keepRatio=e,this._resizeCanvas(),this._game._notifySceneForResize=!0)},gdjs.RuntimeGamePixiRenderer.prototype.setMargins=function(e,t,n,i){this._marginTop===e&&this._marginRight===t&&this._marginBottom===n&&this._marginLeft===i||(this._marginTop=e,this._marginRight=t,this._marginBottom=n,this._marginLeft=i,this._resizeCanvas(),this._game._notifySceneForResize=!0)},gdjs.RuntimeGamePixiRenderer.prototype.setWindowSize=function(e,t){var n=this.getElectron();if(n){var i=n.remote.getCurrentWindow();i&&i.setContentSize(e,t)}else console.warn("Window size can't be changed on this platform.")},gdjs.RuntimeGamePixiRenderer.prototype.centerWindow=function(){var e=this.getElectron();if(e){var t=e.remote.getCurrentWindow();t&&t.center()}},gdjs.RuntimeGamePixiRenderer.prototype.setFullScreen=function(e){if(!this._forceFullscreen&&this._isFullscreen!==e){this._isFullscreen=!!e;var t=this.getElectron();if(t){var n=t.remote.getCurrentWindow();n&&n.setFullScreen(this._isFullscreen)}else this._isFullscreen?document.documentElement.requestFullScreen?document.documentElement.requestFullScreen():document.documentElement.mozRequestFullScreen?document.documentElement.mozRequestFullScreen():document.documentElement.webkitRequestFullScreen&&document.documentElement.webkitRequestFullScreen():document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen();this._resizeCanvas(),this._notifySceneForResize=!0}},gdjs.RuntimeGamePixiRenderer.prototype.bindStandardEvents=function(e,t,n){function i(e){var t=[0,0];return e.pageX?(t[0]=e.pageX-r.offsetLeft,t[1]=e.pageY-r.offsetTop):(t[0]=e.clientX+n.body.scrollLeft+n.documentElement.scrollLeft-r.offsetLeft,t[1]=e.clientY+n.body.scrollTop+n.documentElement.scrollTop-r.offsetTop),t[0]*=s._game.getGameResolutionWidth()/(s._canvasWidth||1),t[1]*=s._game.getGameResolutionHeight()/(s._canvasHeight||1),t}var o=this._pixiRenderer,r=o.view,s=this;!function e(){isNaN(r.offsetLeft)&&(r.offsetLeft=0,r.offsetTop=0),isNaN(n.body.scrollLeft)&&(n.body.scrollLeft=0,n.body.scrollTop=0),void 0!==n.documentElement&&null!==n.documentElement||(n.documentElement={}),isNaN(n.documentElement.scrollLeft)&&(n.documentElement.scrollLeft=0,n.documentElement.scrollTop=0),isNaN(r.offsetLeft)&&(r.offsetLeft=0,r.offsetTop=0)}(),n.onkeydown=function(t){e.onKeyPressed(t.keyCode,t.location)},n.onkeyup=function(t){e.onKeyReleased(t.keyCode,t.location)},o.view.onmousemove=function(t){var n=i(t);e.onMouseMove(n[0],n[1])},o.view.onmousedown=function(n){return e.onMouseButtonPressed(2===n.button?gdjs.InputManager.MOUSE_RIGHT_BUTTON:1===n.button?gdjs.InputManager.MOUSE_MIDDLE_BUTTON:gdjs.InputManager.MOUSE_LEFT_BUTTON),void 0!==t.focus&&t.focus(),!1},o.view.onmouseup=function(t){return e.onMouseButtonReleased(2===t.button?gdjs.InputManager.MOUSE_RIGHT_BUTTON:1===t.button?gdjs.InputManager.MOUSE_MIDDLE_BUTTON:gdjs.InputManager.MOUSE_LEFT_BUTTON),!1},t.addEventListener("click",function(e){return void 0!==t.focus&&t.focus(),e.preventDefault(),!1},!1),o.view.oncontextmenu=function(e){return e.preventDefault(),e.stopPropagation(),!1},o.view.onmousewheel=function(t){e.onMouseWheel(t.wheelDelta)},t.addEventListener("touchmove",function(t){if(t.preventDefault(),t.changedTouches)for(var n=0;n<t.changedTouches.length;++n){var o=i(t.changedTouches[n]);e.onTouchMove(t.changedTouches[n].identifier,o[0],o[1])}}),t.addEventListener("touchstart",function(t){if(t.preventDefault(),t.changedTouches)for(var n=0;n<t.changedTouches.length;++n){var o=i(t.changedTouches[n]);e.onTouchStart(t.changedTouches[n].identifier,o[0],o[1])}return!1}),t.addEventListener("touchend",function(t){if(t.preventDefault(),t.changedTouches)for(var n=0;n<t.changedTouches.length;++n){var o=i(t.changedTouches[n]);e.onTouchEnd(t.changedTouches[n].identifier)}return!1})},gdjs.RuntimeGamePixiRenderer.prototype.setWindowTitle=function(e){"undefined"!=typeof document&&(document.title=e)},gdjs.RuntimeGamePixiRenderer.prototype.getWindowTitle=function(){return"undefined"!=typeof document?document.title:""},gdjs.RuntimeGamePixiRenderer.prototype.startGameLoop=function(e){function t(i){var o=n?i-n:0;n=i,e(o)&&requestAnimationFrame(t)}requestAnimationFrame(t);var n=0},gdjs.RuntimeGamePixiRenderer.prototype.getPIXIRenderer=function(){return this._pixiRenderer},gdjs.RuntimeGamePixiRenderer.prototype.openURL=function(e){if("undefined"!=typeof Cocoon&&Cocoon.App&&Cocoon.App.openURL)Cocoon.App.openURL(e);else if("undefined"!=typeof window){var t=window.cordova?"_system":"_blank";window.open(e,t)}},gdjs.RuntimeGamePixiRenderer.prototype.stopGame=function(){var e=this.getElectron();if(e){var t=e.remote.getCurrentWindow();t&&t.close()}else"undefined"!=typeof navigator&&navigator.app&&navigator.app.exitApp&&navigator.app.exitApp()},gdjs.RuntimeGamePixiRenderer.prototype.getCanvas=function(){return this._pixiRenderer.view},gdjs.RuntimeGamePixiRenderer.prototype.isWebGLSupported=function(){return this._pixiRenderer.type===PIXI.RENDERER_TYPE.WEBGL},gdjs.RuntimeGamePixiRenderer.prototype.getElectron=function(){return"undefined"!=typeof require?require("electron"):null};